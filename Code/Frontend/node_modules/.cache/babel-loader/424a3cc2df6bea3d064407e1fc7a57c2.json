{"ast":null,"code":"/*!\n * Chartkick.js\n * Create beautiful charts with one line of JavaScript\n * https://github.com/ankane/chartkick.js\n * v4.0.0\n * MIT License\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Chartkick = factory());\n})(this, function () {\n  'use strict';\n\n  function isArray(variable) {\n    return Object.prototype.toString.call(variable) === \"[object Array]\";\n  }\n\n  function isFunction(variable) {\n    return variable instanceof Function;\n  }\n\n  function isPlainObject(variable) {\n    // protect against prototype pollution, defense 2\n    return Object.prototype.toString.call(variable) === \"[object Object]\" && !isFunction(variable) && variable instanceof Object;\n  } // https://github.com/madrobby/zepto/blob/master/src/zepto.js\n\n\n  function extend(target, source) {\n    var key;\n\n    for (key in source) {\n      // protect against prototype pollution, defense 1\n      if (key === \"__proto__\") {\n        continue;\n      }\n\n      if (isPlainObject(source[key]) || isArray(source[key])) {\n        if (isPlainObject(source[key]) && !isPlainObject(target[key])) {\n          target[key] = {};\n        }\n\n        if (isArray(source[key]) && !isArray(target[key])) {\n          target[key] = [];\n        }\n\n        extend(target[key], source[key]);\n      } else if (source[key] !== undefined) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  function merge(obj1, obj2) {\n    var target = {};\n    extend(target, obj1);\n    extend(target, obj2);\n    return target;\n  }\n\n  var DATE_PATTERN = /^(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)$/i;\n\n  function negativeValues(series) {\n    var i, j, data;\n\n    for (i = 0; i < series.length; i++) {\n      data = series[i].data;\n\n      for (j = 0; j < data.length; j++) {\n        if (data[j][1] < 0) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  function toStr(n) {\n    return \"\" + n;\n  }\n\n  function toFloat(n) {\n    return parseFloat(n);\n  }\n\n  function toDate(n) {\n    var matches, year, month, day;\n\n    if (typeof n !== \"object\") {\n      if (typeof n === \"number\") {\n        n = new Date(n * 1000); // ms\n      } else {\n        n = toStr(n);\n\n        if (matches = n.match(DATE_PATTERN)) {\n          year = parseInt(matches[1], 10);\n          month = parseInt(matches[3], 10) - 1;\n          day = parseInt(matches[5], 10);\n          return new Date(year, month, day);\n        } else {\n          // try our best to get the str into iso8601\n          // TODO be smarter about this\n          var str = n.replace(/ /, \"T\").replace(\" \", \"\").replace(\"UTC\", \"Z\");\n          n = new Date(str) || new Date(n);\n        }\n      }\n    }\n\n    return n;\n  }\n\n  function toArr(n) {\n    if (!isArray(n)) {\n      var arr = [],\n          i;\n\n      for (i in n) {\n        if (n.hasOwnProperty(i)) {\n          arr.push([i, n[i]]);\n        }\n      }\n\n      n = arr;\n    }\n\n    return n;\n  }\n\n  function jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle) {\n    return function (chart, opts, chartOptions) {\n      var series = chart.data;\n      var options = merge({}, defaultOptions);\n      options = merge(options, chartOptions || {});\n\n      if (chart.singleSeriesFormat || \"legend\" in opts) {\n        hideLegend(options, opts.legend, chart.singleSeriesFormat);\n      }\n\n      if (opts.title) {\n        setTitle(options, opts.title);\n      } // min\n\n\n      if (\"min\" in opts) {\n        setMin(options, opts.min);\n      } else if (!negativeValues(series)) {\n        setMin(options, 0);\n      } // max\n\n\n      if (opts.max) {\n        setMax(options, opts.max);\n      }\n\n      if (\"stacked\" in opts) {\n        setStacked(options, opts.stacked);\n      }\n\n      if (opts.colors) {\n        options.colors = opts.colors;\n      }\n\n      if (opts.xtitle) {\n        setXtitle(options, opts.xtitle);\n      }\n\n      if (opts.ytitle) {\n        setYtitle(options, opts.ytitle);\n      } // merge library last\n\n\n      options = merge(options, opts.library || {});\n      return options;\n    };\n  }\n\n  function sortByTime(a, b) {\n    return a[0].getTime() - b[0].getTime();\n  }\n\n  function sortByNumberSeries(a, b) {\n    return a[0] - b[0];\n  }\n\n  function sortByNumber(a, b) {\n    return a - b;\n  }\n\n  function isMinute(d) {\n    return d.getMilliseconds() === 0 && d.getSeconds() === 0;\n  }\n\n  function isHour(d) {\n    return isMinute(d) && d.getMinutes() === 0;\n  }\n\n  function isDay(d) {\n    return isHour(d) && d.getHours() === 0;\n  }\n\n  function isWeek(d, dayOfWeek) {\n    return isDay(d) && d.getDay() === dayOfWeek;\n  }\n\n  function isMonth(d) {\n    return isDay(d) && d.getDate() === 1;\n  }\n\n  function isYear(d) {\n    return isMonth(d) && d.getMonth() === 0;\n  }\n\n  function isDate(obj) {\n    return !isNaN(toDate(obj)) && toStr(obj).length >= 6;\n  }\n\n  function isNumber(obj) {\n    return typeof obj === \"number\";\n  }\n\n  var byteSuffixes = [\"bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\"];\n\n  function formatValue(pre, value, options, axis) {\n    pre = pre || \"\";\n\n    if (options.prefix) {\n      if (value < 0) {\n        value = value * -1;\n        pre += \"-\";\n      }\n\n      pre += options.prefix;\n    }\n\n    var suffix = options.suffix || \"\";\n    var precision = options.precision;\n    var round = options.round;\n\n    if (options.byteScale) {\n      var suffixIdx;\n      var baseValue = axis ? options.byteScale : value;\n\n      if (baseValue >= 1152921504606846976) {\n        value /= 1152921504606846976;\n        suffixIdx = 6;\n      } else if (baseValue >= 1125899906842624) {\n        value /= 1125899906842624;\n        suffixIdx = 5;\n      } else if (baseValue >= 1099511627776) {\n        value /= 1099511627776;\n        suffixIdx = 4;\n      } else if (baseValue >= 1073741824) {\n        value /= 1073741824;\n        suffixIdx = 3;\n      } else if (baseValue >= 1048576) {\n        value /= 1048576;\n        suffixIdx = 2;\n      } else if (baseValue >= 1024) {\n        value /= 1024;\n        suffixIdx = 1;\n      } else {\n        suffixIdx = 0;\n      } // TODO handle manual precision case\n\n\n      if (precision === undefined && round === undefined) {\n        if (value >= 1023.5) {\n          if (suffixIdx < byteSuffixes.length - 1) {\n            value = 1.0;\n            suffixIdx += 1;\n          }\n        }\n\n        precision = value >= 1000 ? 4 : 3;\n      }\n\n      suffix = \" \" + byteSuffixes[suffixIdx];\n    }\n\n    if (precision !== undefined && round !== undefined) {\n      throw Error(\"Use either round or precision, not both\");\n    }\n\n    if (!axis) {\n      if (precision !== undefined) {\n        value = value.toPrecision(precision);\n\n        if (!options.zeros) {\n          value = parseFloat(value);\n        }\n      }\n\n      if (round !== undefined) {\n        if (round < 0) {\n          var num = Math.pow(10, -1 * round);\n          value = parseInt((1.0 * value / num).toFixed(0)) * num;\n        } else {\n          value = value.toFixed(round);\n\n          if (!options.zeros) {\n            value = parseFloat(value);\n          }\n        }\n      }\n    }\n\n    if (options.thousands || options.decimal) {\n      value = toStr(value);\n      var parts = value.split(\".\");\n      value = parts[0];\n\n      if (options.thousands) {\n        value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, options.thousands);\n      }\n\n      if (parts.length > 1) {\n        value += (options.decimal || \".\") + parts[1];\n      }\n    }\n\n    return pre + value + suffix;\n  }\n\n  function seriesOption(chart, series, option) {\n    if (option in series) {\n      return series[option];\n    } else if (option in chart.options) {\n      return chart.options[option];\n    }\n\n    return null;\n  }\n\n  function allZeros(data) {\n    var i, j, d;\n\n    for (i = 0; i < data.length; i++) {\n      d = data[i].data;\n\n      for (j = 0; j < d.length; j++) {\n        if (d[j][1] != 0) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  var baseOptions = {\n    maintainAspectRatio: false,\n    animation: false,\n    plugins: {\n      legend: {},\n      tooltip: {\n        displayColors: false,\n        callbacks: {}\n      },\n      title: {\n        font: {\n          size: 20\n        },\n        color: \"#333\"\n      }\n    },\n    interaction: {}\n  };\n  var defaultOptions$2 = {\n    scales: {\n      y: {\n        ticks: {\n          maxTicksLimit: 4\n        },\n        title: {\n          font: {\n            size: 16\n          },\n          color: \"#333\"\n        },\n        grid: {}\n      },\n      x: {\n        grid: {\n          drawOnChartArea: false\n        },\n        title: {\n          font: {\n            size: 16\n          },\n          color: \"#333\"\n        },\n        time: {},\n        ticks: {}\n      }\n    }\n  }; // http://there4.io/2012/05/02/google-chart-color-list/\n\n  var defaultColors = [\"#3366CC\", \"#DC3912\", \"#FF9900\", \"#109618\", \"#990099\", \"#3B3EAC\", \"#0099C6\", \"#DD4477\", \"#66AA00\", \"#B82E2E\", \"#316395\", \"#994499\", \"#22AA99\", \"#AAAA11\", \"#6633CC\", \"#E67300\", \"#8B0707\", \"#329262\", \"#5574A6\", \"#651067\"];\n\n  var hideLegend$2 = function hideLegend$2(options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.plugins.legend.display = !!legend;\n\n      if (legend && legend !== true) {\n        options.plugins.legend.position = legend;\n      }\n    } else if (hideLegend) {\n      options.plugins.legend.display = false;\n    }\n  };\n\n  var setTitle$2 = function setTitle$2(options, title) {\n    options.plugins.title.display = true;\n    options.plugins.title.text = title;\n  };\n\n  var setMin$2 = function setMin$2(options, min) {\n    if (min !== null) {\n      options.scales.y.min = toFloat(min);\n    }\n  };\n\n  var setMax$2 = function setMax$2(options, max) {\n    options.scales.y.max = toFloat(max);\n  };\n\n  var setBarMin$1 = function setBarMin$1(options, min) {\n    if (min !== null) {\n      options.scales.x.min = toFloat(min);\n    }\n  };\n\n  var setBarMax$1 = function setBarMax$1(options, max) {\n    options.scales.x.max = toFloat(max);\n  };\n\n  var setStacked$2 = function setStacked$2(options, stacked) {\n    options.scales.x.stacked = !!stacked;\n    options.scales.y.stacked = !!stacked;\n  };\n\n  var setXtitle$2 = function setXtitle$2(options, title) {\n    options.scales.x.title.display = true;\n    options.scales.x.title.text = title;\n  };\n\n  var setYtitle$2 = function setYtitle$2(options, title) {\n    options.scales.y.title.display = true;\n    options.scales.y.title.text = title;\n  }; // https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n\n\n  var addOpacity = function addOpacity(hex, opacity) {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? \"rgba(\" + parseInt(result[1], 16) + \", \" + parseInt(result[2], 16) + \", \" + parseInt(result[3], 16) + \", \" + opacity + \")\" : hex;\n  }; // check if not null or undefined\n  // https://stackoverflow.com/a/27757708/1177228\n\n\n  var notnull = function notnull(x) {\n    return x != null;\n  };\n\n  var setLabelSize = function setLabelSize(chart, data, options) {\n    var maxLabelSize = Math.ceil(chart.element.offsetWidth / 4.0 / data.labels.length);\n\n    if (maxLabelSize > 25) {\n      maxLabelSize = 25;\n    } else if (maxLabelSize < 10) {\n      maxLabelSize = 10;\n    }\n\n    if (!options.scales.x.ticks.callback) {\n      options.scales.x.ticks.callback = function (value) {\n        value = toStr(this.getLabelForValue(value));\n\n        if (value.length > maxLabelSize) {\n          return value.substring(0, maxLabelSize - 2) + \"...\";\n        } else {\n          return value;\n        }\n      };\n    }\n  };\n\n  var setFormatOptions$1 = function setFormatOptions$1(chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chart.options.bytes) {\n      var series = chart.data;\n\n      if (chartType === \"pie\") {\n        series = [{\n          data: series\n        }];\n      } // calculate max\n\n\n      var max = 0;\n\n      for (var i = 0; i < series.length; i++) {\n        var s = series[i];\n\n        for (var j = 0; j < s.data.length; j++) {\n          if (s.data[j][1] > max) {\n            max = s.data[j][1];\n          }\n        }\n      } // calculate scale\n\n\n      var scale = 1;\n\n      while (max >= 1024) {\n        scale *= 1024;\n        max /= 1024;\n      } // set step size\n\n\n      formatOptions.byteScale = scale;\n    }\n\n    if (chartType !== \"pie\") {\n      var axis = options.scales.y;\n\n      if (chartType === \"bar\") {\n        axis = options.scales.x;\n      }\n\n      if (formatOptions.byteScale) {\n        if (!axis.ticks.stepSize) {\n          axis.ticks.stepSize = formatOptions.byteScale / 2;\n        }\n\n        if (!axis.ticks.maxTicksLimit) {\n          axis.ticks.maxTicksLimit = 4;\n        }\n      }\n\n      if (!axis.ticks.callback) {\n        axis.ticks.callback = function (value) {\n          return formatValue(\"\", value, formatOptions, true);\n        };\n      }\n    }\n\n    if (!options.plugins.tooltip.callbacks.label) {\n      if (chartType === \"scatter\") {\n        options.plugins.tooltip.callbacks.label = function (context) {\n          var label = context.dataset.label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          return label + '(' + context.label + ', ' + context.formattedValue + ')';\n        };\n      } else if (chartType === \"bubble\") {\n        options.plugins.tooltip.callbacks.label = function (context) {\n          var label = context.dataset.label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          var dataPoint = context.raw;\n          return label + '(' + dataPoint.x + ', ' + dataPoint.y + ', ' + dataPoint.v + ')';\n        };\n      } else if (chartType === \"pie\") {\n        // need to use separate label for pie charts\n        options.plugins.tooltip.callbacks.label = function (context) {\n          var dataLabel = context.label;\n          var value = ': ';\n\n          if (isArray(dataLabel)) {\n            // show value on first line of multiline label\n            // need to clone because we are changing the value\n            dataLabel = dataLabel.slice();\n            dataLabel[0] += value;\n          } else {\n            dataLabel += value;\n          }\n\n          return formatValue(dataLabel, context.parsed, formatOptions);\n        };\n      } else {\n        var valueLabel = chartType === \"bar\" ? \"x\" : \"y\";\n\n        options.plugins.tooltip.callbacks.label = function (context) {\n          var label = context.dataset.label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          return formatValue(label, context.parsed[valueLabel], formatOptions);\n        };\n      }\n    }\n  };\n\n  var jsOptions$2 = jsOptionsFunc(merge(baseOptions, defaultOptions$2), hideLegend$2, setTitle$2, setMin$2, setMax$2, setStacked$2, setXtitle$2, setYtitle$2);\n\n  var createDataTable = function createDataTable(chart, options, chartType) {\n    var datasets = [];\n    var labels = [];\n    var colors = chart.options.colors || defaultColors;\n    var day = true;\n    var week = true;\n    var dayOfWeek;\n    var month = true;\n    var year = true;\n    var hour = true;\n    var minute = true;\n    var series = chart.data;\n    var max = 0;\n\n    if (chartType === \"bubble\") {\n      for (var i$1 = 0; i$1 < series.length; i$1++) {\n        var s$1 = series[i$1];\n\n        for (var j$1 = 0; j$1 < s$1.data.length; j$1++) {\n          if (s$1.data[j$1][2] > max) {\n            max = s$1.data[j$1][2];\n          }\n        }\n      }\n    }\n\n    var i,\n        j,\n        s,\n        d,\n        key,\n        rows = [],\n        rows2 = [];\n\n    if (chartType === \"bar\" || chartType === \"column\" || chart.xtype !== \"number\" && chart.xtype !== \"bubble\") {\n      var sortedLabels = [];\n\n      for (i = 0; i < series.length; i++) {\n        s = series[i];\n\n        for (j = 0; j < s.data.length; j++) {\n          d = s.data[j];\n          key = chart.xtype == \"datetime\" ? d[0].getTime() : d[0];\n\n          if (!rows[key]) {\n            rows[key] = new Array(series.length);\n          }\n\n          rows[key][i] = toFloat(d[1]);\n\n          if (sortedLabels.indexOf(key) === -1) {\n            sortedLabels.push(key);\n          }\n        }\n      }\n\n      if (chart.xtype === \"datetime\" || chart.xtype === \"number\") {\n        sortedLabels.sort(sortByNumber);\n      }\n\n      for (j = 0; j < series.length; j++) {\n        rows2.push([]);\n      }\n\n      var value;\n      var k;\n\n      for (k = 0; k < sortedLabels.length; k++) {\n        i = sortedLabels[k];\n\n        if (chart.xtype === \"datetime\") {\n          value = new Date(toFloat(i)); // TODO make this efficient\n\n          day = day && isDay(value);\n\n          if (!dayOfWeek) {\n            dayOfWeek = value.getDay();\n          }\n\n          week = week && isWeek(value, dayOfWeek);\n          month = month && isMonth(value);\n          year = year && isYear(value);\n          hour = hour && isHour(value);\n          minute = minute && isMinute(value);\n        } else {\n          value = i;\n        }\n\n        labels.push(value);\n\n        for (j = 0; j < series.length; j++) {\n          // Chart.js doesn't like undefined\n          rows2[j].push(rows[i][j] === undefined ? null : rows[i][j]);\n        }\n      }\n    } else {\n      for (var i$2 = 0; i$2 < series.length; i$2++) {\n        var s$2 = series[i$2];\n        var d$1 = [];\n\n        for (var j$2 = 0; j$2 < s$2.data.length; j$2++) {\n          var point = {\n            x: toFloat(s$2.data[j$2][0]),\n            y: toFloat(s$2.data[j$2][1])\n          };\n\n          if (chartType === \"bubble\") {\n            point.r = toFloat(s$2.data[j$2][2]) * 20 / max; // custom attribute, for tooltip\n\n            point.v = s$2.data[j$2][2];\n          }\n\n          d$1.push(point);\n        }\n\n        rows2.push(d$1);\n      }\n    }\n\n    var color;\n    var backgroundColor;\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i]; // use colors for each bar for single series format\n\n      if (chart.options.colors && chart.singleSeriesFormat && (chartType === \"bar\" || chartType === \"column\") && !s.color) {\n        color = colors;\n        backgroundColor = [];\n\n        for (var j$3 = 0; j$3 < colors.length; j$3++) {\n          backgroundColor[j$3] = addOpacity(color[j$3], 0.5);\n        }\n      } else {\n        color = s.color || colors[i];\n        backgroundColor = chartType !== \"line\" ? addOpacity(color, 0.5) : color;\n      }\n\n      var dataset = {\n        label: s.name || \"\",\n        data: rows2[i],\n        fill: chartType === \"area\",\n        borderColor: color,\n        backgroundColor: backgroundColor,\n        borderWidth: 2\n      };\n      var pointChart = chartType === \"line\" || chartType === \"area\" || chartType === \"scatter\" || chartType === \"bubble\";\n\n      if (pointChart) {\n        dataset.pointBackgroundColor = color;\n        dataset.pointHoverBackgroundColor = color;\n        dataset.pointHitRadius = 50;\n      }\n\n      if (chartType === \"bubble\") {\n        dataset.pointBackgroundColor = backgroundColor;\n        dataset.pointHoverBackgroundColor = backgroundColor;\n        dataset.pointHoverBorderWidth = 2;\n      }\n\n      if (s.stack) {\n        dataset.stack = s.stack;\n      }\n\n      var curve = seriesOption(chart, s, \"curve\");\n\n      if (curve === false) {\n        dataset.tension = 0;\n      } else if (pointChart) {\n        dataset.tension = 0.4;\n      }\n\n      var points = seriesOption(chart, s, \"points\");\n\n      if (points === false) {\n        dataset.pointRadius = 0;\n        dataset.pointHoverRadius = 0;\n      }\n\n      dataset = merge(dataset, chart.options.dataset || {});\n      dataset = merge(dataset, s.library || {});\n      dataset = merge(dataset, s.dataset || {});\n      datasets.push(dataset);\n    }\n\n    var xmin = chart.options.xmin;\n    var xmax = chart.options.xmax;\n\n    if (chart.xtype === \"datetime\") {\n      if (notnull(xmin)) {\n        options.scales.x.ticks.min = toDate(xmin).getTime();\n      }\n\n      if (notnull(xmax)) {\n        options.scales.x.ticks.max = toDate(xmax).getTime();\n      }\n    } else if (chart.xtype === \"number\") {\n      if (notnull(xmin)) {\n        options.scales.x.ticks.min = xmin;\n      }\n\n      if (notnull(xmax)) {\n        options.scales.x.ticks.max = xmax;\n      }\n    } // for empty datetime chart\n\n\n    if (chart.xtype === \"datetime\" && labels.length === 0) {\n      if (notnull(xmin)) {\n        labels.push(toDate(xmin));\n      }\n\n      if (notnull(xmax)) {\n        labels.push(toDate(xmax));\n      }\n\n      day = false;\n      week = false;\n      month = false;\n      year = false;\n      hour = false;\n      minute = false;\n    }\n\n    if (chart.xtype === \"datetime\" && labels.length > 0) {\n      var minTime = (notnull(xmin) ? toDate(xmin) : labels[0]).getTime();\n      var maxTime = (notnull(xmax) ? toDate(xmax) : labels[0]).getTime();\n\n      for (i = 1; i < labels.length; i++) {\n        var value$1 = labels[i].getTime();\n\n        if (value$1 < minTime) {\n          minTime = value$1;\n        }\n\n        if (value$1 > maxTime) {\n          maxTime = value$1;\n        }\n      }\n\n      var timeDiff = (maxTime - minTime) / (86400 * 1000.0);\n\n      if (!options.scales.x.time.unit) {\n        var step;\n\n        if (year || timeDiff > 365 * 10) {\n          options.scales.x.time.unit = \"year\";\n          step = 365;\n        } else if (month || timeDiff > 30 * 10) {\n          options.scales.x.time.unit = \"month\";\n          step = 30;\n        } else if (day || timeDiff > 10) {\n          options.scales.x.time.unit = \"day\";\n          step = 1;\n        } else if (hour || timeDiff > 0.5) {\n          options.scales.x.time.displayFormats = {\n            hour: \"MMM d, h a\"\n          };\n          options.scales.x.time.unit = \"hour\";\n          step = 1 / 24.0;\n        } else if (minute) {\n          options.scales.x.time.displayFormats = {\n            minute: \"h:mm a\"\n          };\n          options.scales.x.time.unit = \"minute\";\n          step = 1 / 24.0 / 60.0;\n        }\n\n        if (step && timeDiff > 0) {\n          var unitStepSize = Math.ceil(timeDiff / step / (chart.element.offsetWidth / 100.0));\n\n          if (week && step === 1) {\n            unitStepSize = Math.ceil(unitStepSize / 7.0) * 7;\n          }\n\n          options.scales.x.time.stepSize = unitStepSize;\n        }\n      }\n\n      if (!options.scales.x.time.tooltipFormat) {\n        if (day) {\n          options.scales.x.time.tooltipFormat = \"PP\";\n        } else if (hour) {\n          options.scales.x.time.tooltipFormat = \"MMM d, h a\";\n        } else if (minute) {\n          options.scales.x.time.tooltipFormat = \"h:mm a\";\n        }\n      }\n    }\n\n    var data = {\n      labels: labels,\n      datasets: datasets\n    };\n    return data;\n  };\n\n  var defaultExport$2 = function defaultExport(library) {\n    this.name = \"chartjs\";\n    this.library = library;\n  };\n\n  defaultExport$2.prototype.renderLineChart = function renderLineChart(chart, chartType) {\n    var chartOptions = {}; // fix for https://github.com/chartjs/Chart.js/issues/2441\n\n    if (!chart.options.max && allZeros(chart.data)) {\n      chartOptions.max = 1;\n    }\n\n    var options = jsOptions$2(chart, merge(chartOptions, chart.options));\n    setFormatOptions$1(chart, options, chartType);\n    var data = createDataTable(chart, options, chartType || \"line\");\n\n    if (chart.xtype === \"number\") {\n      options.scales.x.type = \"linear\";\n      options.scales.x.position = \"bottom\";\n    } else {\n      options.scales.x.type = chart.xtype === \"string\" ? \"category\" : \"time\";\n    }\n\n    this.drawChart(chart, \"line\", data, options);\n  };\n\n  defaultExport$2.prototype.renderPieChart = function renderPieChart(chart) {\n    var options = merge({}, baseOptions);\n\n    if (chart.options.donut) {\n      options.cutout = \"50%\";\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend$2(options, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle$2(options, chart.options.title);\n    }\n\n    options = merge(options, chart.options.library || {});\n    setFormatOptions$1(chart, options, \"pie\");\n    var labels = [];\n    var values = [];\n\n    for (var i = 0; i < chart.data.length; i++) {\n      var point = chart.data[i];\n      labels.push(point[0]);\n      values.push(point[1]);\n    }\n\n    var dataset = {\n      data: values,\n      backgroundColor: chart.options.colors || defaultColors\n    };\n    dataset = merge(dataset, chart.options.dataset || {});\n    var data = {\n      labels: labels,\n      datasets: [dataset]\n    };\n    this.drawChart(chart, \"pie\", data, options);\n  };\n\n  defaultExport$2.prototype.renderColumnChart = function renderColumnChart(chart, chartType) {\n    var options;\n\n    if (chartType === \"bar\") {\n      var barOptions = merge(baseOptions, defaultOptions$2);\n      barOptions.indexAxis = \"y\"; // ensure gridlines have proper orientation\n\n      barOptions.scales.x.grid.drawOnChartArea = true;\n      barOptions.scales.y.grid.drawOnChartArea = false;\n      delete barOptions.scales.y.ticks.maxTicksLimit;\n      options = jsOptionsFunc(barOptions, hideLegend$2, setTitle$2, setBarMin$1, setBarMax$1, setStacked$2, setXtitle$2, setYtitle$2)(chart, chart.options);\n    } else {\n      options = jsOptions$2(chart, chart.options);\n    }\n\n    setFormatOptions$1(chart, options, chartType);\n    var data = createDataTable(chart, options, \"column\");\n\n    if (chartType !== \"bar\") {\n      setLabelSize(chart, data, options);\n    }\n\n    this.drawChart(chart, \"bar\", data, options);\n  };\n\n  defaultExport$2.prototype.renderAreaChart = function renderAreaChart(chart) {\n    this.renderLineChart(chart, \"area\");\n  };\n\n  defaultExport$2.prototype.renderBarChart = function renderBarChart(chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport$2.prototype.renderScatterChart = function renderScatterChart(chart, chartType) {\n    chartType = chartType || \"scatter\";\n    var options = jsOptions$2(chart, chart.options);\n    setFormatOptions$1(chart, options, chartType);\n\n    if (!(\"showLine\" in options)) {\n      options.showLine = false;\n    }\n\n    var data = createDataTable(chart, options, chartType);\n    options.scales.x.type = \"linear\";\n    options.scales.x.position = \"bottom\"; // prevent grouping hover and tooltips\n\n    if (!(\"mode\" in options.interaction)) {\n      options.interaction.mode = \"nearest\";\n    }\n\n    this.drawChart(chart, chartType, data, options);\n  };\n\n  defaultExport$2.prototype.renderBubbleChart = function renderBubbleChart(chart) {\n    this.renderScatterChart(chart, \"bubble\");\n  };\n\n  defaultExport$2.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport$2.prototype.drawChart = function drawChart(chart, type, data, options) {\n    this.destroy(chart);\n\n    if (chart.destroyed) {\n      return;\n    }\n\n    var chartOptions = {\n      type: type,\n      data: data,\n      options: options\n    };\n\n    if (chart.options.code) {\n      window.console.log(\"new Chart(ctx, \" + JSON.stringify(chartOptions) + \");\");\n    }\n\n    chart.element.innerHTML = \"<canvas></canvas>\";\n    var ctx = chart.element.getElementsByTagName(\"CANVAS\")[0];\n    chart.chart = new this.library(ctx, chartOptions);\n  };\n\n  var defaultOptions$1 = {\n    chart: {},\n    xAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    yAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    title: {\n      text: null\n    },\n    credits: {\n      enabled: false\n    },\n    legend: {\n      borderWidth: 0\n    },\n    tooltip: {\n      style: {\n        fontSize: \"12px\"\n      }\n    },\n    plotOptions: {\n      areaspline: {},\n      area: {},\n      series: {\n        marker: {}\n      }\n    },\n    time: {\n      useUTC: false\n    }\n  };\n\n  var hideLegend$1 = function hideLegend$1(options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.enabled = !!legend;\n\n      if (legend && legend !== true) {\n        if (legend === \"top\" || legend === \"bottom\") {\n          options.legend.verticalAlign = legend;\n        } else {\n          options.legend.layout = \"vertical\";\n          options.legend.verticalAlign = \"middle\";\n          options.legend.align = legend;\n        }\n      }\n    } else if (hideLegend) {\n      options.legend.enabled = false;\n    }\n  };\n\n  var setTitle$1 = function setTitle$1(options, title) {\n    options.title.text = title;\n  };\n\n  var setMin$1 = function setMin$1(options, min) {\n    options.yAxis.min = min;\n  };\n\n  var setMax$1 = function setMax$1(options, max) {\n    options.yAxis.max = max;\n  };\n\n  var setStacked$1 = function setStacked$1(options, stacked) {\n    var stackedValue = stacked ? stacked === true ? \"normal\" : stacked : null;\n    options.plotOptions.series.stacking = stackedValue;\n    options.plotOptions.area.stacking = stackedValue;\n    options.plotOptions.areaspline.stacking = stackedValue;\n  };\n\n  var setXtitle$1 = function setXtitle$1(options, title) {\n    options.xAxis.title.text = title;\n  };\n\n  var setYtitle$1 = function setYtitle$1(options, title) {\n    options.yAxis.title.text = title;\n  };\n\n  var jsOptions$1 = jsOptionsFunc(defaultOptions$1, hideLegend$1, setTitle$1, setMin$1, setMax$1, setStacked$1, setXtitle$1, setYtitle$1);\n\n  var setFormatOptions = function setFormatOptions(chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chartType !== \"pie\" && !options.yAxis.labels.formatter) {\n      options.yAxis.labels.formatter = function () {\n        return formatValue(\"\", this.value, formatOptions);\n      };\n    }\n\n    if (!options.tooltip.pointFormatter) {\n      options.tooltip.pointFormatter = function () {\n        return '<span style=\"color:' + this.color + \"\\\">\\u25CF</span> \" + formatValue(this.series.name + ': <b>', this.y, formatOptions) + '</b><br/>';\n      };\n    }\n  };\n\n  var defaultExport$1 = function defaultExport(library) {\n    this.name = \"highcharts\";\n    this.library = library;\n  };\n\n  defaultExport$1.prototype.renderLineChart = function renderLineChart(chart, chartType) {\n    chartType = chartType || \"spline\";\n    var chartOptions = {};\n\n    if (chartType === \"areaspline\") {\n      chartOptions = {\n        plotOptions: {\n          areaspline: {\n            stacking: \"normal\"\n          },\n          area: {\n            stacking: \"normal\"\n          },\n          series: {\n            marker: {\n              enabled: false\n            }\n          }\n        }\n      };\n    }\n\n    if (chart.options.curve === false) {\n      if (chartType === \"areaspline\") {\n        chartType = \"area\";\n      } else if (chartType === \"spline\") {\n        chartType = \"line\";\n      }\n    }\n\n    var options = jsOptions$1(chart, chart.options, chartOptions),\n        data,\n        i,\n        j;\n    options.xAxis.type = chart.xtype === \"string\" ? \"category\" : chart.xtype === \"number\" ? \"linear\" : \"datetime\";\n\n    if (!options.chart.type) {\n      options.chart.type = chartType;\n    }\n\n    setFormatOptions(chart, options, chartType);\n    var series = chart.data;\n\n    for (i = 0; i < series.length; i++) {\n      series[i].name = series[i].name || \"Value\";\n      data = series[i].data;\n\n      if (chart.xtype === \"datetime\") {\n        for (j = 0; j < data.length; j++) {\n          data[j][0] = data[j][0].getTime();\n        }\n      }\n\n      series[i].marker = {\n        symbol: \"circle\"\n      };\n\n      if (chart.options.points === false) {\n        series[i].marker.enabled = false;\n      }\n    }\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderScatterChart = function renderScatterChart(chart) {\n    var options = jsOptions$1(chart, chart.options, {});\n    options.chart.type = \"scatter\";\n    this.drawChart(chart, chart.data, options);\n  };\n\n  defaultExport$1.prototype.renderPieChart = function renderPieChart(chart) {\n    var chartOptions = merge(defaultOptions$1, {});\n\n    if (chart.options.colors) {\n      chartOptions.colors = chart.options.colors;\n    }\n\n    if (chart.options.donut) {\n      chartOptions.plotOptions = {\n        pie: {\n          innerSize: \"50%\"\n        }\n      };\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend$1(chartOptions, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle$1(chartOptions, chart.options.title);\n    }\n\n    var options = merge(chartOptions, chart.options.library || {});\n    setFormatOptions(chart, options, \"pie\");\n    var series = [{\n      type: \"pie\",\n      name: chart.options.label || \"Value\",\n      data: chart.data\n    }];\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderColumnChart = function renderColumnChart(chart, chartType) {\n    chartType = chartType || \"column\";\n    var series = chart.data;\n    var options = jsOptions$1(chart, chart.options),\n        i,\n        j,\n        s,\n        d,\n        rows = [],\n        categories = [];\n    options.chart.type = chartType;\n    setFormatOptions(chart, options, chartType);\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n\n        if (!rows[d[0]]) {\n          rows[d[0]] = new Array(series.length);\n          categories.push(d[0]);\n        }\n\n        rows[d[0]][i] = d[1];\n      }\n    }\n\n    if (chart.xtype === \"number\") {\n      categories.sort(sortByNumber);\n    }\n\n    options.xAxis.categories = categories;\n    var newSeries = [],\n        d2;\n\n    for (i = 0; i < series.length; i++) {\n      d = [];\n\n      for (j = 0; j < categories.length; j++) {\n        d.push(rows[categories[j]][i] || 0);\n      }\n\n      d2 = {\n        name: series[i].name || \"Value\",\n        data: d\n      };\n\n      if (series[i].stack) {\n        d2.stack = series[i].stack;\n      }\n\n      newSeries.push(d2);\n    }\n\n    this.drawChart(chart, newSeries, options);\n  };\n\n  defaultExport$1.prototype.renderBarChart = function renderBarChart(chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport$1.prototype.renderAreaChart = function renderAreaChart(chart) {\n    this.renderLineChart(chart, \"areaspline\");\n  };\n\n  defaultExport$1.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport$1.prototype.drawChart = function drawChart(chart, data, options) {\n    this.destroy(chart);\n\n    if (chart.destroyed) {\n      return;\n    }\n\n    options.chart.renderTo = chart.element.id;\n    options.series = data;\n\n    if (chart.options.code) {\n      window.console.log(\"new Highcharts.Chart(\" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.Chart(options);\n  };\n\n  var loaded = {};\n  var callbacks = []; // Set chart options\n\n  var defaultOptions = {\n    chartArea: {},\n    fontName: \"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif\",\n    pointSize: 6,\n    legend: {\n      textStyle: {\n        fontSize: 12,\n        color: \"#444\"\n      },\n      alignment: \"center\",\n      position: \"right\"\n    },\n    curveType: \"function\",\n    hAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      gridlines: {\n        color: \"transparent\"\n      },\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    vAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    tooltip: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      }\n    }\n  };\n\n  var hideLegend = function hideLegend(options, legend, _hideLegend) {\n    if (legend !== undefined) {\n      var position;\n\n      if (!legend) {\n        position = \"none\";\n      } else if (legend === true) {\n        position = \"right\";\n      } else {\n        position = legend;\n      }\n\n      options.legend.position = position;\n    } else if (_hideLegend) {\n      options.legend.position = \"none\";\n    }\n  };\n\n  var setTitle = function setTitle(options, title) {\n    options.title = title;\n    options.titleTextStyle = {\n      color: \"#333\",\n      fontSize: \"20px\"\n    };\n  };\n\n  var setMin = function setMin(options, min) {\n    options.vAxis.viewWindow.min = min;\n  };\n\n  var setMax = function setMax(options, max) {\n    options.vAxis.viewWindow.max = max;\n  };\n\n  var setBarMin = function setBarMin(options, min) {\n    options.hAxis.viewWindow.min = min;\n  };\n\n  var setBarMax = function setBarMax(options, max) {\n    options.hAxis.viewWindow.max = max;\n  };\n\n  var setStacked = function setStacked(options, stacked) {\n    options.isStacked = stacked ? stacked : false;\n  };\n\n  var setXtitle = function setXtitle(options, title) {\n    options.hAxis.title = title;\n    options.hAxis.titleTextStyle.italic = false;\n  };\n\n  var setYtitle = function setYtitle(options, title) {\n    options.vAxis.title = title;\n    options.vAxis.titleTextStyle.italic = false;\n  };\n\n  var jsOptions = jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\n  var resize = function resize(callback) {\n    if (window.attachEvent) {\n      window.attachEvent(\"onresize\", callback);\n    } else if (window.addEventListener) {\n      window.addEventListener(\"resize\", callback, true);\n    }\n\n    callback();\n  };\n\n  var defaultExport = function defaultExport(library) {\n    this.name = \"google\";\n    this.library = library;\n  };\n\n  defaultExport.prototype.renderLineChart = function renderLineChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n\n      if (chart.options.curve === false) {\n        chartOptions.curveType = \"none\";\n      }\n\n      if (chart.options.points === false) {\n        chartOptions.pointSize = 0;\n      }\n\n      var options = jsOptions(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"LineChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderPieChart = function renderPieChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        chartArea: {\n          top: \"10%\",\n          height: \"80%\"\n        },\n        legend: {}\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n\n      if (chart.options.donut) {\n        chartOptions.pieHole = 0.5;\n      }\n\n      if (\"legend\" in chart.options) {\n        hideLegend(chartOptions, chart.options.legend);\n      }\n\n      if (chart.options.title) {\n        setTitle(chartOptions, chart.options.title);\n      }\n\n      var options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", \"Value\");\n      data.addRows(chart.data);\n      this$1.drawChart(chart, \"PieChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderColumnChart = function renderColumnChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var options = jsOptions(chart, chart.options);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"ColumnChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderBarChart = function renderBarChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        hAxis: {\n          gridlines: {\n            color: \"#ccc\"\n          }\n        }\n      };\n      var options = jsOptionsFunc(defaultOptions, hideLegend, setTitle, setBarMin, setBarMax, setStacked, setXtitle, setYtitle)(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"BarChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderAreaChart = function renderAreaChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        isStacked: true,\n        pointSize: 0,\n        areaOpacity: 0.5\n      };\n      var options = jsOptions(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"AreaChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderGeoChart = function renderGeoChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, \"geochart\", function () {\n      var chartOptions = {\n        legend: \"none\",\n        colorAxis: {\n          colors: chart.options.colors || [\"#f6c7b6\", \"#ce502d\"]\n        }\n      };\n      var options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", chart.options.label || \"Value\");\n      data.addRows(chart.data);\n      this$1.drawChart(chart, \"GeoChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderScatterChart = function renderScatterChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n      var options = jsOptions(chart, chart.options, chartOptions);\n      var series = chart.data,\n          rows2 = [],\n          i,\n          j,\n          data,\n          d;\n\n      for (i = 0; i < series.length; i++) {\n        series[i].name = series[i].name || \"Value\";\n        d = series[i].data;\n\n        for (j = 0; j < d.length; j++) {\n          var row = new Array(series.length + 1);\n          row[0] = d[j][0];\n          row[i + 1] = d[j][1];\n          rows2.push(row);\n        }\n      }\n\n      data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"number\", \"\");\n\n      for (i = 0; i < series.length; i++) {\n        data.addColumn(\"number\", series[i].name);\n      }\n\n      data.addRows(rows2);\n      this$1.drawChart(chart, \"ScatterChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderTimeline = function renderTimeline(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, \"timeline\", function () {\n      var chartOptions = {\n        legend: \"none\"\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n\n      var options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn({\n        type: \"string\",\n        id: \"Name\"\n      });\n      data.addColumn({\n        type: \"date\",\n        id: \"Start\"\n      });\n      data.addColumn({\n        type: \"date\",\n        id: \"End\"\n      });\n      data.addRows(chart.data);\n      chart.element.style.lineHeight = \"normal\";\n      this$1.drawChart(chart, \"Timeline\", data, options);\n    });\n  }; // TODO remove resize events\n\n\n  defaultExport.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.clearChart();\n    }\n  };\n\n  defaultExport.prototype.drawChart = function drawChart(chart, type, data, options) {\n    this.destroy(chart);\n\n    if (chart.destroyed) {\n      return;\n    }\n\n    if (chart.options.code) {\n      window.console.log(\"var data = new google.visualization.DataTable(\" + data.toJSON() + \");\\nvar chart = new google.visualization.\" + type + \"(element);\\nchart.draw(data, \" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.visualization[type](chart.element);\n    resize(function () {\n      chart.chart.draw(data, options);\n    });\n  };\n\n  defaultExport.prototype.waitForLoaded = function waitForLoaded(chart, pack, callback) {\n    var this$1 = this;\n\n    if (!callback) {\n      callback = pack;\n      pack = \"corechart\";\n    }\n\n    callbacks.push({\n      pack: pack,\n      callback: callback\n    });\n\n    if (loaded[pack]) {\n      this.runCallbacks();\n    } else {\n      loaded[pack] = true; // https://groups.google.com/forum/#!topic/google-visualization-api/fMKJcyA2yyI\n\n      var loadOptions = {\n        packages: [pack],\n        callback: function callback() {\n          this$1.runCallbacks();\n        }\n      };\n\n      var config = chart.__config();\n\n      if (config.language) {\n        loadOptions.language = config.language;\n      }\n\n      if (pack === \"geochart\" && config.mapsApiKey) {\n        loadOptions.mapsApiKey = config.mapsApiKey;\n      }\n\n      this.library.charts.load(\"current\", loadOptions);\n    }\n  };\n\n  defaultExport.prototype.runCallbacks = function runCallbacks() {\n    var cb, call;\n\n    for (var i = 0; i < callbacks.length; i++) {\n      cb = callbacks[i];\n      call = this.library.visualization && (cb.pack === \"corechart\" && this.library.visualization.LineChart || cb.pack === \"timeline\" && this.library.visualization.Timeline || cb.pack === \"geochart\" && this.library.visualization.GeoChart);\n\n      if (call) {\n        cb.callback();\n        callbacks.splice(i, 1);\n        i--;\n      }\n    }\n  }; // cant use object as key\n\n\n  defaultExport.prototype.createDataTable = function createDataTable(series, columnType) {\n    var i,\n        j,\n        s,\n        d,\n        key,\n        rows = [],\n        sortedLabels = [];\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n      series[i].name = series[i].name || \"Value\";\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        key = columnType === \"datetime\" ? d[0].getTime() : d[0];\n\n        if (!rows[key]) {\n          rows[key] = new Array(series.length);\n          sortedLabels.push(key);\n        }\n\n        rows[key][i] = toFloat(d[1]);\n      }\n    }\n\n    var rows2 = [];\n    var day = true;\n    var value;\n\n    for (j = 0; j < sortedLabels.length; j++) {\n      i = sortedLabels[j];\n\n      if (columnType === \"datetime\") {\n        value = new Date(toFloat(i));\n        day = day && isDay(value);\n      } else if (columnType === \"number\") {\n        value = toFloat(i);\n      } else {\n        value = i;\n      }\n\n      rows2.push([value].concat(rows[i]));\n    }\n\n    if (columnType === \"datetime\") {\n      rows2.sort(sortByTime);\n    } else if (columnType === \"number\") {\n      rows2.sort(sortByNumberSeries);\n\n      for (i = 0; i < rows2.length; i++) {\n        rows2[i][0] = toStr(rows2[i][0]);\n      }\n\n      columnType = \"string\";\n    } // create datatable\n\n\n    var data = new this.library.visualization.DataTable();\n    columnType = columnType === \"datetime\" && day ? \"date\" : columnType;\n    data.addColumn(columnType, \"\");\n\n    for (i = 0; i < series.length; i++) {\n      data.addColumn(\"number\", series[i].name);\n    }\n\n    data.addRows(rows2);\n    return data;\n  };\n\n  var pendingRequests = [],\n      runningRequests = 0,\n      maxRequests = 4;\n\n  function pushRequest(url, success, error) {\n    pendingRequests.push([url, success, error]);\n    runNext();\n  }\n\n  function runNext() {\n    if (runningRequests < maxRequests) {\n      var request = pendingRequests.shift();\n\n      if (request) {\n        runningRequests++;\n        getJSON(request[0], request[1], request[2]);\n        runNext();\n      }\n    }\n  }\n\n  function requestComplete() {\n    runningRequests--;\n    runNext();\n  }\n\n  function getJSON(url, success, error) {\n    ajaxCall(url, success, function (jqXHR, textStatus, errorThrown) {\n      var message = typeof errorThrown === \"string\" ? errorThrown : errorThrown.message;\n      error(message);\n    });\n  }\n\n  function ajaxCall(url, success, error) {\n    var $ = window.jQuery || window.Zepto || window.$;\n\n    if ($ && $.ajax) {\n      $.ajax({\n        dataType: \"json\",\n        url: url,\n        success: success,\n        error: error,\n        complete: requestComplete\n      });\n    } else {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", url, true);\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n\n      xhr.onload = function () {\n        requestComplete();\n\n        if (xhr.status === 200) {\n          success(JSON.parse(xhr.responseText), xhr.statusText, xhr);\n        } else {\n          error(xhr, \"error\", xhr.statusText);\n        }\n      };\n\n      xhr.send();\n    }\n  }\n\n  var config = {};\n  var adapters = []; // helpers\n\n  function setText(element, text) {\n    if (document.body.innerText) {\n      element.innerText = text;\n    } else {\n      element.textContent = text;\n    }\n  } // TODO remove prefix for all messages\n\n\n  function chartError(element, message, noPrefix) {\n    if (!noPrefix) {\n      message = \"Error Loading Chart: \" + message;\n    }\n\n    setText(element, message);\n    element.style.color = \"#ff0000\";\n  }\n\n  function errorCatcher(chart) {\n    try {\n      chart.__render();\n    } catch (err) {\n      chartError(chart.element, err.message);\n      throw err;\n    }\n  }\n\n  function fetchDataSource(chart, dataSource, showLoading) {\n    // only show loading message for urls and callbacks\n    if (showLoading && chart.options.loading && (typeof dataSource === \"string\" || typeof dataSource === \"function\")) {\n      setText(chart.element, chart.options.loading);\n    }\n\n    if (typeof dataSource === \"string\") {\n      pushRequest(dataSource, function (data) {\n        chart.rawData = data;\n        errorCatcher(chart);\n      }, function (message) {\n        chartError(chart.element, message);\n      });\n    } else if (typeof dataSource === \"function\") {\n      try {\n        dataSource(function (data) {\n          chart.rawData = data;\n          errorCatcher(chart);\n        }, function (message) {\n          chartError(chart.element, message, true);\n        });\n      } catch (err) {\n        chartError(chart.element, err, true);\n      }\n    } else {\n      chart.rawData = dataSource;\n      errorCatcher(chart);\n    }\n  }\n\n  function addDownloadButton(chart) {\n    var element = chart.element;\n    var link = document.createElement(\"a\");\n    var download = chart.options.download;\n\n    if (download === true) {\n      download = {};\n    } else if (typeof download === \"string\") {\n      download = {\n        filename: download\n      };\n    }\n\n    link.download = download.filename || \"chart.png\"; // https://caniuse.com/download\n\n    link.style.position = \"absolute\";\n    link.style.top = \"20px\";\n    link.style.right = \"20px\";\n    link.style.zIndex = 1000;\n    link.style.lineHeight = \"20px\";\n    link.target = \"_blank\"; // for safari\n\n    var image = document.createElement(\"img\");\n    image.alt = \"Download\";\n    image.style.border = \"none\"; // icon from font-awesome\n    // http://fa2png.io/\n\n    image.src = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABCFBMVEUAAADMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMywEsqxAAAAV3RSTlMAAQIDBggJCgsMDQ4PERQaHB0eISIjJCouLzE0OTo/QUJHSUpLTU5PUllhYmltcHh5foWLjI+SlaCio6atr7S1t7m6vsHHyM7R2tze5Obo7fHz9ff5+/1hlxK2AAAA30lEQVQYGUXBhVYCQQBA0TdYWAt2d3d3YWAHyur7/z9xgD16Lw0DW+XKx+1GgX+FRzM3HWQWrHl5N/oapW5RPe0PkBu+UYeICvozTWZVK23Ao04B79oJrOsJDOoxkZoQPWgX29pHpCZEk7rEvQYiNSFq1UMqvlCjJkRBS1R8hb00Vb/TajtBL7nTHE1X1vyMQF732dQhyF2o6SAwrzP06iUQzvwsArlnzcOdrgBhJyHa1QOgO9U1GsKuvjUTjavliZYQ8nNPapG6sap/3nrIdJ6bOWzmX/fy0XVpfzZP3S8OJT3g9EEiJwAAAABJRU5ErkJggg==\";\n    link.appendChild(image);\n    element.style.position = \"relative\";\n    chart.__downloadAttached = true; // mouseenter\n\n    chart.__enterEvent = addEvent(element, \"mouseover\", function (e) {\n      var related = e.relatedTarget; // check download option again to ensure it wasn't changed\n\n      if ((!related || related !== this && !childOf(this, related)) && chart.options.download) {\n        link.href = chart.toImage(download);\n        element.appendChild(link);\n      }\n    }); // mouseleave\n\n    chart.__leaveEvent = addEvent(element, \"mouseout\", function (e) {\n      var related = e.relatedTarget;\n\n      if (!related || related !== this && !childOf(this, related)) {\n        if (link.parentNode) {\n          link.parentNode.removeChild(link);\n        }\n      }\n    });\n  } // https://stackoverflow.com/questions/10149963/adding-event-listener-cross-browser\n\n\n  function addEvent(elem, event, fn) {\n    if (elem.addEventListener) {\n      elem.addEventListener(event, fn, false);\n      return fn;\n    } else {\n      var fn2 = function fn2() {\n        // set the this pointer same as addEventListener when fn is called\n        return fn.call(elem, window.event);\n      };\n\n      elem.attachEvent(\"on\" + event, fn2);\n      return fn2;\n    }\n  }\n\n  function removeEvent(elem, event, fn) {\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, fn, false);\n    } else {\n      elem.detachEvent(\"on\" + event, fn);\n    }\n  } // https://gist.github.com/shawnbot/4166283\n\n\n  function childOf(p, c) {\n    if (p === c) {\n      return false;\n    }\n\n    while (c && c !== p) {\n      c = c.parentNode;\n    }\n\n    return c === p;\n  }\n\n  function getAdapterType(library) {\n    if (library) {\n      if (library.product === \"Highcharts\") {\n        return defaultExport$1;\n      } else if (library.charts) {\n        return defaultExport;\n      } else if (isFunction(library)) {\n        return defaultExport$2;\n      }\n    }\n\n    throw new Error(\"Unknown adapter\");\n  }\n\n  function addAdapter(library) {\n    var adapterType = getAdapterType(library);\n    var adapter = new adapterType(library);\n\n    if (adapters.indexOf(adapter) === -1) {\n      adapters.push(adapter);\n    }\n  }\n\n  function loadAdapters() {\n    if (\"Chart\" in window) {\n      addAdapter(window.Chart);\n    }\n\n    if (\"Highcharts\" in window) {\n      addAdapter(window.Highcharts);\n    }\n\n    if (window.google && window.google.charts) {\n      addAdapter(window.google);\n    }\n  }\n\n  function dataEmpty(data, chartType) {\n    if (chartType === \"PieChart\" || chartType === \"GeoChart\" || chartType === \"Timeline\") {\n      return data.length === 0;\n    } else {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].data.length > 0) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n  }\n\n  function renderChart(chartType, chart) {\n    if (dataEmpty(chart.data, chartType)) {\n      var message = chart.options.empty || chart.options.messages && chart.options.messages.empty || \"No data\";\n      setText(chart.element, message);\n    } else {\n      callAdapter(chartType, chart);\n\n      if (chart.options.download && !chart.__downloadAttached && chart.adapter === \"chartjs\") {\n        addDownloadButton(chart);\n      }\n    }\n  } // TODO remove chartType if cross-browser way\n  // to get the name of the chart class\n\n\n  function callAdapter(chartType, chart) {\n    var i, adapter, fnName, adapterName;\n    fnName = \"render\" + chartType;\n    adapterName = chart.options.adapter;\n    loadAdapters();\n\n    for (i = 0; i < adapters.length; i++) {\n      adapter = adapters[i];\n\n      if ((!adapterName || adapterName === adapter.name) && isFunction(adapter[fnName])) {\n        chart.adapter = adapter.name;\n        chart.__adapterObject = adapter;\n        return adapter[fnName](chart);\n      }\n    }\n\n    if (adapters.length > 0) {\n      throw new Error(\"No charting library found for \" + chartType);\n    } else {\n      throw new Error(\"No charting libraries found - be sure to include one before your charts\");\n    }\n  } // process data\n\n\n  var toFormattedKey = function toFormattedKey(key, keyType) {\n    if (keyType === \"number\") {\n      key = toFloat(key);\n    } else if (keyType === \"datetime\") {\n      key = toDate(key);\n    } else {\n      key = toStr(key);\n    }\n\n    return key;\n  };\n\n  var formatSeriesData = function formatSeriesData(data, keyType) {\n    var r = [],\n        key,\n        j;\n\n    for (j = 0; j < data.length; j++) {\n      if (keyType === \"bubble\") {\n        r.push([toFloat(data[j][0]), toFloat(data[j][1]), toFloat(data[j][2])]);\n      } else {\n        key = toFormattedKey(data[j][0], keyType);\n        r.push([key, toFloat(data[j][1])]);\n      }\n    }\n\n    if (keyType === \"datetime\") {\n      r.sort(sortByTime);\n    } else if (keyType === \"number\") {\n      r.sort(sortByNumberSeries);\n    }\n\n    return r;\n  };\n\n  function detectXType(series, noDatetime, options) {\n    if (dataEmpty(series)) {\n      if ((options.xmin || options.xmax) && (!options.xmin || isDate(options.xmin)) && (!options.xmax || isDate(options.xmax))) {\n        return \"datetime\";\n      } else {\n        return \"number\";\n      }\n    } else if (detectXTypeWithFunction(series, isNumber)) {\n      return \"number\";\n    } else if (!noDatetime && detectXTypeWithFunction(series, isDate)) {\n      return \"datetime\";\n    } else {\n      return \"string\";\n    }\n  }\n\n  function detectXTypeWithFunction(series, func) {\n    var i, j, data;\n\n    for (i = 0; i < series.length; i++) {\n      data = toArr(series[i].data);\n\n      for (j = 0; j < data.length; j++) {\n        if (!func(data[j][0])) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  } // creates a shallow copy of each element of the array\n  // elements are expected to be objects\n\n\n  function copySeries(series) {\n    var newSeries = [],\n        i,\n        j;\n\n    for (i = 0; i < series.length; i++) {\n      var copy = {};\n\n      for (j in series[i]) {\n        if (series[i].hasOwnProperty(j)) {\n          copy[j] = series[i][j];\n        }\n      }\n\n      newSeries.push(copy);\n    }\n\n    return newSeries;\n  }\n\n  function processSeries(chart, keyType, noDatetime) {\n    var i;\n    var opts = chart.options;\n    var series = chart.rawData; // see if one series or multiple\n\n    if (!isArray(series) || typeof series[0] !== \"object\" || isArray(series[0])) {\n      series = [{\n        name: opts.label,\n        data: series\n      }];\n      chart.singleSeriesFormat = true;\n    } else {\n      chart.singleSeriesFormat = false;\n    } // convert to array\n    // must come before dataEmpty check\n\n\n    series = copySeries(series);\n\n    for (i = 0; i < series.length; i++) {\n      series[i].data = toArr(series[i].data);\n    }\n\n    chart.xtype = keyType ? keyType : opts.discrete ? \"string\" : detectXType(series, noDatetime, opts); // right format\n\n    for (i = 0; i < series.length; i++) {\n      series[i].data = formatSeriesData(series[i].data, chart.xtype);\n    }\n\n    return series;\n  }\n\n  function processSimple(chart) {\n    var perfectData = toArr(chart.rawData),\n        i;\n\n    for (i = 0; i < perfectData.length; i++) {\n      perfectData[i] = [toStr(perfectData[i][0]), toFloat(perfectData[i][1])];\n    }\n\n    return perfectData;\n  } // define classes\n\n\n  var Chart = function Chart(element, dataSource, options) {\n    var elementId;\n\n    if (typeof element === \"string\") {\n      elementId = element;\n      element = document.getElementById(element);\n\n      if (!element) {\n        throw new Error(\"No element with id \" + elementId);\n      }\n    }\n\n    this.element = element;\n    this.options = merge(Chartkick.options, options || {});\n    this.dataSource = dataSource;\n    Chartkick.charts[element.id] = this;\n    fetchDataSource(this, dataSource, true);\n\n    if (this.options.refresh) {\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.getElement = function getElement() {\n    return this.element;\n  };\n\n  Chart.prototype.getDataSource = function getDataSource() {\n    return this.dataSource;\n  };\n\n  Chart.prototype.getData = function getData() {\n    return this.data;\n  };\n\n  Chart.prototype.getOptions = function getOptions() {\n    return this.options;\n  };\n\n  Chart.prototype.getChartObject = function getChartObject() {\n    return this.chart;\n  };\n\n  Chart.prototype.getAdapter = function getAdapter() {\n    return this.adapter;\n  };\n\n  Chart.prototype.updateData = function updateData(dataSource, options) {\n    this.dataSource = dataSource;\n\n    if (options) {\n      this.__updateOptions(options);\n    }\n\n    fetchDataSource(this, dataSource, true);\n  };\n\n  Chart.prototype.setOptions = function setOptions(options) {\n    this.__updateOptions(options);\n\n    this.redraw();\n  };\n\n  Chart.prototype.redraw = function redraw() {\n    fetchDataSource(this, this.rawData);\n  };\n\n  Chart.prototype.refreshData = function refreshData() {\n    if (typeof this.dataSource === \"string\") {\n      // prevent browser from caching\n      var sep = this.dataSource.indexOf(\"?\") === -1 ? \"?\" : \"&\";\n      var url = this.dataSource + sep + \"_=\" + new Date().getTime();\n      fetchDataSource(this, url);\n    } else if (typeof this.dataSource === \"function\") {\n      fetchDataSource(this, this.dataSource);\n    }\n  };\n\n  Chart.prototype.startRefresh = function startRefresh() {\n    var this$1 = this;\n    var refresh = this.options.refresh;\n\n    if (refresh && typeof this.dataSource !== \"string\" && typeof this.dataSource !== \"function\") {\n      throw new Error(\"Data source must be a URL or callback for refresh\");\n    }\n\n    if (!this.intervalId) {\n      if (refresh) {\n        this.intervalId = setInterval(function () {\n          this$1.refreshData();\n        }, refresh * 1000);\n      } else {\n        throw new Error(\"No refresh interval\");\n      }\n    }\n  };\n\n  Chart.prototype.stopRefresh = function stopRefresh() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n  };\n\n  Chart.prototype.toImage = function toImage(download) {\n    if (this.adapter === \"chartjs\") {\n      if (download && download.background && download.background !== \"transparent\") {\n        // https://stackoverflow.com/questions/30464750/chartjs-line-chart-set-background-color\n        var canvas = this.chart.chart.canvas;\n        var ctx = this.chart.chart.ctx;\n        var tmpCanvas = document.createElement(\"canvas\");\n        var tmpCtx = tmpCanvas.getContext(\"2d\");\n        tmpCanvas.width = ctx.canvas.width;\n        tmpCanvas.height = ctx.canvas.height;\n        tmpCtx.fillStyle = download.background;\n        tmpCtx.fillRect(0, 0, tmpCanvas.width, tmpCanvas.height);\n        tmpCtx.drawImage(canvas, 0, 0);\n        return tmpCanvas.toDataURL(\"image/png\");\n      } else {\n        return this.chart.toBase64Image();\n      }\n    } else {\n      // TODO throw error in next major version\n      // throw new Error(\"Feature only available for Chart.js\");\n      return null;\n    }\n  };\n\n  Chart.prototype.destroy = function destroy() {\n    this.destroyed = true;\n    this.stopRefresh();\n\n    if (this.__adapterObject) {\n      this.__adapterObject.destroy(this);\n    }\n\n    if (this.__enterEvent) {\n      removeEvent(this.element, \"mouseover\", this.__enterEvent);\n    }\n\n    if (this.__leaveEvent) {\n      removeEvent(this.element, \"mouseout\", this.__leaveEvent);\n    }\n  };\n\n  Chart.prototype.__updateOptions = function __updateOptions(options) {\n    var updateRefresh = options.refresh && options.refresh !== this.options.refresh;\n    this.options = merge(Chartkick.options, options);\n\n    if (updateRefresh) {\n      this.stopRefresh();\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.__render = function __render() {\n    this.data = this.__processData();\n    renderChart(this.__chartName(), this);\n  };\n\n  Chart.prototype.__config = function __config() {\n    return config;\n  };\n\n  var LineChart = /*@__PURE__*/function (Chart) {\n    function LineChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) LineChart.__proto__ = Chart;\n    LineChart.prototype = Object.create(Chart && Chart.prototype);\n    LineChart.prototype.constructor = LineChart;\n\n    LineChart.prototype.__processData = function __processData() {\n      return processSeries(this);\n    };\n\n    LineChart.prototype.__chartName = function __chartName() {\n      return \"LineChart\";\n    };\n\n    return LineChart;\n  }(Chart);\n\n  var PieChart = /*@__PURE__*/function (Chart) {\n    function PieChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) PieChart.__proto__ = Chart;\n    PieChart.prototype = Object.create(Chart && Chart.prototype);\n    PieChart.prototype.constructor = PieChart;\n\n    PieChart.prototype.__processData = function __processData() {\n      return processSimple(this);\n    };\n\n    PieChart.prototype.__chartName = function __chartName() {\n      return \"PieChart\";\n    };\n\n    return PieChart;\n  }(Chart);\n\n  var ColumnChart = /*@__PURE__*/function (Chart) {\n    function ColumnChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) ColumnChart.__proto__ = Chart;\n    ColumnChart.prototype = Object.create(Chart && Chart.prototype);\n    ColumnChart.prototype.constructor = ColumnChart;\n\n    ColumnChart.prototype.__processData = function __processData() {\n      return processSeries(this, null, true);\n    };\n\n    ColumnChart.prototype.__chartName = function __chartName() {\n      return \"ColumnChart\";\n    };\n\n    return ColumnChart;\n  }(Chart);\n\n  var BarChart = /*@__PURE__*/function (Chart) {\n    function BarChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) BarChart.__proto__ = Chart;\n    BarChart.prototype = Object.create(Chart && Chart.prototype);\n    BarChart.prototype.constructor = BarChart;\n\n    BarChart.prototype.__processData = function __processData() {\n      return processSeries(this, null, true);\n    };\n\n    BarChart.prototype.__chartName = function __chartName() {\n      return \"BarChart\";\n    };\n\n    return BarChart;\n  }(Chart);\n\n  var AreaChart = /*@__PURE__*/function (Chart) {\n    function AreaChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) AreaChart.__proto__ = Chart;\n    AreaChart.prototype = Object.create(Chart && Chart.prototype);\n    AreaChart.prototype.constructor = AreaChart;\n\n    AreaChart.prototype.__processData = function __processData() {\n      return processSeries(this);\n    };\n\n    AreaChart.prototype.__chartName = function __chartName() {\n      return \"AreaChart\";\n    };\n\n    return AreaChart;\n  }(Chart);\n\n  var GeoChart = /*@__PURE__*/function (Chart) {\n    function GeoChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) GeoChart.__proto__ = Chart;\n    GeoChart.prototype = Object.create(Chart && Chart.prototype);\n    GeoChart.prototype.constructor = GeoChart;\n\n    GeoChart.prototype.__processData = function __processData() {\n      return processSimple(this);\n    };\n\n    GeoChart.prototype.__chartName = function __chartName() {\n      return \"GeoChart\";\n    };\n\n    return GeoChart;\n  }(Chart);\n\n  var ScatterChart = /*@__PURE__*/function (Chart) {\n    function ScatterChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) ScatterChart.__proto__ = Chart;\n    ScatterChart.prototype = Object.create(Chart && Chart.prototype);\n    ScatterChart.prototype.constructor = ScatterChart;\n\n    ScatterChart.prototype.__processData = function __processData() {\n      return processSeries(this, \"number\");\n    };\n\n    ScatterChart.prototype.__chartName = function __chartName() {\n      return \"ScatterChart\";\n    };\n\n    return ScatterChart;\n  }(Chart);\n\n  var BubbleChart = /*@__PURE__*/function (Chart) {\n    function BubbleChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) BubbleChart.__proto__ = Chart;\n    BubbleChart.prototype = Object.create(Chart && Chart.prototype);\n    BubbleChart.prototype.constructor = BubbleChart;\n\n    BubbleChart.prototype.__processData = function __processData() {\n      return processSeries(this, \"bubble\");\n    };\n\n    BubbleChart.prototype.__chartName = function __chartName() {\n      return \"BubbleChart\";\n    };\n\n    return BubbleChart;\n  }(Chart);\n\n  var Timeline = /*@__PURE__*/function (Chart) {\n    function Timeline() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) Timeline.__proto__ = Chart;\n    Timeline.prototype = Object.create(Chart && Chart.prototype);\n    Timeline.prototype.constructor = Timeline;\n\n    Timeline.prototype.__processData = function __processData() {\n      var i,\n          data = this.rawData;\n\n      for (i = 0; i < data.length; i++) {\n        data[i][1] = toDate(data[i][1]);\n        data[i][2] = toDate(data[i][2]);\n      }\n\n      return data;\n    };\n\n    Timeline.prototype.__chartName = function __chartName() {\n      return \"Timeline\";\n    };\n\n    return Timeline;\n  }(Chart);\n\n  var Chartkick = {\n    LineChart: LineChart,\n    PieChart: PieChart,\n    ColumnChart: ColumnChart,\n    BarChart: BarChart,\n    AreaChart: AreaChart,\n    GeoChart: GeoChart,\n    ScatterChart: ScatterChart,\n    BubbleChart: BubbleChart,\n    Timeline: Timeline,\n    charts: {},\n    configure: function configure(options) {\n      for (var key in options) {\n        if (options.hasOwnProperty(key)) {\n          config[key] = options[key];\n        }\n      }\n    },\n    setDefaultOptions: function setDefaultOptions(opts) {\n      Chartkick.options = opts;\n    },\n    eachChart: function eachChart(callback) {\n      for (var chartId in Chartkick.charts) {\n        if (Chartkick.charts.hasOwnProperty(chartId)) {\n          callback(Chartkick.charts[chartId]);\n        }\n      }\n    },\n    destroyAll: function destroyAll() {\n      for (var chartId in Chartkick.charts) {\n        if (Chartkick.charts.hasOwnProperty(chartId)) {\n          Chartkick.charts[chartId].destroy();\n          delete Chartkick.charts[chartId];\n        }\n      }\n    },\n    config: config,\n    options: {},\n    adapters: adapters,\n    addAdapter: addAdapter,\n    use: function use(adapter) {\n      addAdapter(adapter);\n      return Chartkick;\n    }\n  }; // not ideal, but allows for simpler integration\n\n  if (typeof window !== \"undefined\" && !window.Chartkick) {\n    window.Chartkick = Chartkick; // clean up previous charts before Turbolinks loads new page\n\n    document.addEventListener(\"turbolinks:before-render\", function () {\n      Chartkick.destroyAll();\n    }); // use setTimeout so charting library can come later in same JS file\n\n    setTimeout(function () {\n      window.dispatchEvent(new Event(\"chartkick:load\"));\n    }, 0);\n  } // backwards compatibility for esm require\n\n\n  Chartkick.default = Chartkick;\n  return Chartkick;\n});","map":{"version":3,"sources":["/Users/bryceschmisseur/Desktop/frontend-fire/node_modules/chartkick/dist/chartkick.js"],"names":["global","factory","exports","module","define","amd","globalThis","self","Chartkick","isArray","variable","Object","prototype","toString","call","isFunction","Function","isPlainObject","extend","target","source","key","undefined","merge","obj1","obj2","DATE_PATTERN","negativeValues","series","i","j","data","length","toStr","n","toFloat","parseFloat","toDate","matches","year","month","day","Date","match","parseInt","str","replace","toArr","arr","hasOwnProperty","push","jsOptionsFunc","defaultOptions","hideLegend","setTitle","setMin","setMax","setStacked","setXtitle","setYtitle","chart","opts","chartOptions","options","singleSeriesFormat","legend","title","min","max","stacked","colors","xtitle","ytitle","library","sortByTime","a","b","getTime","sortByNumberSeries","sortByNumber","isMinute","d","getMilliseconds","getSeconds","isHour","getMinutes","isDay","getHours","isWeek","dayOfWeek","getDay","isMonth","getDate","isYear","getMonth","isDate","obj","isNaN","isNumber","byteSuffixes","formatValue","pre","value","axis","prefix","suffix","precision","round","byteScale","suffixIdx","baseValue","Error","toPrecision","zeros","num","Math","pow","toFixed","thousands","decimal","parts","split","seriesOption","option","allZeros","baseOptions","maintainAspectRatio","animation","plugins","tooltip","displayColors","callbacks","font","size","color","interaction","defaultOptions$2","scales","y","ticks","maxTicksLimit","grid","x","drawOnChartArea","time","defaultColors","hideLegend$2","display","position","setTitle$2","text","setMin$2","setMax$2","setBarMin$1","setBarMax$1","setStacked$2","setXtitle$2","setYtitle$2","addOpacity","hex","opacity","result","exec","notnull","setLabelSize","maxLabelSize","ceil","element","offsetWidth","labels","callback","getLabelForValue","substring","setFormatOptions$1","chartType","formatOptions","bytes","s","scale","stepSize","label","context","dataset","formattedValue","dataPoint","raw","v","dataLabel","slice","parsed","valueLabel","jsOptions$2","createDataTable","datasets","week","hour","minute","i$1","s$1","j$1","rows","rows2","xtype","sortedLabels","Array","indexOf","sort","k","i$2","s$2","d$1","j$2","point","r","backgroundColor","j$3","name","fill","borderColor","borderWidth","pointChart","pointBackgroundColor","pointHoverBackgroundColor","pointHitRadius","pointHoverBorderWidth","stack","curve","tension","points","pointRadius","pointHoverRadius","xmin","xmax","minTime","maxTime","value$1","timeDiff","unit","step","displayFormats","unitStepSize","tooltipFormat","defaultExport$2","defaultExport","renderLineChart","type","drawChart","renderPieChart","donut","cutout","values","renderColumnChart","barOptions","indexAxis","renderAreaChart","renderBarChart","renderScatterChart","showLine","mode","renderBubbleChart","destroy","destroyed","code","window","console","log","JSON","stringify","innerHTML","ctx","getElementsByTagName","defaultOptions$1","xAxis","style","fontSize","yAxis","credits","enabled","plotOptions","areaspline","area","marker","useUTC","hideLegend$1","verticalAlign","layout","align","setTitle$1","setMin$1","setMax$1","setStacked$1","stackedValue","stacking","setXtitle$1","setYtitle$1","jsOptions$1","setFormatOptions","formatter","pointFormatter","defaultExport$1","symbol","pie","innerSize","categories","newSeries","d2","renderTo","id","Chart","loaded","chartArea","fontName","pointSize","textStyle","alignment","curveType","hAxis","titleTextStyle","gridlines","baselineColor","viewWindow","vAxis","setBarMin","setBarMax","isStacked","italic","jsOptions","resize","attachEvent","addEventListener","this$1","waitForLoaded","top","height","pieHole","visualization","DataTable","addColumn","addRows","areaOpacity","renderGeoChart","colorAxis","row","renderTimeline","lineHeight","clearChart","toJSON","draw","pack","runCallbacks","loadOptions","packages","config","__config","language","mapsApiKey","charts","load","cb","LineChart","Timeline","GeoChart","splice","columnType","concat","pendingRequests","runningRequests","maxRequests","pushRequest","url","success","error","runNext","request","shift","getJSON","requestComplete","ajaxCall","jqXHR","textStatus","errorThrown","message","$","jQuery","Zepto","ajax","dataType","complete","xhr","XMLHttpRequest","open","setRequestHeader","onload","status","parse","responseText","statusText","send","adapters","setText","document","body","innerText","textContent","chartError","noPrefix","errorCatcher","__render","err","fetchDataSource","dataSource","showLoading","loading","rawData","addDownloadButton","link","createElement","download","filename","right","zIndex","image","alt","border","src","appendChild","__downloadAttached","__enterEvent","addEvent","e","related","relatedTarget","childOf","href","toImage","__leaveEvent","parentNode","removeChild","elem","event","fn","fn2","removeEvent","removeEventListener","detachEvent","p","c","getAdapterType","product","addAdapter","adapterType","adapter","loadAdapters","Highcharts","google","dataEmpty","renderChart","empty","messages","callAdapter","fnName","adapterName","__adapterObject","toFormattedKey","keyType","formatSeriesData","detectXType","noDatetime","detectXTypeWithFunction","func","copySeries","copy","processSeries","discrete","processSimple","perfectData","elementId","getElementById","refresh","startRefresh","getElement","getDataSource","getData","getOptions","getChartObject","getAdapter","updateData","__updateOptions","setOptions","redraw","refreshData","sep","intervalId","setInterval","stopRefresh","clearInterval","background","canvas","tmpCanvas","tmpCtx","getContext","width","fillStyle","fillRect","drawImage","toDataURL","toBase64Image","updateRefresh","__processData","__chartName","apply","arguments","__proto__","create","constructor","PieChart","ColumnChart","BarChart","AreaChart","ScatterChart","BubbleChart","configure","setDefaultOptions","eachChart","chartId","destroyAll","use","setTimeout","dispatchEvent","Event","default"],"mappings":"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","sourcesContent":["/*!\n * Chartkick.js\n * Create beautiful charts with one line of JavaScript\n * https://github.com/ankane/chartkick.js\n * v4.0.0\n * MIT License\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Chartkick = factory());\n}(this, (function () { 'use strict';\n\n  function isArray(variable) {\n    return Object.prototype.toString.call(variable) === \"[object Array]\";\n  }\n\n  function isFunction(variable) {\n    return variable instanceof Function;\n  }\n\n  function isPlainObject(variable) {\n    // protect against prototype pollution, defense 2\n    return Object.prototype.toString.call(variable) === \"[object Object]\" && !isFunction(variable) && variable instanceof Object;\n  }\n\n  // https://github.com/madrobby/zepto/blob/master/src/zepto.js\n  function extend(target, source) {\n    var key;\n    for (key in source) {\n      // protect against prototype pollution, defense 1\n      if (key === \"__proto__\") { continue; }\n\n      if (isPlainObject(source[key]) || isArray(source[key])) {\n        if (isPlainObject(source[key]) && !isPlainObject(target[key])) {\n          target[key] = {};\n        }\n        if (isArray(source[key]) && !isArray(target[key])) {\n          target[key] = [];\n        }\n        extend(target[key], source[key]);\n      } else if (source[key] !== undefined) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  function merge(obj1, obj2) {\n    var target = {};\n    extend(target, obj1);\n    extend(target, obj2);\n    return target;\n  }\n\n  var DATE_PATTERN = /^(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)$/i;\n\n  function negativeValues(series) {\n    var i, j, data;\n    for (i = 0; i < series.length; i++) {\n      data = series[i].data;\n      for (j = 0; j < data.length; j++) {\n        if (data[j][1] < 0) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  function toStr(n) {\n    return \"\" + n;\n  }\n\n  function toFloat(n) {\n    return parseFloat(n);\n  }\n\n  function toDate(n) {\n    var matches, year, month, day;\n    if (typeof n !== \"object\") {\n      if (typeof n === \"number\") {\n        n = new Date(n * 1000); // ms\n      } else {\n        n = toStr(n);\n        if ((matches = n.match(DATE_PATTERN))) {\n          year = parseInt(matches[1], 10);\n          month = parseInt(matches[3], 10) - 1;\n          day = parseInt(matches[5], 10);\n          return new Date(year, month, day);\n        } else {\n          // try our best to get the str into iso8601\n          // TODO be smarter about this\n          var str = n.replace(/ /, \"T\").replace(\" \", \"\").replace(\"UTC\", \"Z\");\n          n = new Date(str) || new Date(n);\n        }\n      }\n    }\n    return n;\n  }\n\n  function toArr(n) {\n    if (!isArray(n)) {\n      var arr = [], i;\n      for (i in n) {\n        if (n.hasOwnProperty(i)) {\n          arr.push([i, n[i]]);\n        }\n      }\n      n = arr;\n    }\n    return n;\n  }\n\n  function jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle) {\n    return function (chart, opts, chartOptions) {\n      var series = chart.data;\n      var options = merge({}, defaultOptions);\n      options = merge(options, chartOptions || {});\n\n      if (chart.singleSeriesFormat || \"legend\" in opts) {\n        hideLegend(options, opts.legend, chart.singleSeriesFormat);\n      }\n\n      if (opts.title) {\n        setTitle(options, opts.title);\n      }\n\n      // min\n      if (\"min\" in opts) {\n        setMin(options, opts.min);\n      } else if (!negativeValues(series)) {\n        setMin(options, 0);\n      }\n\n      // max\n      if (opts.max) {\n        setMax(options, opts.max);\n      }\n\n      if (\"stacked\" in opts) {\n        setStacked(options, opts.stacked);\n      }\n\n      if (opts.colors) {\n        options.colors = opts.colors;\n      }\n\n      if (opts.xtitle) {\n        setXtitle(options, opts.xtitle);\n      }\n\n      if (opts.ytitle) {\n        setYtitle(options, opts.ytitle);\n      }\n\n      // merge library last\n      options = merge(options, opts.library || {});\n\n      return options;\n    };\n  }\n\n  function sortByTime(a, b) {\n    return a[0].getTime() - b[0].getTime();\n  }\n\n  function sortByNumberSeries(a, b) {\n    return a[0] - b[0];\n  }\n\n  function sortByNumber(a, b) {\n    return a - b;\n  }\n\n  function isMinute(d) {\n    return d.getMilliseconds() === 0 && d.getSeconds() === 0;\n  }\n\n  function isHour(d) {\n    return isMinute(d) && d.getMinutes() === 0;\n  }\n\n  function isDay(d) {\n    return isHour(d) && d.getHours() === 0;\n  }\n\n  function isWeek(d, dayOfWeek) {\n    return isDay(d) && d.getDay() === dayOfWeek;\n  }\n\n  function isMonth(d) {\n    return isDay(d) && d.getDate() === 1;\n  }\n\n  function isYear(d) {\n    return isMonth(d) && d.getMonth() === 0;\n  }\n\n  function isDate(obj) {\n    return !isNaN(toDate(obj)) && toStr(obj).length >= 6;\n  }\n\n  function isNumber(obj) {\n    return typeof obj === \"number\";\n  }\n\n  var byteSuffixes = [\"bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\"];\n\n  function formatValue(pre, value, options, axis) {\n    pre = pre || \"\";\n    if (options.prefix) {\n      if (value < 0) {\n        value = value * -1;\n        pre += \"-\";\n      }\n      pre += options.prefix;\n    }\n\n    var suffix = options.suffix || \"\";\n    var precision = options.precision;\n    var round = options.round;\n\n    if (options.byteScale) {\n      var suffixIdx;\n      var baseValue = axis ? options.byteScale : value;\n\n      if (baseValue >= 1152921504606846976) {\n        value /= 1152921504606846976;\n        suffixIdx = 6;\n      } else if (baseValue >= 1125899906842624) {\n        value /= 1125899906842624;\n        suffixIdx = 5;\n      } else if (baseValue >= 1099511627776) {\n        value /= 1099511627776;\n        suffixIdx = 4;\n      } else if (baseValue >= 1073741824) {\n        value /= 1073741824;\n        suffixIdx = 3;\n      } else if (baseValue >= 1048576) {\n        value /= 1048576;\n        suffixIdx = 2;\n      } else if (baseValue >= 1024) {\n        value /= 1024;\n        suffixIdx = 1;\n      } else {\n        suffixIdx = 0;\n      }\n\n      // TODO handle manual precision case\n      if (precision === undefined && round === undefined) {\n        if (value >= 1023.5) {\n          if (suffixIdx < byteSuffixes.length - 1) {\n            value = 1.0;\n            suffixIdx += 1;\n          }\n        }\n        precision = value >= 1000 ? 4 : 3;\n      }\n      suffix = \" \" + byteSuffixes[suffixIdx];\n    }\n\n    if (precision !== undefined && round !== undefined) {\n      throw Error(\"Use either round or precision, not both\");\n    }\n\n    if (!axis) {\n      if (precision !== undefined) {\n        value = value.toPrecision(precision);\n        if (!options.zeros) {\n          value = parseFloat(value);\n        }\n      }\n\n      if (round !== undefined) {\n        if (round < 0) {\n          var num = Math.pow(10, -1 * round);\n          value = parseInt((1.0 * value / num).toFixed(0)) * num;\n        } else {\n          value = value.toFixed(round);\n          if (!options.zeros) {\n            value = parseFloat(value);\n          }\n        }\n      }\n    }\n\n    if (options.thousands || options.decimal) {\n      value = toStr(value);\n      var parts = value.split(\".\");\n      value = parts[0];\n      if (options.thousands) {\n        value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, options.thousands);\n      }\n      if (parts.length > 1) {\n        value += (options.decimal || \".\") + parts[1];\n      }\n    }\n\n    return pre + value + suffix;\n  }\n\n  function seriesOption(chart, series, option) {\n    if (option in series) {\n      return series[option];\n    } else if (option in chart.options) {\n      return chart.options[option];\n    }\n    return null;\n  }\n\n  function allZeros(data) {\n    var i, j, d;\n    for (i = 0; i < data.length; i++) {\n      d = data[i].data;\n      for (j = 0; j < d.length; j++) {\n        if (d[j][1] != 0) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  var baseOptions = {\n    maintainAspectRatio: false,\n    animation: false,\n    plugins: {\n      legend: {},\n      tooltip: {\n        displayColors: false,\n        callbacks: {}\n      },\n      title: {\n        font: {\n          size: 20\n        },\n        color: \"#333\"\n      }\n    },\n    interaction: {}\n  };\n\n  var defaultOptions$2 = {\n    scales: {\n      y: {\n        ticks: {\n          maxTicksLimit: 4\n        },\n        title: {\n          font: {\n            size: 16\n          },\n          color: \"#333\"\n        },\n        grid: {}\n      },\n      x: {\n        grid: {\n          drawOnChartArea: false\n        },\n        title: {\n          font: {\n            size: 16\n          },\n          color: \"#333\"\n        },\n        time: {},\n        ticks: {}\n      }\n    }\n  };\n\n  // http://there4.io/2012/05/02/google-chart-color-list/\n  var defaultColors = [\n    \"#3366CC\", \"#DC3912\", \"#FF9900\", \"#109618\", \"#990099\", \"#3B3EAC\", \"#0099C6\",\n    \"#DD4477\", \"#66AA00\", \"#B82E2E\", \"#316395\", \"#994499\", \"#22AA99\", \"#AAAA11\",\n    \"#6633CC\", \"#E67300\", \"#8B0707\", \"#329262\", \"#5574A6\", \"#651067\"\n  ];\n\n  var hideLegend$2 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.plugins.legend.display = !!legend;\n      if (legend && legend !== true) {\n        options.plugins.legend.position = legend;\n      }\n    } else if (hideLegend) {\n      options.plugins.legend.display = false;\n    }\n  };\n\n  var setTitle$2 = function (options, title) {\n    options.plugins.title.display = true;\n    options.plugins.title.text = title;\n  };\n\n  var setMin$2 = function (options, min) {\n    if (min !== null) {\n      options.scales.y.min = toFloat(min);\n    }\n  };\n\n  var setMax$2 = function (options, max) {\n    options.scales.y.max = toFloat(max);\n  };\n\n  var setBarMin$1 = function (options, min) {\n    if (min !== null) {\n      options.scales.x.min = toFloat(min);\n    }\n  };\n\n  var setBarMax$1 = function (options, max) {\n    options.scales.x.max = toFloat(max);\n  };\n\n  var setStacked$2 = function (options, stacked) {\n    options.scales.x.stacked = !!stacked;\n    options.scales.y.stacked = !!stacked;\n  };\n\n  var setXtitle$2 = function (options, title) {\n    options.scales.x.title.display = true;\n    options.scales.x.title.text = title;\n  };\n\n  var setYtitle$2 = function (options, title) {\n    options.scales.y.title.display = true;\n    options.scales.y.title.text = title;\n  };\n\n  // https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n  var addOpacity = function (hex, opacity) {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? \"rgba(\" + parseInt(result[1], 16) + \", \" + parseInt(result[2], 16) + \", \" + parseInt(result[3], 16) + \", \" + opacity + \")\" : hex;\n  };\n\n  // check if not null or undefined\n  // https://stackoverflow.com/a/27757708/1177228\n  var notnull = function (x) {\n    return x != null;\n  };\n\n  var setLabelSize = function (chart, data, options) {\n    var maxLabelSize = Math.ceil(chart.element.offsetWidth / 4.0 / data.labels.length);\n    if (maxLabelSize > 25) {\n      maxLabelSize = 25;\n    } else if (maxLabelSize < 10) {\n      maxLabelSize = 10;\n    }\n    if (!options.scales.x.ticks.callback) {\n      options.scales.x.ticks.callback = function (value) {\n        value = toStr(this.getLabelForValue(value));\n        if (value.length > maxLabelSize) {\n          return value.substring(0, maxLabelSize - 2) + \"...\";\n        } else {\n          return value;\n        }\n      };\n    }\n  };\n\n  var setFormatOptions$1 = function (chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chart.options.bytes) {\n      var series = chart.data;\n      if (chartType === \"pie\") {\n        series = [{data: series}];\n      }\n\n      // calculate max\n      var max = 0;\n      for (var i = 0; i < series.length; i++) {\n        var s = series[i];\n        for (var j = 0; j < s.data.length; j++) {\n          if (s.data[j][1] > max) {\n            max = s.data[j][1];\n          }\n        }\n      }\n\n      // calculate scale\n      var scale = 1;\n      while (max >= 1024) {\n        scale *= 1024;\n        max /= 1024;\n      }\n\n      // set step size\n      formatOptions.byteScale = scale;\n    }\n\n    if (chartType !== \"pie\") {\n      var axis = options.scales.y;\n      if (chartType === \"bar\") {\n        axis = options.scales.x;\n      }\n\n      if (formatOptions.byteScale) {\n        if (!axis.ticks.stepSize) {\n          axis.ticks.stepSize = formatOptions.byteScale / 2;\n        }\n        if (!axis.ticks.maxTicksLimit) {\n          axis.ticks.maxTicksLimit = 4;\n        }\n      }\n\n      if (!axis.ticks.callback) {\n        axis.ticks.callback = function (value) {\n          return formatValue(\"\", value, formatOptions, true);\n        };\n      }\n    }\n\n    if (!options.plugins.tooltip.callbacks.label) {\n      if (chartType === \"scatter\") {\n        options.plugins.tooltip.callbacks.label = function (context) {\n          var label = context.dataset.label || '';\n          if (label) {\n            label += ': ';\n          }\n          return label + '(' + context.label + ', ' + context.formattedValue + ')';\n        };\n      } else if (chartType === \"bubble\") {\n        options.plugins.tooltip.callbacks.label = function (context) {\n          var label = context.dataset.label || '';\n          if (label) {\n            label += ': ';\n          }\n          var dataPoint = context.raw;\n          return label + '(' + dataPoint.x + ', ' + dataPoint.y + ', ' + dataPoint.v + ')';\n        };\n      } else if (chartType === \"pie\") {\n        // need to use separate label for pie charts\n        options.plugins.tooltip.callbacks.label = function (context) {\n          var dataLabel = context.label;\n          var value = ': ';\n\n          if (isArray(dataLabel)) {\n            // show value on first line of multiline label\n            // need to clone because we are changing the value\n            dataLabel = dataLabel.slice();\n            dataLabel[0] += value;\n          } else {\n            dataLabel += value;\n          }\n\n          return formatValue(dataLabel, context.parsed, formatOptions);\n        };\n      } else {\n        var valueLabel = chartType === \"bar\" ? \"x\" : \"y\";\n        options.plugins.tooltip.callbacks.label = function (context) {\n          var label = context.dataset.label || '';\n          if (label) {\n            label += ': ';\n          }\n          return formatValue(label, context.parsed[valueLabel], formatOptions);\n        };\n      }\n    }\n  };\n\n  var jsOptions$2 = jsOptionsFunc(merge(baseOptions, defaultOptions$2), hideLegend$2, setTitle$2, setMin$2, setMax$2, setStacked$2, setXtitle$2, setYtitle$2);\n\n  var createDataTable = function (chart, options, chartType) {\n    var datasets = [];\n    var labels = [];\n\n    var colors = chart.options.colors || defaultColors;\n\n    var day = true;\n    var week = true;\n    var dayOfWeek;\n    var month = true;\n    var year = true;\n    var hour = true;\n    var minute = true;\n\n    var series = chart.data;\n\n    var max = 0;\n    if (chartType === \"bubble\") {\n      for (var i$1 = 0; i$1 < series.length; i$1++) {\n        var s$1 = series[i$1];\n        for (var j$1 = 0; j$1 < s$1.data.length; j$1++) {\n          if (s$1.data[j$1][2] > max) {\n            max = s$1.data[j$1][2];\n          }\n        }\n      }\n    }\n\n    var i, j, s, d, key, rows = [], rows2 = [];\n\n    if (chartType === \"bar\" || chartType === \"column\" || (chart.xtype !== \"number\" && chart.xtype !== \"bubble\")) {\n      var sortedLabels = [];\n\n      for (i = 0; i < series.length; i++) {\n        s = series[i];\n\n        for (j = 0; j < s.data.length; j++) {\n          d = s.data[j];\n          key = chart.xtype == \"datetime\" ? d[0].getTime() : d[0];\n          if (!rows[key]) {\n            rows[key] = new Array(series.length);\n          }\n          rows[key][i] = toFloat(d[1]);\n          if (sortedLabels.indexOf(key) === -1) {\n            sortedLabels.push(key);\n          }\n        }\n      }\n\n      if (chart.xtype === \"datetime\" || chart.xtype === \"number\") {\n        sortedLabels.sort(sortByNumber);\n      }\n\n      for (j = 0; j < series.length; j++) {\n        rows2.push([]);\n      }\n\n      var value;\n      var k;\n      for (k = 0; k < sortedLabels.length; k++) {\n        i = sortedLabels[k];\n        if (chart.xtype === \"datetime\") {\n          value = new Date(toFloat(i));\n          // TODO make this efficient\n          day = day && isDay(value);\n          if (!dayOfWeek) {\n            dayOfWeek = value.getDay();\n          }\n          week = week && isWeek(value, dayOfWeek);\n          month = month && isMonth(value);\n          year = year && isYear(value);\n          hour = hour && isHour(value);\n          minute = minute && isMinute(value);\n        } else {\n          value = i;\n        }\n        labels.push(value);\n        for (j = 0; j < series.length; j++) {\n          // Chart.js doesn't like undefined\n          rows2[j].push(rows[i][j] === undefined ? null : rows[i][j]);\n        }\n      }\n    } else {\n      for (var i$2 = 0; i$2 < series.length; i$2++) {\n        var s$2 = series[i$2];\n        var d$1 = [];\n        for (var j$2 = 0; j$2 < s$2.data.length; j$2++) {\n          var point = {\n            x: toFloat(s$2.data[j$2][0]),\n            y: toFloat(s$2.data[j$2][1])\n          };\n          if (chartType === \"bubble\") {\n            point.r = toFloat(s$2.data[j$2][2]) * 20 / max;\n            // custom attribute, for tooltip\n            point.v = s$2.data[j$2][2];\n          }\n          d$1.push(point);\n        }\n        rows2.push(d$1);\n      }\n    }\n\n    var color;\n    var backgroundColor;\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      // use colors for each bar for single series format\n      if (chart.options.colors && chart.singleSeriesFormat && (chartType === \"bar\" || chartType === \"column\") && !s.color) {\n        color = colors;\n        backgroundColor = [];\n        for (var j$3 = 0; j$3 < colors.length; j$3++) {\n          backgroundColor[j$3] = addOpacity(color[j$3], 0.5);\n        }\n      } else {\n        color = s.color || colors[i];\n        backgroundColor = chartType !== \"line\" ? addOpacity(color, 0.5) : color;\n      }\n\n      var dataset = {\n        label: s.name || \"\",\n        data: rows2[i],\n        fill: chartType === \"area\",\n        borderColor: color,\n        backgroundColor: backgroundColor,\n        borderWidth: 2\n      };\n\n      var pointChart = chartType === \"line\" || chartType === \"area\" || chartType === \"scatter\" || chartType === \"bubble\";\n      if (pointChart) {\n        dataset.pointBackgroundColor = color;\n        dataset.pointHoverBackgroundColor = color;\n        dataset.pointHitRadius = 50;\n      }\n\n      if (chartType === \"bubble\") {\n        dataset.pointBackgroundColor = backgroundColor;\n        dataset.pointHoverBackgroundColor = backgroundColor;\n        dataset.pointHoverBorderWidth = 2;\n      }\n\n      if (s.stack) {\n        dataset.stack = s.stack;\n      }\n\n      var curve = seriesOption(chart, s, \"curve\");\n      if (curve === false) {\n        dataset.tension = 0;\n      } else if (pointChart) {\n        dataset.tension = 0.4;\n      }\n\n      var points = seriesOption(chart, s, \"points\");\n      if (points === false) {\n        dataset.pointRadius = 0;\n        dataset.pointHoverRadius = 0;\n      }\n\n      dataset = merge(dataset, chart.options.dataset || {});\n      dataset = merge(dataset, s.library || {});\n      dataset = merge(dataset, s.dataset || {});\n\n      datasets.push(dataset);\n    }\n\n    var xmin = chart.options.xmin;\n    var xmax = chart.options.xmax;\n\n    if (chart.xtype === \"datetime\") {\n      if (notnull(xmin)) {\n        options.scales.x.ticks.min = toDate(xmin).getTime();\n      }\n      if (notnull(xmax)) {\n        options.scales.x.ticks.max = toDate(xmax).getTime();\n      }\n    } else if (chart.xtype === \"number\") {\n      if (notnull(xmin)) {\n        options.scales.x.ticks.min = xmin;\n      }\n      if (notnull(xmax)) {\n        options.scales.x.ticks.max = xmax;\n      }\n    }\n\n    // for empty datetime chart\n    if (chart.xtype === \"datetime\" && labels.length === 0) {\n      if (notnull(xmin)) {\n        labels.push(toDate(xmin));\n      }\n      if (notnull(xmax)) {\n        labels.push(toDate(xmax));\n      }\n      day = false;\n      week = false;\n      month = false;\n      year = false;\n      hour = false;\n      minute = false;\n    }\n\n    if (chart.xtype === \"datetime\" && labels.length > 0) {\n      var minTime = (notnull(xmin) ? toDate(xmin) : labels[0]).getTime();\n      var maxTime = (notnull(xmax) ? toDate(xmax) : labels[0]).getTime();\n\n      for (i = 1; i < labels.length; i++) {\n        var value$1 = labels[i].getTime();\n        if (value$1 < minTime) {\n          minTime = value$1;\n        }\n        if (value$1 > maxTime) {\n          maxTime = value$1;\n        }\n      }\n\n      var timeDiff = (maxTime - minTime) / (86400 * 1000.0);\n\n      if (!options.scales.x.time.unit) {\n        var step;\n        if (year || timeDiff > 365 * 10) {\n          options.scales.x.time.unit = \"year\";\n          step = 365;\n        } else if (month || timeDiff > 30 * 10) {\n          options.scales.x.time.unit = \"month\";\n          step = 30;\n        } else if (day || timeDiff > 10) {\n          options.scales.x.time.unit = \"day\";\n          step = 1;\n        } else if (hour || timeDiff > 0.5) {\n          options.scales.x.time.displayFormats = {hour: \"MMM d, h a\"};\n          options.scales.x.time.unit = \"hour\";\n          step = 1 / 24.0;\n        } else if (minute) {\n          options.scales.x.time.displayFormats = {minute: \"h:mm a\"};\n          options.scales.x.time.unit = \"minute\";\n          step = 1 / 24.0 / 60.0;\n        }\n\n        if (step && timeDiff > 0) {\n          var unitStepSize = Math.ceil(timeDiff / step / (chart.element.offsetWidth / 100.0));\n          if (week && step === 1) {\n            unitStepSize = Math.ceil(unitStepSize / 7.0) * 7;\n          }\n          options.scales.x.time.stepSize = unitStepSize;\n        }\n      }\n\n      if (!options.scales.x.time.tooltipFormat) {\n        if (day) {\n          options.scales.x.time.tooltipFormat = \"PP\";\n        } else if (hour) {\n          options.scales.x.time.tooltipFormat = \"MMM d, h a\";\n        } else if (minute) {\n          options.scales.x.time.tooltipFormat = \"h:mm a\";\n        }\n      }\n    }\n\n    var data = {\n      labels: labels,\n      datasets: datasets\n    };\n\n    return data;\n  };\n\n  var defaultExport$2 = function defaultExport(library) {\n    this.name = \"chartjs\";\n    this.library = library;\n  };\n\n  defaultExport$2.prototype.renderLineChart = function renderLineChart (chart, chartType) {\n    var chartOptions = {};\n    // fix for https://github.com/chartjs/Chart.js/issues/2441\n    if (!chart.options.max && allZeros(chart.data)) {\n      chartOptions.max = 1;\n    }\n\n    var options = jsOptions$2(chart, merge(chartOptions, chart.options));\n    setFormatOptions$1(chart, options, chartType);\n\n    var data = createDataTable(chart, options, chartType || \"line\");\n\n    if (chart.xtype === \"number\") {\n      options.scales.x.type = \"linear\";\n      options.scales.x.position = \"bottom\";\n    } else {\n      options.scales.x.type = chart.xtype === \"string\" ? \"category\" : \"time\";\n    }\n\n    this.drawChart(chart, \"line\", data, options);\n  };\n\n  defaultExport$2.prototype.renderPieChart = function renderPieChart (chart) {\n    var options = merge({}, baseOptions);\n    if (chart.options.donut) {\n      options.cutout = \"50%\";\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend$2(options, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle$2(options, chart.options.title);\n    }\n\n    options = merge(options, chart.options.library || {});\n    setFormatOptions$1(chart, options, \"pie\");\n\n    var labels = [];\n    var values = [];\n    for (var i = 0; i < chart.data.length; i++) {\n      var point = chart.data[i];\n      labels.push(point[0]);\n      values.push(point[1]);\n    }\n\n    var dataset = {\n      data: values,\n      backgroundColor: chart.options.colors || defaultColors\n    };\n    dataset = merge(dataset, chart.options.dataset || {});\n\n    var data = {\n      labels: labels,\n      datasets: [dataset]\n    };\n\n    this.drawChart(chart, \"pie\", data, options);\n  };\n\n  defaultExport$2.prototype.renderColumnChart = function renderColumnChart (chart, chartType) {\n    var options;\n    if (chartType === \"bar\") {\n      var barOptions = merge(baseOptions, defaultOptions$2);\n      barOptions.indexAxis = \"y\";\n\n      // ensure gridlines have proper orientation\n      barOptions.scales.x.grid.drawOnChartArea = true;\n      barOptions.scales.y.grid.drawOnChartArea = false;\n      delete barOptions.scales.y.ticks.maxTicksLimit;\n\n      options = jsOptionsFunc(barOptions, hideLegend$2, setTitle$2, setBarMin$1, setBarMax$1, setStacked$2, setXtitle$2, setYtitle$2)(chart, chart.options);\n    } else {\n      options = jsOptions$2(chart, chart.options);\n    }\n    setFormatOptions$1(chart, options, chartType);\n    var data = createDataTable(chart, options, \"column\");\n    if (chartType !== \"bar\") {\n      setLabelSize(chart, data, options);\n    }\n    this.drawChart(chart, \"bar\", data, options);\n  };\n\n  defaultExport$2.prototype.renderAreaChart = function renderAreaChart (chart) {\n    this.renderLineChart(chart, \"area\");\n  };\n\n  defaultExport$2.prototype.renderBarChart = function renderBarChart (chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport$2.prototype.renderScatterChart = function renderScatterChart (chart, chartType) {\n    chartType = chartType || \"scatter\";\n\n    var options = jsOptions$2(chart, chart.options);\n    setFormatOptions$1(chart, options, chartType);\n\n    if (!(\"showLine\" in options)) {\n      options.showLine = false;\n    }\n\n    var data = createDataTable(chart, options, chartType);\n\n    options.scales.x.type = \"linear\";\n    options.scales.x.position = \"bottom\";\n\n    // prevent grouping hover and tooltips\n    if (!(\"mode\" in options.interaction)) {\n      options.interaction.mode = \"nearest\";\n    }\n\n    this.drawChart(chart, chartType, data, options);\n  };\n\n  defaultExport$2.prototype.renderBubbleChart = function renderBubbleChart (chart) {\n    this.renderScatterChart(chart, \"bubble\");\n  };\n\n  defaultExport$2.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport$2.prototype.drawChart = function drawChart (chart, type, data, options) {\n    this.destroy(chart);\n    if (chart.destroyed) { return; }\n\n    var chartOptions = {\n      type: type,\n      data: data,\n      options: options\n    };\n\n    if (chart.options.code) {\n      window.console.log(\"new Chart(ctx, \" + JSON.stringify(chartOptions) + \");\");\n    }\n\n    chart.element.innerHTML = \"<canvas></canvas>\";\n    var ctx = chart.element.getElementsByTagName(\"CANVAS\")[0];\n    chart.chart = new this.library(ctx, chartOptions);\n  };\n\n  var defaultOptions$1 = {\n    chart: {},\n    xAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    yAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    title: {\n      text: null\n    },\n    credits: {\n      enabled: false\n    },\n    legend: {\n      borderWidth: 0\n    },\n    tooltip: {\n      style: {\n        fontSize: \"12px\"\n      }\n    },\n    plotOptions: {\n      areaspline: {},\n      area: {},\n      series: {\n        marker: {}\n      }\n    },\n    time: {\n      useUTC: false\n    }\n  };\n\n  var hideLegend$1 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.enabled = !!legend;\n      if (legend && legend !== true) {\n        if (legend === \"top\" || legend === \"bottom\") {\n          options.legend.verticalAlign = legend;\n        } else {\n          options.legend.layout = \"vertical\";\n          options.legend.verticalAlign = \"middle\";\n          options.legend.align = legend;\n        }\n      }\n    } else if (hideLegend) {\n      options.legend.enabled = false;\n    }\n  };\n\n  var setTitle$1 = function (options, title) {\n    options.title.text = title;\n  };\n\n  var setMin$1 = function (options, min) {\n    options.yAxis.min = min;\n  };\n\n  var setMax$1 = function (options, max) {\n    options.yAxis.max = max;\n  };\n\n  var setStacked$1 = function (options, stacked) {\n    var stackedValue = stacked ? (stacked === true ? \"normal\" : stacked) : null;\n    options.plotOptions.series.stacking = stackedValue;\n    options.plotOptions.area.stacking = stackedValue;\n    options.plotOptions.areaspline.stacking = stackedValue;\n  };\n\n  var setXtitle$1 = function (options, title) {\n    options.xAxis.title.text = title;\n  };\n\n  var setYtitle$1 = function (options, title) {\n    options.yAxis.title.text = title;\n  };\n\n  var jsOptions$1 = jsOptionsFunc(defaultOptions$1, hideLegend$1, setTitle$1, setMin$1, setMax$1, setStacked$1, setXtitle$1, setYtitle$1);\n\n  var setFormatOptions = function(chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chartType !== \"pie\" && !options.yAxis.labels.formatter) {\n      options.yAxis.labels.formatter = function () {\n        return formatValue(\"\", this.value, formatOptions);\n      };\n    }\n\n    if (!options.tooltip.pointFormatter) {\n      options.tooltip.pointFormatter = function () {\n        return '<span style=\"color:' + this.color + '\">\\u25CF</span> ' + formatValue(this.series.name + ': <b>', this.y, formatOptions) + '</b><br/>';\n      };\n    }\n  };\n\n  var defaultExport$1 = function defaultExport(library) {\n    this.name = \"highcharts\";\n    this.library = library;\n  };\n\n  defaultExport$1.prototype.renderLineChart = function renderLineChart (chart, chartType) {\n    chartType = chartType || \"spline\";\n    var chartOptions = {};\n    if (chartType === \"areaspline\") {\n      chartOptions = {\n        plotOptions: {\n          areaspline: {\n            stacking: \"normal\"\n          },\n          area: {\n            stacking: \"normal\"\n          },\n          series: {\n            marker: {\n              enabled: false\n            }\n          }\n        }\n      };\n    }\n\n    if (chart.options.curve === false) {\n      if (chartType === \"areaspline\") {\n        chartType = \"area\";\n      } else if (chartType === \"spline\") {\n        chartType = \"line\";\n      }\n    }\n\n    var options = jsOptions$1(chart, chart.options, chartOptions), data, i, j;\n    options.xAxis.type = chart.xtype === \"string\" ? \"category\" : (chart.xtype === \"number\" ? \"linear\" : \"datetime\");\n    if (!options.chart.type) {\n      options.chart.type = chartType;\n    }\n    setFormatOptions(chart, options, chartType);\n\n    var series = chart.data;\n    for (i = 0; i < series.length; i++) {\n      series[i].name = series[i].name || \"Value\";\n      data = series[i].data;\n      if (chart.xtype === \"datetime\") {\n        for (j = 0; j < data.length; j++) {\n          data[j][0] = data[j][0].getTime();\n        }\n      }\n      series[i].marker = {symbol: \"circle\"};\n      if (chart.options.points === false) {\n        series[i].marker.enabled = false;\n      }\n    }\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderScatterChart = function renderScatterChart (chart) {\n    var options = jsOptions$1(chart, chart.options, {});\n    options.chart.type = \"scatter\";\n    this.drawChart(chart, chart.data, options);\n  };\n\n  defaultExport$1.prototype.renderPieChart = function renderPieChart (chart) {\n    var chartOptions = merge(defaultOptions$1, {});\n\n    if (chart.options.colors) {\n      chartOptions.colors = chart.options.colors;\n    }\n    if (chart.options.donut) {\n      chartOptions.plotOptions = {pie: {innerSize: \"50%\"}};\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend$1(chartOptions, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle$1(chartOptions, chart.options.title);\n    }\n\n    var options = merge(chartOptions, chart.options.library || {});\n    setFormatOptions(chart, options, \"pie\");\n    var series = [{\n      type: \"pie\",\n      name: chart.options.label || \"Value\",\n      data: chart.data\n    }];\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderColumnChart = function renderColumnChart (chart, chartType) {\n    chartType = chartType || \"column\";\n    var series = chart.data;\n    var options = jsOptions$1(chart, chart.options), i, j, s, d, rows = [], categories = [];\n    options.chart.type = chartType;\n    setFormatOptions(chart, options, chartType);\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        if (!rows[d[0]]) {\n          rows[d[0]] = new Array(series.length);\n          categories.push(d[0]);\n        }\n        rows[d[0]][i] = d[1];\n      }\n    }\n\n    if (chart.xtype === \"number\") {\n      categories.sort(sortByNumber);\n    }\n\n    options.xAxis.categories = categories;\n\n    var newSeries = [], d2;\n    for (i = 0; i < series.length; i++) {\n      d = [];\n      for (j = 0; j < categories.length; j++) {\n        d.push(rows[categories[j]][i] || 0);\n      }\n\n      d2 = {\n        name: series[i].name || \"Value\",\n        data: d\n      };\n      if (series[i].stack) {\n        d2.stack = series[i].stack;\n      }\n\n      newSeries.push(d2);\n    }\n\n    this.drawChart(chart, newSeries, options);\n  };\n\n  defaultExport$1.prototype.renderBarChart = function renderBarChart (chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport$1.prototype.renderAreaChart = function renderAreaChart (chart) {\n    this.renderLineChart(chart, \"areaspline\");\n  };\n\n  defaultExport$1.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport$1.prototype.drawChart = function drawChart (chart, data, options) {\n    this.destroy(chart);\n    if (chart.destroyed) { return; }\n\n    options.chart.renderTo = chart.element.id;\n    options.series = data;\n\n    if (chart.options.code) {\n      window.console.log(\"new Highcharts.Chart(\" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.Chart(options);\n  };\n\n  var loaded = {};\n  var callbacks = [];\n\n  // Set chart options\n  var defaultOptions = {\n    chartArea: {},\n    fontName: \"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif\",\n    pointSize: 6,\n    legend: {\n      textStyle: {\n        fontSize: 12,\n        color: \"#444\"\n      },\n      alignment: \"center\",\n      position: \"right\"\n    },\n    curveType: \"function\",\n    hAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      gridlines: {\n        color: \"transparent\"\n      },\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    vAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    tooltip: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      }\n    }\n  };\n\n  var hideLegend = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      var position;\n      if (!legend) {\n        position = \"none\";\n      } else if (legend === true) {\n        position = \"right\";\n      } else {\n        position = legend;\n      }\n      options.legend.position = position;\n    } else if (hideLegend) {\n      options.legend.position = \"none\";\n    }\n  };\n\n  var setTitle = function (options, title) {\n    options.title = title;\n    options.titleTextStyle = {color: \"#333\", fontSize: \"20px\"};\n  };\n\n  var setMin = function (options, min) {\n    options.vAxis.viewWindow.min = min;\n  };\n\n  var setMax = function (options, max) {\n    options.vAxis.viewWindow.max = max;\n  };\n\n  var setBarMin = function (options, min) {\n    options.hAxis.viewWindow.min = min;\n  };\n\n  var setBarMax = function (options, max) {\n    options.hAxis.viewWindow.max = max;\n  };\n\n  var setStacked = function (options, stacked) {\n    options.isStacked = stacked ? stacked : false;\n  };\n\n  var setXtitle = function (options, title) {\n    options.hAxis.title = title;\n    options.hAxis.titleTextStyle.italic = false;\n  };\n\n  var setYtitle = function (options, title) {\n    options.vAxis.title = title;\n    options.vAxis.titleTextStyle.italic = false;\n  };\n\n  var jsOptions = jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\n  var resize = function (callback) {\n    if (window.attachEvent) {\n      window.attachEvent(\"onresize\", callback);\n    } else if (window.addEventListener) {\n      window.addEventListener(\"resize\", callback, true);\n    }\n    callback();\n  };\n\n  var defaultExport = function defaultExport(library) {\n    this.name = \"google\";\n    this.library = library;\n  };\n\n  defaultExport.prototype.renderLineChart = function renderLineChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n\n      if (chart.options.curve === false) {\n        chartOptions.curveType = \"none\";\n      }\n\n      if (chart.options.points === false) {\n        chartOptions.pointSize = 0;\n      }\n\n      var options = jsOptions(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"LineChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderPieChart = function renderPieChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        chartArea: {\n          top: \"10%\",\n          height: \"80%\"\n        },\n        legend: {}\n      };\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n      if (chart.options.donut) {\n        chartOptions.pieHole = 0.5;\n      }\n      if (\"legend\" in chart.options) {\n        hideLegend(chartOptions, chart.options.legend);\n      }\n      if (chart.options.title) {\n        setTitle(chartOptions, chart.options.title);\n      }\n      var options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", \"Value\");\n      data.addRows(chart.data);\n\n      this$1.drawChart(chart, \"PieChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderColumnChart = function renderColumnChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var options = jsOptions(chart, chart.options);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"ColumnChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderBarChart = function renderBarChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        hAxis: {\n          gridlines: {\n            color: \"#ccc\"\n          }\n        }\n      };\n      var options = jsOptionsFunc(defaultOptions, hideLegend, setTitle, setBarMin, setBarMax, setStacked, setXtitle, setYtitle)(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"BarChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderAreaChart = function renderAreaChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        isStacked: true,\n        pointSize: 0,\n        areaOpacity: 0.5\n      };\n\n      var options = jsOptions(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"AreaChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderGeoChart = function renderGeoChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, \"geochart\", function () {\n      var chartOptions = {\n        legend: \"none\",\n        colorAxis: {\n          colors: chart.options.colors || [\"#f6c7b6\", \"#ce502d\"]\n        }\n      };\n      var options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", chart.options.label || \"Value\");\n      data.addRows(chart.data);\n\n      this$1.drawChart(chart, \"GeoChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderScatterChart = function renderScatterChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n      var options = jsOptions(chart, chart.options, chartOptions);\n\n      var series = chart.data, rows2 = [], i, j, data, d;\n      for (i = 0; i < series.length; i++) {\n        series[i].name = series[i].name || \"Value\";\n        d = series[i].data;\n        for (j = 0; j < d.length; j++) {\n          var row = new Array(series.length + 1);\n          row[0] = d[j][0];\n          row[i + 1] = d[j][1];\n          rows2.push(row);\n        }\n      }\n\n      data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"number\", \"\");\n      for (i = 0; i < series.length; i++) {\n        data.addColumn(\"number\", series[i].name);\n      }\n      data.addRows(rows2);\n\n      this$1.drawChart(chart, \"ScatterChart\", data, options);\n    });\n  };\n\n  defaultExport.prototype.renderTimeline = function renderTimeline (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, \"timeline\", function () {\n      var chartOptions = {\n        legend: \"none\"\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n      var options = merge(merge(defaultOptions, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn({type: \"string\", id: \"Name\"});\n      data.addColumn({type: \"date\", id: \"Start\"});\n      data.addColumn({type: \"date\", id: \"End\"});\n      data.addRows(chart.data);\n\n      chart.element.style.lineHeight = \"normal\";\n\n      this$1.drawChart(chart, \"Timeline\", data, options);\n    });\n  };\n\n  // TODO remove resize events\n  defaultExport.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.clearChart();\n    }\n  };\n\n  defaultExport.prototype.drawChart = function drawChart (chart, type, data, options) {\n    this.destroy(chart);\n    if (chart.destroyed) { return; }\n\n    if (chart.options.code) {\n      window.console.log(\"var data = new google.visualization.DataTable(\" + data.toJSON() + \");\\nvar chart = new google.visualization.\" + type + \"(element);\\nchart.draw(data, \" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.visualization[type](chart.element);\n    resize(function () {\n      chart.chart.draw(data, options);\n    });\n  };\n\n  defaultExport.prototype.waitForLoaded = function waitForLoaded (chart, pack, callback) {\n      var this$1 = this;\n\n    if (!callback) {\n      callback = pack;\n      pack = \"corechart\";\n    }\n\n    callbacks.push({pack: pack, callback: callback});\n\n    if (loaded[pack]) {\n      this.runCallbacks();\n    } else {\n      loaded[pack] = true;\n\n      // https://groups.google.com/forum/#!topic/google-visualization-api/fMKJcyA2yyI\n      var loadOptions = {\n        packages: [pack],\n        callback: function () { this$1.runCallbacks(); }\n      };\n      var config = chart.__config();\n      if (config.language) {\n        loadOptions.language = config.language;\n      }\n      if (pack === \"geochart\" && config.mapsApiKey) {\n        loadOptions.mapsApiKey = config.mapsApiKey;\n      }\n\n      this.library.charts.load(\"current\", loadOptions);\n    }\n  };\n\n  defaultExport.prototype.runCallbacks = function runCallbacks () {\n    var cb, call;\n    for (var i = 0; i < callbacks.length; i++) {\n      cb = callbacks[i];\n      call = this.library.visualization && ((cb.pack === \"corechart\" && this.library.visualization.LineChart) || (cb.pack === \"timeline\" && this.library.visualization.Timeline) || (cb.pack === \"geochart\" && this.library.visualization.GeoChart));\n      if (call) {\n        cb.callback();\n        callbacks.splice(i, 1);\n        i--;\n      }\n    }\n  };\n\n  // cant use object as key\n  defaultExport.prototype.createDataTable = function createDataTable (series, columnType) {\n    var i, j, s, d, key, rows = [], sortedLabels = [];\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n      series[i].name = series[i].name || \"Value\";\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        key = (columnType === \"datetime\") ? d[0].getTime() : d[0];\n        if (!rows[key]) {\n          rows[key] = new Array(series.length);\n          sortedLabels.push(key);\n        }\n        rows[key][i] = toFloat(d[1]);\n      }\n    }\n\n    var rows2 = [];\n    var day = true;\n    var value;\n    for (j = 0; j < sortedLabels.length; j++) {\n      i = sortedLabels[j];\n      if (columnType === \"datetime\") {\n        value = new Date(toFloat(i));\n        day = day && isDay(value);\n      } else if (columnType === \"number\") {\n        value = toFloat(i);\n      } else {\n        value = i;\n      }\n      rows2.push([value].concat(rows[i]));\n    }\n    if (columnType === \"datetime\") {\n      rows2.sort(sortByTime);\n    } else if (columnType === \"number\") {\n      rows2.sort(sortByNumberSeries);\n\n      for (i = 0; i < rows2.length; i++) {\n        rows2[i][0] = toStr(rows2[i][0]);\n      }\n\n      columnType = \"string\";\n    }\n\n    // create datatable\n    var data = new this.library.visualization.DataTable();\n    columnType = columnType === \"datetime\" && day ? \"date\" : columnType;\n    data.addColumn(columnType, \"\");\n    for (i = 0; i < series.length; i++) {\n      data.addColumn(\"number\", series[i].name);\n    }\n    data.addRows(rows2);\n\n    return data;\n  };\n\n  var pendingRequests = [], runningRequests = 0, maxRequests = 4;\n\n  function pushRequest(url, success, error) {\n    pendingRequests.push([url, success, error]);\n    runNext();\n  }\n\n  function runNext() {\n    if (runningRequests < maxRequests) {\n      var request = pendingRequests.shift();\n      if (request) {\n        runningRequests++;\n        getJSON(request[0], request[1], request[2]);\n        runNext();\n      }\n    }\n  }\n\n  function requestComplete() {\n    runningRequests--;\n    runNext();\n  }\n\n  function getJSON(url, success, error) {\n    ajaxCall(url, success, function (jqXHR, textStatus, errorThrown) {\n      var message = (typeof errorThrown === \"string\") ? errorThrown : errorThrown.message;\n      error(message);\n    });\n  }\n\n  function ajaxCall(url, success, error) {\n    var $ = window.jQuery || window.Zepto || window.$;\n\n    if ($ && $.ajax) {\n      $.ajax({\n        dataType: \"json\",\n        url: url,\n        success: success,\n        error: error,\n        complete: requestComplete\n      });\n    } else {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", url, true);\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.onload = function () {\n        requestComplete();\n        if (xhr.status === 200) {\n          success(JSON.parse(xhr.responseText), xhr.statusText, xhr);\n        } else {\n          error(xhr, \"error\", xhr.statusText);\n        }\n      };\n      xhr.send();\n    }\n  }\n\n  var config = {};\n  var adapters = [];\n\n  // helpers\n\n  function setText(element, text) {\n    if (document.body.innerText) {\n      element.innerText = text;\n    } else {\n      element.textContent = text;\n    }\n  }\n\n  // TODO remove prefix for all messages\n  function chartError(element, message, noPrefix) {\n    if (!noPrefix) {\n      message = \"Error Loading Chart: \" + message;\n    }\n    setText(element, message);\n    element.style.color = \"#ff0000\";\n  }\n\n  function errorCatcher(chart) {\n    try {\n      chart.__render();\n    } catch (err) {\n      chartError(chart.element, err.message);\n      throw err;\n    }\n  }\n\n  function fetchDataSource(chart, dataSource, showLoading) {\n    // only show loading message for urls and callbacks\n    if (showLoading && chart.options.loading && (typeof dataSource === \"string\" || typeof dataSource === \"function\")) {\n      setText(chart.element, chart.options.loading);\n    }\n\n    if (typeof dataSource === \"string\") {\n      pushRequest(dataSource, function (data) {\n        chart.rawData = data;\n        errorCatcher(chart);\n      }, function (message) {\n        chartError(chart.element, message);\n      });\n    } else if (typeof dataSource === \"function\") {\n      try {\n        dataSource(function (data) {\n          chart.rawData = data;\n          errorCatcher(chart);\n        }, function (message) {\n          chartError(chart.element, message, true);\n        });\n      } catch (err) {\n        chartError(chart.element, err, true);\n      }\n    } else {\n      chart.rawData = dataSource;\n      errorCatcher(chart);\n    }\n  }\n\n  function addDownloadButton(chart) {\n    var element = chart.element;\n    var link = document.createElement(\"a\");\n\n    var download = chart.options.download;\n    if (download === true) {\n      download = {};\n    } else if (typeof download === \"string\") {\n      download = {filename: download};\n    }\n    link.download = download.filename || \"chart.png\"; // https://caniuse.com/download\n\n    link.style.position = \"absolute\";\n    link.style.top = \"20px\";\n    link.style.right = \"20px\";\n    link.style.zIndex = 1000;\n    link.style.lineHeight = \"20px\";\n    link.target = \"_blank\"; // for safari\n    var image = document.createElement(\"img\");\n    image.alt = \"Download\";\n    image.style.border = \"none\";\n    // icon from font-awesome\n    // http://fa2png.io/\n    image.src = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABCFBMVEUAAADMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMywEsqxAAAAV3RSTlMAAQIDBggJCgsMDQ4PERQaHB0eISIjJCouLzE0OTo/QUJHSUpLTU5PUllhYmltcHh5foWLjI+SlaCio6atr7S1t7m6vsHHyM7R2tze5Obo7fHz9ff5+/1hlxK2AAAA30lEQVQYGUXBhVYCQQBA0TdYWAt2d3d3YWAHyur7/z9xgD16Lw0DW+XKx+1GgX+FRzM3HWQWrHl5N/oapW5RPe0PkBu+UYeICvozTWZVK23Ao04B79oJrOsJDOoxkZoQPWgX29pHpCZEk7rEvQYiNSFq1UMqvlCjJkRBS1R8hb00Vb/TajtBL7nTHE1X1vyMQF732dQhyF2o6SAwrzP06iUQzvwsArlnzcOdrgBhJyHa1QOgO9U1GsKuvjUTjavliZYQ8nNPapG6sap/3nrIdJ6bOWzmX/fy0XVpfzZP3S8OJT3g9EEiJwAAAABJRU5ErkJggg==\";\n    link.appendChild(image);\n    element.style.position = \"relative\";\n\n    chart.__downloadAttached = true;\n\n    // mouseenter\n    chart.__enterEvent = addEvent(element, \"mouseover\", function(e) {\n      var related = e.relatedTarget;\n      // check download option again to ensure it wasn't changed\n      if ((!related || (related !== this && !childOf(this, related))) && chart.options.download) {\n        link.href = chart.toImage(download);\n        element.appendChild(link);\n      }\n    });\n\n    // mouseleave\n    chart.__leaveEvent = addEvent(element, \"mouseout\", function(e) {\n      var related = e.relatedTarget;\n      if (!related || (related !== this && !childOf(this, related))) {\n        if (link.parentNode) {\n          link.parentNode.removeChild(link);\n        }\n      }\n    });\n  }\n\n  // https://stackoverflow.com/questions/10149963/adding-event-listener-cross-browser\n  function addEvent(elem, event, fn) {\n    if (elem.addEventListener) {\n      elem.addEventListener(event, fn, false);\n      return fn;\n    } else {\n      var fn2 = function() {\n        // set the this pointer same as addEventListener when fn is called\n        return(fn.call(elem, window.event));\n      };\n      elem.attachEvent(\"on\" + event, fn2);\n      return fn2;\n    }\n  }\n\n  function removeEvent(elem, event, fn) {\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, fn, false);\n    } else {\n      elem.detachEvent(\"on\" + event, fn);\n    }\n  }\n\n  // https://gist.github.com/shawnbot/4166283\n  function childOf(p, c) {\n    if (p === c) { return false; }\n    while (c && c !== p) { c = c.parentNode; }\n    return c === p;\n  }\n\n  function getAdapterType(library) {\n    if (library) {\n      if (library.product === \"Highcharts\") {\n        return defaultExport$1;\n      } else if (library.charts) {\n        return defaultExport;\n      } else if (isFunction(library)) {\n        return defaultExport$2;\n      }\n    }\n    throw new Error(\"Unknown adapter\");\n  }\n\n  function addAdapter(library) {\n    var adapterType = getAdapterType(library);\n    var adapter = new adapterType(library);\n\n    if (adapters.indexOf(adapter) === -1) {\n      adapters.push(adapter);\n    }\n  }\n\n  function loadAdapters() {\n    if (\"Chart\" in window) {\n      addAdapter(window.Chart);\n    }\n\n    if (\"Highcharts\" in window) {\n      addAdapter(window.Highcharts);\n    }\n\n    if (window.google && window.google.charts) {\n      addAdapter(window.google);\n    }\n  }\n\n  function dataEmpty(data, chartType) {\n    if (chartType === \"PieChart\" || chartType === \"GeoChart\" || chartType === \"Timeline\") {\n      return data.length === 0;\n    } else {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].data.length > 0) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n  function renderChart(chartType, chart) {\n    if (dataEmpty(chart.data, chartType)) {\n      var message = chart.options.empty || (chart.options.messages && chart.options.messages.empty) || \"No data\";\n      setText(chart.element, message);\n    } else {\n      callAdapter(chartType, chart);\n      if (chart.options.download && !chart.__downloadAttached && chart.adapter === \"chartjs\") {\n        addDownloadButton(chart);\n      }\n    }\n  }\n\n  // TODO remove chartType if cross-browser way\n  // to get the name of the chart class\n  function callAdapter(chartType, chart) {\n    var i, adapter, fnName, adapterName;\n    fnName = \"render\" + chartType;\n    adapterName = chart.options.adapter;\n\n    loadAdapters();\n\n    for (i = 0; i < adapters.length; i++) {\n      adapter = adapters[i];\n      if ((!adapterName || adapterName === adapter.name) && isFunction(adapter[fnName])) {\n        chart.adapter = adapter.name;\n        chart.__adapterObject = adapter;\n        return adapter[fnName](chart);\n      }\n    }\n\n    if (adapters.length > 0) {\n      throw new Error(\"No charting library found for \" + chartType);\n    } else {\n      throw new Error(\"No charting libraries found - be sure to include one before your charts\");\n    }\n  }\n\n  // process data\n\n  var toFormattedKey = function (key, keyType) {\n    if (keyType === \"number\") {\n      key = toFloat(key);\n    } else if (keyType === \"datetime\") {\n      key = toDate(key);\n    } else {\n      key = toStr(key);\n    }\n    return key;\n  };\n\n  var formatSeriesData = function (data, keyType) {\n    var r = [], key, j;\n    for (j = 0; j < data.length; j++) {\n      if (keyType === \"bubble\") {\n        r.push([toFloat(data[j][0]), toFloat(data[j][1]), toFloat(data[j][2])]);\n      } else {\n        key = toFormattedKey(data[j][0], keyType);\n        r.push([key, toFloat(data[j][1])]);\n      }\n    }\n    if (keyType === \"datetime\") {\n      r.sort(sortByTime);\n    } else if (keyType === \"number\") {\n      r.sort(sortByNumberSeries);\n    }\n    return r;\n  };\n\n  function detectXType(series, noDatetime, options) {\n    if (dataEmpty(series)) {\n      if ((options.xmin || options.xmax) && (!options.xmin || isDate(options.xmin)) && (!options.xmax || isDate(options.xmax))) {\n        return \"datetime\";\n      } else {\n        return \"number\";\n      }\n    } else if (detectXTypeWithFunction(series, isNumber)) {\n      return \"number\";\n    } else if (!noDatetime && detectXTypeWithFunction(series, isDate)) {\n      return \"datetime\";\n    } else {\n      return \"string\";\n    }\n  }\n\n  function detectXTypeWithFunction(series, func) {\n    var i, j, data;\n    for (i = 0; i < series.length; i++) {\n      data = toArr(series[i].data);\n      for (j = 0; j < data.length; j++) {\n        if (!func(data[j][0])) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  // creates a shallow copy of each element of the array\n  // elements are expected to be objects\n  function copySeries(series) {\n    var newSeries = [], i, j;\n    for (i = 0; i < series.length; i++) {\n      var copy = {};\n      for (j in series[i]) {\n        if (series[i].hasOwnProperty(j)) {\n          copy[j] = series[i][j];\n        }\n      }\n      newSeries.push(copy);\n    }\n    return newSeries;\n  }\n\n  function processSeries(chart, keyType, noDatetime) {\n    var i;\n\n    var opts = chart.options;\n    var series = chart.rawData;\n\n    // see if one series or multiple\n    if (!isArray(series) || typeof series[0] !== \"object\" || isArray(series[0])) {\n      series = [{name: opts.label, data: series}];\n      chart.singleSeriesFormat = true;\n    } else {\n      chart.singleSeriesFormat = false;\n    }\n\n    // convert to array\n    // must come before dataEmpty check\n    series = copySeries(series);\n    for (i = 0; i < series.length; i++) {\n      series[i].data = toArr(series[i].data);\n    }\n\n    chart.xtype = keyType ? keyType : (opts.discrete ? \"string\" : detectXType(series, noDatetime, opts));\n\n    // right format\n    for (i = 0; i < series.length; i++) {\n      series[i].data = formatSeriesData(series[i].data, chart.xtype);\n    }\n\n    return series;\n  }\n\n  function processSimple(chart) {\n    var perfectData = toArr(chart.rawData), i;\n    for (i = 0; i < perfectData.length; i++) {\n      perfectData[i] = [toStr(perfectData[i][0]), toFloat(perfectData[i][1])];\n    }\n    return perfectData;\n  }\n\n  // define classes\n\n  var Chart = function Chart(element, dataSource, options) {\n    var elementId;\n    if (typeof element === \"string\") {\n      elementId = element;\n      element = document.getElementById(element);\n      if (!element) {\n        throw new Error(\"No element with id \" + elementId);\n      }\n    }\n    this.element = element;\n    this.options = merge(Chartkick.options, options || {});\n    this.dataSource = dataSource;\n\n    Chartkick.charts[element.id] = this;\n\n    fetchDataSource(this, dataSource, true);\n\n    if (this.options.refresh) {\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.getElement = function getElement () {\n    return this.element;\n  };\n\n  Chart.prototype.getDataSource = function getDataSource () {\n    return this.dataSource;\n  };\n\n  Chart.prototype.getData = function getData () {\n    return this.data;\n  };\n\n  Chart.prototype.getOptions = function getOptions () {\n    return this.options;\n  };\n\n  Chart.prototype.getChartObject = function getChartObject () {\n    return this.chart;\n  };\n\n  Chart.prototype.getAdapter = function getAdapter () {\n    return this.adapter;\n  };\n\n  Chart.prototype.updateData = function updateData (dataSource, options) {\n    this.dataSource = dataSource;\n    if (options) {\n      this.__updateOptions(options);\n    }\n    fetchDataSource(this, dataSource, true);\n  };\n\n  Chart.prototype.setOptions = function setOptions (options) {\n    this.__updateOptions(options);\n    this.redraw();\n  };\n\n  Chart.prototype.redraw = function redraw () {\n    fetchDataSource(this, this.rawData);\n  };\n\n  Chart.prototype.refreshData = function refreshData () {\n    if (typeof this.dataSource === \"string\") {\n      // prevent browser from caching\n      var sep = this.dataSource.indexOf(\"?\") === -1 ? \"?\" : \"&\";\n      var url = this.dataSource + sep + \"_=\" + (new Date()).getTime();\n      fetchDataSource(this, url);\n    } else if (typeof this.dataSource === \"function\") {\n      fetchDataSource(this, this.dataSource);\n    }\n  };\n\n  Chart.prototype.startRefresh = function startRefresh () {\n      var this$1 = this;\n\n    var refresh = this.options.refresh;\n\n    if (refresh && typeof this.dataSource !== \"string\" && typeof this.dataSource !== \"function\") {\n      throw new Error(\"Data source must be a URL or callback for refresh\");\n    }\n\n    if (!this.intervalId) {\n      if (refresh) {\n        this.intervalId = setInterval( function () {\n          this$1.refreshData();\n        }, refresh * 1000);\n      } else {\n        throw new Error(\"No refresh interval\");\n      }\n    }\n  };\n\n  Chart.prototype.stopRefresh = function stopRefresh () {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n  };\n\n  Chart.prototype.toImage = function toImage (download) {\n    if (this.adapter === \"chartjs\") {\n      if (download && download.background && download.background !== \"transparent\") {\n        // https://stackoverflow.com/questions/30464750/chartjs-line-chart-set-background-color\n        var canvas = this.chart.chart.canvas;\n        var ctx = this.chart.chart.ctx;\n        var tmpCanvas = document.createElement(\"canvas\");\n        var tmpCtx = tmpCanvas.getContext(\"2d\");\n        tmpCanvas.width = ctx.canvas.width;\n        tmpCanvas.height = ctx.canvas.height;\n        tmpCtx.fillStyle = download.background;\n        tmpCtx.fillRect(0, 0, tmpCanvas.width, tmpCanvas.height);\n        tmpCtx.drawImage(canvas, 0, 0);\n        return tmpCanvas.toDataURL(\"image/png\");\n      } else {\n        return this.chart.toBase64Image();\n      }\n    } else {\n      // TODO throw error in next major version\n      // throw new Error(\"Feature only available for Chart.js\");\n      return null;\n    }\n  };\n\n  Chart.prototype.destroy = function destroy () {\n    this.destroyed = true;\n    this.stopRefresh();\n\n    if (this.__adapterObject) {\n      this.__adapterObject.destroy(this);\n    }\n\n    if (this.__enterEvent) {\n      removeEvent(this.element, \"mouseover\", this.__enterEvent);\n    }\n\n    if (this.__leaveEvent) {\n      removeEvent(this.element, \"mouseout\", this.__leaveEvent);\n    }\n  };\n\n  Chart.prototype.__updateOptions = function __updateOptions (options) {\n    var updateRefresh = options.refresh && options.refresh !== this.options.refresh;\n    this.options = merge(Chartkick.options, options);\n    if (updateRefresh) {\n      this.stopRefresh();\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.__render = function __render () {\n    this.data = this.__processData();\n    renderChart(this.__chartName(), this);\n  };\n\n  Chart.prototype.__config = function __config () {\n    return config;\n  };\n\n  var LineChart = /*@__PURE__*/(function (Chart) {\n    function LineChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) LineChart.__proto__ = Chart;\n    LineChart.prototype = Object.create( Chart && Chart.prototype );\n    LineChart.prototype.constructor = LineChart;\n\n    LineChart.prototype.__processData = function __processData () {\n      return processSeries(this);\n    };\n\n    LineChart.prototype.__chartName = function __chartName () {\n      return \"LineChart\";\n    };\n\n    return LineChart;\n  }(Chart));\n\n  var PieChart = /*@__PURE__*/(function (Chart) {\n    function PieChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) PieChart.__proto__ = Chart;\n    PieChart.prototype = Object.create( Chart && Chart.prototype );\n    PieChart.prototype.constructor = PieChart;\n\n    PieChart.prototype.__processData = function __processData () {\n      return processSimple(this);\n    };\n\n    PieChart.prototype.__chartName = function __chartName () {\n      return \"PieChart\";\n    };\n\n    return PieChart;\n  }(Chart));\n\n  var ColumnChart = /*@__PURE__*/(function (Chart) {\n    function ColumnChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) ColumnChart.__proto__ = Chart;\n    ColumnChart.prototype = Object.create( Chart && Chart.prototype );\n    ColumnChart.prototype.constructor = ColumnChart;\n\n    ColumnChart.prototype.__processData = function __processData () {\n      return processSeries(this, null, true);\n    };\n\n    ColumnChart.prototype.__chartName = function __chartName () {\n      return \"ColumnChart\";\n    };\n\n    return ColumnChart;\n  }(Chart));\n\n  var BarChart = /*@__PURE__*/(function (Chart) {\n    function BarChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) BarChart.__proto__ = Chart;\n    BarChart.prototype = Object.create( Chart && Chart.prototype );\n    BarChart.prototype.constructor = BarChart;\n\n    BarChart.prototype.__processData = function __processData () {\n      return processSeries(this, null, true);\n    };\n\n    BarChart.prototype.__chartName = function __chartName () {\n      return \"BarChart\";\n    };\n\n    return BarChart;\n  }(Chart));\n\n  var AreaChart = /*@__PURE__*/(function (Chart) {\n    function AreaChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) AreaChart.__proto__ = Chart;\n    AreaChart.prototype = Object.create( Chart && Chart.prototype );\n    AreaChart.prototype.constructor = AreaChart;\n\n    AreaChart.prototype.__processData = function __processData () {\n      return processSeries(this);\n    };\n\n    AreaChart.prototype.__chartName = function __chartName () {\n      return \"AreaChart\";\n    };\n\n    return AreaChart;\n  }(Chart));\n\n  var GeoChart = /*@__PURE__*/(function (Chart) {\n    function GeoChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) GeoChart.__proto__ = Chart;\n    GeoChart.prototype = Object.create( Chart && Chart.prototype );\n    GeoChart.prototype.constructor = GeoChart;\n\n    GeoChart.prototype.__processData = function __processData () {\n      return processSimple(this);\n    };\n\n    GeoChart.prototype.__chartName = function __chartName () {\n      return \"GeoChart\";\n    };\n\n    return GeoChart;\n  }(Chart));\n\n  var ScatterChart = /*@__PURE__*/(function (Chart) {\n    function ScatterChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) ScatterChart.__proto__ = Chart;\n    ScatterChart.prototype = Object.create( Chart && Chart.prototype );\n    ScatterChart.prototype.constructor = ScatterChart;\n\n    ScatterChart.prototype.__processData = function __processData () {\n      return processSeries(this, \"number\");\n    };\n\n    ScatterChart.prototype.__chartName = function __chartName () {\n      return \"ScatterChart\";\n    };\n\n    return ScatterChart;\n  }(Chart));\n\n  var BubbleChart = /*@__PURE__*/(function (Chart) {\n    function BubbleChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) BubbleChart.__proto__ = Chart;\n    BubbleChart.prototype = Object.create( Chart && Chart.prototype );\n    BubbleChart.prototype.constructor = BubbleChart;\n\n    BubbleChart.prototype.__processData = function __processData () {\n      return processSeries(this, \"bubble\");\n    };\n\n    BubbleChart.prototype.__chartName = function __chartName () {\n      return \"BubbleChart\";\n    };\n\n    return BubbleChart;\n  }(Chart));\n\n  var Timeline = /*@__PURE__*/(function (Chart) {\n    function Timeline () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) Timeline.__proto__ = Chart;\n    Timeline.prototype = Object.create( Chart && Chart.prototype );\n    Timeline.prototype.constructor = Timeline;\n\n    Timeline.prototype.__processData = function __processData () {\n      var i, data = this.rawData;\n      for (i = 0; i < data.length; i++) {\n        data[i][1] = toDate(data[i][1]);\n        data[i][2] = toDate(data[i][2]);\n      }\n      return data;\n    };\n\n    Timeline.prototype.__chartName = function __chartName () {\n      return \"Timeline\";\n    };\n\n    return Timeline;\n  }(Chart));\n\n  var Chartkick = {\n    LineChart: LineChart,\n    PieChart: PieChart,\n    ColumnChart: ColumnChart,\n    BarChart: BarChart,\n    AreaChart: AreaChart,\n    GeoChart: GeoChart,\n    ScatterChart: ScatterChart,\n    BubbleChart: BubbleChart,\n    Timeline: Timeline,\n    charts: {},\n    configure: function (options) {\n      for (var key in options) {\n        if (options.hasOwnProperty(key)) {\n          config[key] = options[key];\n        }\n      }\n    },\n    setDefaultOptions: function (opts) {\n      Chartkick.options = opts;\n    },\n    eachChart: function (callback) {\n      for (var chartId in Chartkick.charts) {\n        if (Chartkick.charts.hasOwnProperty(chartId)) {\n          callback(Chartkick.charts[chartId]);\n        }\n      }\n    },\n    destroyAll: function() {\n      for (var chartId in Chartkick.charts) {\n        if (Chartkick.charts.hasOwnProperty(chartId)) {\n          Chartkick.charts[chartId].destroy();\n          delete Chartkick.charts[chartId];\n        }\n      }\n    },\n    config: config,\n    options: {},\n    adapters: adapters,\n    addAdapter: addAdapter,\n    use: function(adapter) {\n      addAdapter(adapter);\n      return Chartkick;\n    }\n  };\n\n  // not ideal, but allows for simpler integration\n  if (typeof window !== \"undefined\" && !window.Chartkick) {\n    window.Chartkick = Chartkick;\n\n    // clean up previous charts before Turbolinks loads new page\n    document.addEventListener(\"turbolinks:before-render\", function() {\n      Chartkick.destroyAll();\n    });\n\n    // use setTimeout so charting library can come later in same JS file\n    setTimeout(function() {\n      window.dispatchEvent(new Event(\"chartkick:load\"));\n    }, 0);\n  }\n\n  // backwards compatibility for esm require\n  Chartkick.default = Chartkick;\n\n  return Chartkick;\n\n})));\n"]},"metadata":{},"sourceType":"script"}