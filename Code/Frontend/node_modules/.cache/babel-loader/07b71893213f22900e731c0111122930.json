{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bryceschmisseur/Documents/CST-452/IHeartRate/frontend-fire/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/bryceschmisseur/Documents/CST-452/IHeartRate/frontend-fire/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/bryceschmisseur/Documents/CST-452/IHeartRate/frontend-fire/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef,useEffect}from'react';import{makeStyles}from'@material-ui/core/styles';import AWS from'aws-sdk';import IconButton from'@material-ui/core/IconButton';import Avatar from'@material-ui/core/Avatar';import Loading from'./../Navigation/Loading';import UserService from'./../../services/UserService';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var S3_BUCKET='iheartrate-pictures';var REGION='us-west-1';AWS.config.update({accessKeyId:'AKIA4CZAE7UDP6PCURON',secretAccessKey:'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'});var myBucket=new AWS.S3({params:{Bucket:S3_BUCKET},region:REGION});var useStyles=makeStyles(function(theme){return{avatar:{width:'100px',height:'100px',marginTop:'25px',marginBottom:'25px',alignSelf:'center'}};});var ProfilePicture=function ProfilePicture(props){useEffect(function(){UserService.get(props.curAppleId).then(function(response){var user=response[0];if(user===undefined){}else{var profilePicture=user[\"profilePicture\"];setPictureSRC('https://iheartrate-pictures.s3-us-west-1.amazonaws.com/'+profilePicture);}});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var classes=useStyles();var _useState=useState(\" \"),_useState2=_slicedToArray(_useState,2),pictureSRC=_useState2[0],setPictureSRC=_useState2[1];var inputFileMenu=useRef(null);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var handleFileInput=function handleFileInput(e){setPictureSRC(URL.createObjectURL(e.target.files[0]));uploadFile(e.target.files[0]);};var handleIconButton=function handleIconButton(){inputFileMenu.current.click();};var uploadFile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file){var params;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);params={ACL:'public-read',Body:file,Bucket:S3_BUCKET,Key:file.name};myBucket.putObject(params).on('httpUploadProgress',function(evt){}).send(function(err){if(err)console.log(err);});UserService.get(props.curAppleId).then(function(response){var user=response[0];console.log(user);if(user===undefined){var json=JSON.stringify({\"_id\":\"\",\"displayName\":props.displayName,\"appleId\":props.curAppleId,\"profilePicture\":file.name});UserService.saveUser(json);}else{console.log(user[\"_id\"]);var _json=JSON.stringify({\"_id\":user[\"_id\"],\"displayName\":props.displayName,\"appleId\":props.curAppleId,\"profilePicture\":file.name});UserService.update(_json);}});setIsLoading(false);case 5:case\"end\":return _context.stop();}}},_callee);}));return function uploadFile(_x){return _ref.apply(this,arguments);};}();var iconButton=/*#__PURE__*/_jsx(IconButton,{style:{width:'75px',height:'75px',margin:'5px'},className:classes.avatar,onClick:handleIconButton,children:/*#__PURE__*/_jsx(Avatar,{style:{width:'50px',height:'50px'},src:pictureSRC,alt:props.displayName,children:props.displayName.charAt(0)})});if(!props.small){iconButton=/*#__PURE__*/_jsx(IconButton,{className:classes.avatar,onClick:handleIconButton,children:/*#__PURE__*/_jsx(Avatar,{style:{width:'75px',height:'75px'},src:pictureSRC,alt:props.displayName,children:props.displayName.charAt(0)})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",id:\"contained-button-file\",onChange:handleFileInput,style:{display:'none'},ref:inputFileMenu,type:\"file\"}),iconButton,/*#__PURE__*/_jsx(Loading,{open:isLoading})]});};export default ProfilePicture;","map":{"version":3,"sources":["/Users/bryceschmisseur/Documents/CST-452/IHeartRate/frontend-fire/src/components/Dashboard/ProfilePicture.js"],"names":["React","useState","useRef","useEffect","makeStyles","AWS","IconButton","Avatar","Loading","UserService","S3_BUCKET","REGION","config","update","accessKeyId","secretAccessKey","myBucket","S3","params","Bucket","region","useStyles","theme","avatar","width","height","marginTop","marginBottom","alignSelf","ProfilePicture","props","get","curAppleId","then","response","user","undefined","profilePicture","setPictureSRC","classes","pictureSRC","inputFileMenu","isLoading","setIsLoading","handleFileInput","e","URL","createObjectURL","target","files","uploadFile","handleIconButton","current","click","file","ACL","Body","Key","name","putObject","on","evt","send","err","console","log","json","JSON","stringify","displayName","saveUser","iconButton","margin","charAt","small","display"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport AWS from 'aws-sdk'\nimport IconButton from '@material-ui/core/IconButton';\nimport Avatar from '@material-ui/core/Avatar';\nimport Loading from './../Navigation/Loading';\nimport UserService from './../../services/UserService';\n\n\nconst S3_BUCKET ='iheartrate-pictures';\nconst REGION ='us-west-1';\n\n\nAWS.config.update({\n    accessKeyId: 'AKIA4CZAE7UDP6PCURON',\n    secretAccessKey: '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'\n})\n\nconst myBucket = new AWS.S3({\n    params: { Bucket: S3_BUCKET},\n    region: REGION,\n})\n\nconst useStyles = makeStyles((theme) => ({\n    avatar: {\n        width: '100px',\n        height: '100px',\n        marginTop: '25px',\n        marginBottom: '25px',\n        alignSelf: 'center'\n    },\n}));\n\nconst ProfilePicture = (props) => {\n    useEffect(() => {\n        UserService.get(props.curAppleId).then(response => {\n            let user = response[0];\n            if(user === undefined){\n\n            } else {\n                let profilePicture = user[\"profilePicture\"];\n                setPictureSRC('https://iheartrate-pictures.s3-us-west-1.amazonaws.com/' + profilePicture);\n            }  \n        })\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    },[])\n    const classes = useStyles();\n\n    const [pictureSRC, setPictureSRC] = useState(\" \")\n    const inputFileMenu = useRef(null);\n    const [isLoading, setIsLoading] = useState(false);\n\n    const handleFileInput = (e) => {\n        setPictureSRC(URL.createObjectURL(e.target.files[0]));\n        uploadFile(e.target.files[0]);\n    }\n\n    const handleIconButton = () => {\n        inputFileMenu.current.click();\n    }\n\n    const uploadFile = async (file) => {\n        setIsLoading(true);\n        const params = {\n            ACL: 'public-read',\n            Body: file,\n            Bucket: S3_BUCKET,\n            Key: file.name\n        };\n\n        myBucket.putObject(params)\n            .on('httpUploadProgress', (evt) => {\n\n            })\n            .send((err) => {\n                if (err) console.log(err)\n            })\n\n        UserService.get(props.curAppleId).then(response => {\n        let user = response[0];\n        console.log(user);\n\n        if(user === undefined){\n            let json = JSON.stringify({\n                \"_id\": \"\",\n                \"displayName\": props.displayName,\n                \"appleId\" : props.curAppleId,\n                \"profilePicture\": file.name,\n                });\n\n            UserService.saveUser(json);\n        } else {\n            console.log(user[\"_id\"])\n            let json = JSON.stringify({\n                \"_id\": user[\"_id\"],\n                \"displayName\": props.displayName,\n                \"appleId\" : props.curAppleId,\n                \"profilePicture\": file.name,\n                });\n            UserService.update(json)\n            \n        }\n        })\n        setIsLoading(false);\n    }\n\n    var iconButton = <IconButton style={{width: '75px', height: '75px', margin: '5px'}}className={classes.avatar} onClick={handleIconButton}>\n                        <Avatar style={{width: '50px', height: '50px'}} src={pictureSRC} alt={props.displayName}>\n                        {props.displayName.charAt(0)}\n                        </Avatar>\n                    </IconButton>;\n    if(!props.small){\n        iconButton = <IconButton className={classes.avatar} onClick={handleIconButton}>\n                        <Avatar style={{width: '75px', height: '75px'}} src={pictureSRC} alt={props.displayName}>\n                        {props.displayName.charAt(0)}\n                        </Avatar>\n                    </IconButton>;\n    }\n\n    return (\n    <div>\n        <input accept=\"image/*\" id=\"contained-button-file\" onChange={handleFileInput} style={{display: 'none' }} ref={inputFileMenu} type=\"file\"/>\n            {iconButton}\n        <Loading open={isLoading}/>\n    </div>\n    )\n}\n\nexport default ProfilePicture;"]},"metadata":{},"sourceType":"module"}