{"ast":null,"code":"var _jsxFileName = \"/Users/bryceschmisseur/Documents/CST-452/IHeartRate/frontend-fire/src/pages/Dashboard.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport HeartSerivce from './../services/HeartRateService';\nimport SideBar from '../components/Navigation/SideBar';\nimport { makeStyles } from '@material-ui/core';\nimport Grid from '@material-ui/core/Grid';\nimport Cookies from 'universal-cookie';\nimport BPMCard from './../components/Dashboard/BPMCard';\nimport Table from './../components/Dashboard/Table';\nimport Graph from './../components/Dashboard/Graph';\nimport NoData from './../components/Dashboard/NoData';\nimport moment from 'moment';\nimport Heading from './../components/Dashboard/Heading';\nimport Footer from './../components/Navigation/Footer';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport SelectDates from './../components/Dashboard/SelectDates';\nimport LoadingPage from './../components/Navigation/Loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  content: {\n    paddingTop: '25px',\n    paddingRight: '25px',\n    paddingLeft: '110px',\n    '@media (min-width: 900px)': {\n      paddingLeft: '265px'\n    }\n  },\n  welcome: {\n    textAlign: 'left',\n    fontWeight: '300',\n    fontSize: '28px'\n  },\n  output: {\n    textAlign: 'left',\n    fontWeight: '100',\n    fontSize: '22px'\n  }\n}));\n\nfunction createData(unNum, bpm, date) {\n  return {\n    unNum,\n    bpm,\n    date\n  };\n}\n\nconst Dashboard = () => {\n  _s();\n\n  const matchWidth = useMediaQuery('(min-width:1150px)');\n  const matchWidthSec = useMediaQuery('(min-width:600px)');\n  const classes = useStyles();\n  const cookies = new Cookies();\n  const curAppleId = cookies.get('currAppleId');\n  const displayName = cookies.get('displayName');\n  const [heartData, setHeartData] = useState([]);\n  const [rows, setRows] = useState([]);\n  const [page, setPage] = useState(0);\n  const [rowsPerPage, setRowsPerPage] = useState(10);\n  const [openNoData, setOpenNoData] = useState(false);\n  const [datesButtonDis, setDatesButtonDis] = useState(false);\n  const [openDate, setOpenDate] = useState(false);\n  const [avgRate, setAvgRate] = useState(0);\n  const [lastRec, setLastRec] = useState(0);\n  const [selectedDateFrom, setSelectedDateFrom] = useState(new Date());\n  const [selectedDateTo, setSelectedDateTo] = useState(new Date());\n  const [data, setData] = useState(JSON.parse(\"{}\"));\n  const [viewData, setViewData] = useState('full');\n  const [isLoadingPage, setIsLoadingPage] = useState(false);\n  useEffect(() => {\n    setIsLoadingPage(true);\n    HeartSerivce.getUsers(curAppleId).then(response => {\n      let arr = [];\n      Object.keys(response.data).forEach(function (key) {\n        let currDate = moment(response.data[key].date);\n        let HeartRate = {\n          bpm: response.data[key].bpm,\n          date: currDate,\n          user_id: response.data[key].userid\n        };\n        arr.push(HeartRate);\n      });\n      let arrTable = arr.reverse();\n\n      if (arrTable.length <= 0) {\n        setDatesButtonDis(true);\n        setOpenNoData(true);\n      } else {\n        setLastRec(arrTable[0].bpm);\n        setHeartData(arrTable);\n        let data = [];\n\n        for (let i = 0; i < arrTable.length; i++) {\n          data.push(createData(i, arrTable[i].bpm, arrTable[i].date.format('lll')));\n        }\n\n        setRows(data);\n        let chartdata = \"{\";\n        let currAveRate = 0;\n\n        for (let i = page * rowsPerPage; i < page * rowsPerPage + rowsPerPage; i++) {\n          if (i > arrTable.length - 1) {\n            chartdata = chartdata.substr(0, chartdata.length - 1);\n            break;\n          }\n\n          currAveRate += arrTable[i].bpm;\n          chartdata += '\"' + arrTable[i].date.format('MMM D h:m.s') + '\": ' + arrTable[i].bpm;\n\n          if (i !== page * rowsPerPage + rowsPerPage - 1) {\n            chartdata += \",\";\n          }\n        }\n\n        chartdata += \"}\";\n        setData(JSON.parse(chartdata));\n        setAvgRate(Math.round(currAveRate / rowsPerPage));\n      }\n    });\n    setIsLoadingPage(false); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleChangePage = (event, newPage) => {\n    setPage(newPage);\n    generteGraphData(heartData, rows.length, rowsPerPage, newPage);\n  };\n\n  const handleChangeRowsPerPage = event => {\n    setRowsPerPage(+event.target.value);\n    setPage(0); //updateGraph(0, +event.target.value, heartData);\n\n    generteGraphData(heartData, rows.length, +event.target.value, page);\n  };\n\n  const handleCloseNoData = () => {\n    setOpenNoData(false);\n  };\n\n  const handleClickOpenDate = () => {\n    setOpenDate(true);\n  };\n\n  const handleCloseDate = () => {\n    let dateFrom = moment(selectedDateFrom);\n    let dateTo = moment(selectedDateTo);\n\n    if (dateFrom.isAfter(dateTo) || dateTo.isBefore(dateFrom)) {\n      alert(\"The date start must not be after the end date or the end date must not be before the start date!\");\n    } else {\n      setOpenDate(false);\n      let tableData = [];\n      let chartData = \"{\";\n      let heartRates = 0;\n      let numRates = 0;\n\n      for (let i = 0; i < heartData.length; i++) {\n        let currDate = heartData[i].date;\n\n        if (currDate.isAfter(dateFrom) && currDate.isBefore(dateTo)) {\n          heartRates += heartData[i].bpm;\n          numRates++;\n          tableData.push(createData(i, heartData[i].bpm, heartData[i].date.format('lll')));\n          chartData += '\"' + heartData[i].date.format('MMM D, YYYY h:m.s') + '\": ' + heartData[i].bpm + ',';\n        }\n      }\n\n      if (numRates > 0) {\n        setAvgRate(Math.round(heartRates / numRates));\n        chartData = chartData.substring(0, chartData.length - 1);\n        chartData += \"}\";\n        setRows(tableData);\n        setPage(0);\n        setRowsPerPage(-1);\n        setData(JSON.parse(chartData));\n      } else {\n        setOpenDate(true);\n        alert(\"No data found between those dates\");\n      }\n    }\n  };\n\n  const handleDateChangeFrom = date => {\n    setSelectedDateFrom(date);\n  };\n\n  const handleDateChangeTo = date => {\n    setSelectedDateTo(date);\n  };\n\n  const handleReset = () => {\n    setOpenDate(false);\n    setRowsPerPage(10);\n    setPage(0);\n    generteGraphData(heartData, heartData.length, 10, 0);\n  };\n\n  const handelRefresh = () => {\n    setViewData(\"full\");\n    HeartSerivce.getUsers(curAppleId).then(response => {\n      let arr = [];\n      Object.keys(response.data).forEach(function (key) {\n        let currDate = moment(response.data[key].date);\n        let HeartRate = {\n          bpm: response.data[key].bpm,\n          date: currDate,\n          user_id: response.data[key].userid\n        };\n        arr.push(HeartRate);\n      });\n      let arrTable = arr.reverse();\n      setLastRec(arrTable[0].bpm);\n\n      if (arrTable.length <= 0) {\n        setDatesButtonDis(true);\n        setOpenNoData(true);\n      } else {\n        setHeartData(arrTable);\n        let data = [];\n\n        for (let i = 0; i < arrTable.length; i++) {\n          data.push(createData(i, arrTable[i].bpm, arrTable[i].date.format('lll')));\n        }\n\n        setRows(data);\n        let chartdata = \"{\";\n        let currAveRate = 0;\n\n        for (let i = page * rowsPerPage; i < page * rowsPerPage + rowsPerPage; i++) {\n          if (i > arrTable.length - 1) {\n            chartdata = chartdata.substr(0, chartdata.length - 1);\n            break;\n          }\n\n          currAveRate += arrTable[i].bpm;\n          chartdata += '\"' + arrTable[i].date.format('MMM D h:m.s') + '\": ' + arrTable[i].bpm;\n\n          if (i !== page * rowsPerPage + rowsPerPage - 1) {\n            chartdata += \",\";\n          }\n        }\n\n        chartdata += \"}\";\n        setData(JSON.parse(chartdata));\n        setAvgRate(Math.round(currAveRate / rowsPerPage));\n      }\n    });\n  };\n\n  const handleTableClick = () => {\n    setViewData(\"table\");\n  };\n\n  const handleGraphClick = () => {\n    setViewData(\"graph\");\n  };\n\n  const generteGraphData = (tableData, length, numElements, page) => {\n    if (numElements !== -1) {\n      let chartdata = \"{\";\n      let currAveRate = 0;\n\n      for (let i = page * numElements; i < page * numElements + numElements; i++) {\n        if (i > tableData.length - 1) {\n          chartdata = chartdata.substr(0, chartdata.length - 1);\n          break;\n        }\n\n        currAveRate += tableData[i].bpm;\n        chartdata += '\"' + tableData[i].date.format('MMM D h:m.s') + '\": ' + tableData[i].bpm;\n\n        if (i !== page * numElements + numElements - 1) {\n          chartdata += \",\";\n        }\n      }\n\n      chartdata += \"}\";\n      setData(JSON.parse(chartdata));\n      setAvgRate(Math.round(currAveRate / numElements));\n    } else {\n      let chartdata = \"{\";\n      let currAveRate = 0;\n\n      for (let i = 0; i < length; i++) {\n        currAveRate += tableData[i].bpm;\n        chartdata += '\"' + tableData[i].date.format('MMM D h:m.s') + '\": ' + tableData[i].bpm;\n\n        if (i !== length - 1) {\n          chartdata += \",\";\n        }\n      }\n\n      chartdata += \"}\";\n      setData(JSON.parse(chartdata));\n      setAvgRate(Math.round(currAveRate / length));\n    }\n  };\n\n  var body = /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      sm: matchWidth ? 6 : 12,\n      className: classes.tableHeight,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '10px',\n          height: '76vh'\n        },\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          rows: rows,\n          page: page,\n          rowsPerPage: rowsPerPage,\n          handleChangePage: handleChangePage,\n          handleChangeRowsPerPage: handleChangeRowsPerPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 21\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      sm: matchWidth ? 6 : 12,\n      style: {\n        height: '76vh'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '10px'\n        },\n        children: /*#__PURE__*/_jsxDEV(Graph, {\n          data: data\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sm: matchWidthSec ? 6 : 12,\n          style: {\n            height: '200px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              paddingRight: '10px',\n              paddingLeft: '10px',\n              paddingTop: '10px',\n              width: '100%'\n            },\n            children: /*#__PURE__*/_jsxDEV(BPMCard, {\n              title: \"Average Heart Rate\",\n              bpm: avgRate\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sm: matchWidthSec ? 6 : 12,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              paddingRight: '10px',\n              paddingLeft: '10px',\n              paddingTop: '10px',\n              width: '100%',\n              minHeight: '100%'\n            },\n            children: /*#__PURE__*/_jsxDEV(BPMCard, {\n              title: \"Last Recoded Heart Rate\",\n              bpm: lastRec\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 278,\n    columnNumber: 17\n  }, this);\n\n  if (viewData === \"table\") {\n    body = /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '15px',\n        height: '78vh',\n        width: '100%'\n      },\n      children: /*#__PURE__*/_jsxDEV(Table, {\n        rows: rows,\n        page: page,\n        rowsPerPage: rowsPerPage,\n        handleChangePage: handleChangePage,\n        handleChangeRowsPerPage: handleChangeRowsPerPage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 17\n    }, this);\n  } else if (viewData === \"graph\") {\n    body = /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '15px',\n        height: '78vh',\n        width: '100%'\n      },\n      children: /*#__PURE__*/_jsxDEV(Graph, {\n        data: data\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 17\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(LoadingPage, {\n      open: isLoadingPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(NoData, {\n      displayName: displayName,\n      openNoData: openNoData,\n      setOpenNoData: setOpenNoData,\n      handleCloseNoData: handleCloseNoData\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SelectDates, {\n      openDate: openDate,\n      handleCloseDate: handleCloseDate,\n      selectedDateFrom: selectedDateFrom,\n      selectedDateTo: selectedDateTo,\n      handleDateChangeFrom: handleDateChangeFrom,\n      handleDateChangeTo: handleDateChangeTo,\n      handleReset: handleReset\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SideBar, {\n      handleTableClick: handleTableClick,\n      handleGraphClick: handleGraphClick\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.content,\n      children: /*#__PURE__*/_jsxDEV(Grid, {\n        children: [/*#__PURE__*/_jsxDEV(Heading, {\n          displayName: displayName,\n          datesButtonDis: datesButtonDis,\n          handleClickOpenDate: handleClickOpenDate,\n          handelRefresh: handelRefresh\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 21\n        }, this), body, /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 326,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Dashboard, \"J2dRPRpC7DuMHdcrYI5DsYuyfbc=\", false, function () {\n  return [useMediaQuery, useMediaQuery, useStyles];\n});\n\n_c = Dashboard;\nexport default Dashboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"sources":["/Users/bryceschmisseur/Documents/CST-452/IHeartRate/frontend-fire/src/pages/Dashboard.js"],"names":["useState","useEffect","HeartSerivce","SideBar","makeStyles","Grid","Cookies","BPMCard","Table","Graph","NoData","moment","Heading","Footer","useMediaQuery","SelectDates","LoadingPage","useStyles","theme","content","paddingTop","paddingRight","paddingLeft","welcome","textAlign","fontWeight","fontSize","output","createData","unNum","bpm","date","Dashboard","matchWidth","matchWidthSec","classes","cookies","curAppleId","get","displayName","heartData","setHeartData","rows","setRows","page","setPage","rowsPerPage","setRowsPerPage","openNoData","setOpenNoData","datesButtonDis","setDatesButtonDis","openDate","setOpenDate","avgRate","setAvgRate","lastRec","setLastRec","selectedDateFrom","setSelectedDateFrom","Date","selectedDateTo","setSelectedDateTo","data","setData","JSON","parse","viewData","setViewData","isLoadingPage","setIsLoadingPage","getUsers","then","response","arr","Object","keys","forEach","key","currDate","HeartRate","user_id","userid","push","arrTable","reverse","length","i","format","chartdata","currAveRate","substr","Math","round","handleChangePage","event","newPage","generteGraphData","handleChangeRowsPerPage","target","value","handleCloseNoData","handleClickOpenDate","handleCloseDate","dateFrom","dateTo","isAfter","isBefore","alert","tableData","chartData","heartRates","numRates","substring","handleDateChangeFrom","handleDateChangeTo","handleReset","handelRefresh","handleTableClick","handleGraphClick","numElements","body","tableHeight","padding","height","width","minHeight"],"mappings":";;;AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,OAAOC,YAAP,MAAyB,gCAAzB;AACA,OAAOC,OAAP,MAAoB,kCAApB;AACA,SAASC,UAAT,QAA2B,mBAA3B;AACA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,OAAOC,OAAP,MAAoB,mCAApB;AACA,OAAOC,KAAP,MAAkB,iCAAlB;AACA,OAAOC,KAAP,MAAkB,iCAAlB;AACA,OAAOC,MAAP,MAAmB,kCAAnB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAOC,OAAP,MAAoB,mCAApB;AACA,OAAOC,MAAP,MAAmB,mCAAnB;AACA,OAAOC,aAAP,MAA0B,iCAA1B;AACA,OAAOC,WAAP,MAAwB,uCAAxB;AACA,OAAOC,WAAP,MAAwB,oCAAxB;;AAGA,MAAMC,SAAS,GAAGb,UAAU,CAAEc,KAAD,KAAY;AACrCC,EAAAA,OAAO,EAAE;AACLC,IAAAA,UAAU,EAAE,MADP;AAELC,IAAAA,YAAY,EAAE,MAFT;AAGLC,IAAAA,WAAW,EAAE,OAHR;AAIL,iCAA6B;AACzBA,MAAAA,WAAW,EAAE;AADY;AAJxB,GAD4B;AASrCC,EAAAA,OAAO,EAAE;AACLC,IAAAA,SAAS,EAAE,MADN;AAELC,IAAAA,UAAU,EAAE,KAFP;AAGLC,IAAAA,QAAQ,EAAE;AAHL,GAT4B;AAcrCC,EAAAA,MAAM,EAAE;AACJH,IAAAA,SAAS,EAAE,MADP;AAEJC,IAAAA,UAAU,EAAE,KAFR;AAGJC,IAAAA,QAAQ,EAAE;AAHN;AAd6B,CAAZ,CAAD,CAA5B;;AAqBA,SAASE,UAAT,CAAoBC,KAApB,EAA2BC,GAA3B,EAAgCC,IAAhC,EAAsC;AAClC,SAAO;AAACF,IAAAA,KAAD;AAAQC,IAAAA,GAAR;AAAaC,IAAAA;AAAb,GAAP;AACH;;AAED,MAAMC,SAAS,GAAG,MAAM;AAAA;;AACpB,QAAMC,UAAU,GAAGnB,aAAa,CAAC,oBAAD,CAAhC;AACA,QAAMoB,aAAa,GAAGpB,aAAa,CAAC,mBAAD,CAAnC;AAEA,QAAMqB,OAAO,GAAGlB,SAAS,EAAzB;AACA,QAAMmB,OAAO,GAAG,IAAI9B,OAAJ,EAAhB;AACA,QAAM+B,UAAU,GAAGD,OAAO,CAACE,GAAR,CAAY,aAAZ,CAAnB;AACA,QAAMC,WAAW,GAAGH,OAAO,CAACE,GAAR,CAAY,aAAZ,CAApB;AACA,QAAM,CAACE,SAAD,EAAYC,YAAZ,IAA4BzC,QAAQ,CAAC,EAAD,CAA1C;AACA,QAAM,CAAC0C,IAAD,EAAOC,OAAP,IAAkB3C,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAAC4C,IAAD,EAAOC,OAAP,IAAkB7C,QAAQ,CAAC,CAAD,CAAhC;AACA,QAAM,CAAC8C,WAAD,EAAcC,cAAd,IAAgC/C,QAAQ,CAAC,EAAD,CAA9C;AACA,QAAM,CAACgD,UAAD,EAAaC,aAAb,IAA8BjD,QAAQ,CAAC,KAAD,CAA5C;AACA,QAAM,CAACkD,cAAD,EAAiBC,iBAAjB,IAAsCnD,QAAQ,CAAC,KAAD,CAApD;AACA,QAAM,CAACoD,QAAD,EAAWC,WAAX,IAA0BrD,QAAQ,CAAC,KAAD,CAAxC;AACA,QAAM,CAACsD,OAAD,EAAUC,UAAV,IAAwBvD,QAAQ,CAAC,CAAD,CAAtC;AACA,QAAM,CAACwD,OAAD,EAAUC,UAAV,IAAwBzD,QAAQ,CAAC,CAAD,CAAtC;AACA,QAAM,CAAC0D,gBAAD,EAAmBC,mBAAnB,IAA0C3D,QAAQ,CAAC,IAAI4D,IAAJ,EAAD,CAAxD;AACA,QAAM,CAACC,cAAD,EAAiBC,iBAAjB,IAAsC9D,QAAQ,CAAC,IAAI4D,IAAJ,EAAD,CAApD;AACA,QAAM,CAACG,IAAD,EAAOC,OAAP,IAAkBhE,QAAQ,CAACiE,IAAI,CAACC,KAAL,CAAW,IAAX,CAAD,CAAhC;AACA,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BpE,QAAQ,CAAC,MAAD,CAAxC;AACA,QAAM,CAACqE,aAAD,EAAgBC,gBAAhB,IAAoCtE,QAAQ,CAAC,KAAD,CAAlD;AAGAC,EAAAA,SAAS,CAAC,MAAM;AACZqE,IAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACApE,IAAAA,YAAY,CAACqE,QAAb,CAAsBlC,UAAtB,EAAkCmC,IAAlC,CAAuCC,QAAQ,IAAI;AAC/C,UAAIC,GAAG,GAAG,EAAV;AACAC,MAAAA,MAAM,CAACC,IAAP,CAAYH,QAAQ,CAACV,IAArB,EAA2Bc,OAA3B,CAAmC,UAASC,GAAT,EAAc;AAC7C,YAAIC,QAAQ,GAAGpE,MAAM,CAAC8D,QAAQ,CAACV,IAAT,CAAce,GAAd,EAAmB/C,IAApB,CAArB;AACA,YAAIiD,SAAS,GAAG;AACZlD,UAAAA,GAAG,EAAE2C,QAAQ,CAACV,IAAT,CAAce,GAAd,EAAmBhD,GADZ;AAEZC,UAAAA,IAAI,EAAEgD,QAFM;AAGZE,UAAAA,OAAO,EAAER,QAAQ,CAACV,IAAT,CAAce,GAAd,EAAmBI;AAHhB,SAAhB;AAKAR,QAAAA,GAAG,CAACS,IAAJ,CAASH,SAAT;AACH,OARD;AASA,UAAII,QAAQ,GAAGV,GAAG,CAACW,OAAJ,EAAf;;AACA,UAAGD,QAAQ,CAACE,MAAT,IAAmB,CAAtB,EACA;AACInC,QAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACAF,QAAAA,aAAa,CAAC,IAAD,CAAb;AACH,OAJD,MAIO;AACHQ,QAAAA,UAAU,CAAC2B,QAAQ,CAAC,CAAD,CAAR,CAAYtD,GAAb,CAAV;AACAW,QAAAA,YAAY,CAAC2C,QAAD,CAAZ;AACA,YAAIrB,IAAI,GAAG,EAAX;;AACA,aAAI,IAAIwB,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGH,QAAQ,CAACE,MAA5B,EAAoCC,CAAC,EAArC,EAAwC;AACpCxB,UAAAA,IAAI,CAACoB,IAAL,CAAUvD,UAAU,CAAC2D,CAAD,EAAIH,QAAQ,CAACG,CAAD,CAAR,CAAYzD,GAAhB,EAAqBsD,QAAQ,CAACG,CAAD,CAAR,CAAYxD,IAAZ,CAAiByD,MAAjB,CAAwB,KAAxB,CAArB,CAApB;AACH;;AACD7C,QAAAA,OAAO,CAACoB,IAAD,CAAP;AACA,YAAI0B,SAAS,GAAG,GAAhB;AACA,YAAIC,WAAW,GAAG,CAAlB;;AACA,aAAI,IAAIH,CAAC,GAAK3C,IAAI,GAAGE,WAArB,EAAoCyC,CAAC,GAAK3C,IAAI,GAAGE,WAAR,GAAuBA,WAAhE,EAA8EyC,CAAC,EAA/E,EAAkF;AAC9E,cAAGA,CAAC,GAAGH,QAAQ,CAACE,MAAT,GAAkB,CAAzB,EACA;AACIG,YAAAA,SAAS,GAAGA,SAAS,CAACE,MAAV,CAAiB,CAAjB,EAAoBF,SAAS,CAACH,MAAV,GAAkB,CAAtC,CAAZ;AACA;AACH;;AACDI,UAAAA,WAAW,IAAIN,QAAQ,CAACG,CAAD,CAAR,CAAYzD,GAA3B;AACA2D,UAAAA,SAAS,IAAI,MAAML,QAAQ,CAACG,CAAD,CAAR,CAAYxD,IAAZ,CAAiByD,MAAjB,CAAwB,aAAxB,CAAN,GAA+C,KAA/C,GAAuDJ,QAAQ,CAACG,CAAD,CAAR,CAAYzD,GAAhF;;AACA,cAAGyD,CAAC,KAAO3C,IAAI,GAAGE,WAAR,GAAuBA,WAAxB,GAAuC,CAAhD,EAAkD;AAC9C2C,YAAAA,SAAS,IAAI,GAAb;AACH;AACJ;;AACDA,QAAAA,SAAS,IAAI,GAAb;AACAzB,QAAAA,OAAO,CAACC,IAAI,CAACC,KAAL,CAAWuB,SAAX,CAAD,CAAP;AACAlC,QAAAA,UAAU,CAACqC,IAAI,CAACC,KAAL,CAAWH,WAAW,GAAG5C,WAAzB,CAAD,CAAV;AACH;AACJ,KA1CD;AA2CAwB,IAAAA,gBAAgB,CAAC,KAAD,CAAhB,CA7CY,CA8ChB;AACC,GA/CQ,EA+CN,EA/CM,CAAT;;AAiDA,QAAMwB,gBAAgB,GAAG,CAACC,KAAD,EAAQC,OAAR,KAAoB;AACzCnD,IAAAA,OAAO,CAACmD,OAAD,CAAP;AACAC,IAAAA,gBAAgB,CAACzD,SAAD,EAAYE,IAAI,CAAC4C,MAAjB,EAAyBxC,WAAzB,EAAsCkD,OAAtC,CAAhB;AACH,GAHD;;AAKA,QAAME,uBAAuB,GAAIH,KAAD,IAAW;AACvChD,IAAAA,cAAc,CAAC,CAACgD,KAAK,CAACI,MAAN,CAAaC,KAAf,CAAd;AACAvD,IAAAA,OAAO,CAAC,CAAD,CAAP,CAFuC,CAGvC;;AACAoD,IAAAA,gBAAgB,CAACzD,SAAD,EAAYE,IAAI,CAAC4C,MAAjB,EAAyB,CAACS,KAAK,CAACI,MAAN,CAAaC,KAAvC,EAA8CxD,IAA9C,CAAhB;AACH,GALD;;AAOA,QAAMyD,iBAAiB,GAAG,MAAM;AAC5BpD,IAAAA,aAAa,CAAC,KAAD,CAAb;AACH,GAFD;;AAIA,QAAMqD,mBAAmB,GAAG,MAAM;AAC9BjD,IAAAA,WAAW,CAAC,IAAD,CAAX;AACH,GAFD;;AAIA,QAAMkD,eAAe,GAAG,MAAM;AAC1B,QAAIC,QAAQ,GAAG7F,MAAM,CAAC+C,gBAAD,CAArB;AACA,QAAI+C,MAAM,GAAG9F,MAAM,CAACkD,cAAD,CAAnB;;AACA,QAAG2C,QAAQ,CAACE,OAAT,CAAiBD,MAAjB,KAA4BA,MAAM,CAACE,QAAP,CAAgBH,QAAhB,CAA/B,EAAyD;AACrDI,MAAAA,KAAK,CAAC,kGAAD,CAAL;AACH,KAFD,MAEO;AACHvD,MAAAA,WAAW,CAAC,KAAD,CAAX;AACA,UAAIwD,SAAS,GAAG,EAAhB;AACA,UAAIC,SAAS,GAAG,GAAhB;AACA,UAAIC,UAAU,GAAG,CAAjB;AACA,UAAIC,QAAQ,GAAG,CAAf;;AACA,WAAI,IAAIzB,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG/C,SAAS,CAAC8C,MAA7B,EAAqCC,CAAC,EAAtC,EAAyC;AACrC,YAAIR,QAAQ,GAAGvC,SAAS,CAAC+C,CAAD,CAAT,CAAaxD,IAA5B;;AACA,YAAGgD,QAAQ,CAAC2B,OAAT,CAAiBF,QAAjB,KAA8BzB,QAAQ,CAAC4B,QAAT,CAAkBF,MAAlB,CAAjC,EAA2D;AACvDM,UAAAA,UAAU,IAAIvE,SAAS,CAAC+C,CAAD,CAAT,CAAazD,GAA3B;AACAkF,UAAAA,QAAQ;AACRH,UAAAA,SAAS,CAAC1B,IAAV,CAAevD,UAAU,CAAC2D,CAAD,EAAI/C,SAAS,CAAC+C,CAAD,CAAT,CAAazD,GAAjB,EAAsBU,SAAS,CAAC+C,CAAD,CAAT,CAAaxD,IAAb,CAAkByD,MAAlB,CAAyB,KAAzB,CAAtB,CAAzB;AACAsB,UAAAA,SAAS,IAAI,MAAMtE,SAAS,CAAC+C,CAAD,CAAT,CAAaxD,IAAb,CAAkByD,MAAlB,CAAyB,mBAAzB,CAAN,GAAsD,KAAtD,GAA8DhD,SAAS,CAAC+C,CAAD,CAAT,CAAazD,GAA3E,GAAiF,GAA9F;AACH;AACJ;;AACD,UAAIkF,QAAQ,GAAG,CAAf,EAAkB;AACdzD,QAAAA,UAAU,CAACqC,IAAI,CAACC,KAAL,CAAWkB,UAAU,GAAGC,QAAxB,CAAD,CAAV;AACAF,QAAAA,SAAS,GAAGA,SAAS,CAACG,SAAV,CAAoB,CAApB,EAAuBH,SAAS,CAACxB,MAAV,GAAmB,CAA1C,CAAZ;AACAwB,QAAAA,SAAS,IAAI,GAAb;AACAnE,QAAAA,OAAO,CAACkE,SAAD,CAAP;AACAhE,QAAAA,OAAO,CAAC,CAAD,CAAP;AACAE,QAAAA,cAAc,CAAC,CAAC,CAAF,CAAd;AACAiB,QAAAA,OAAO,CAACC,IAAI,CAACC,KAAL,CAAW4C,SAAX,CAAD,CAAP;AACH,OARD,MAQO;AACHzD,QAAAA,WAAW,CAAC,IAAD,CAAX;AACAuD,QAAAA,KAAK,CAAC,mCAAD,CAAL;AACH;AACJ;AACJ,GAjCD;;AAmCA,QAAMM,oBAAoB,GAAInF,IAAD,IAAU;AACnC4B,IAAAA,mBAAmB,CAAC5B,IAAD,CAAnB;AACH,GAFD;;AAIA,QAAMoF,kBAAkB,GAAIpF,IAAD,IAAU;AACjC+B,IAAAA,iBAAiB,CAAC/B,IAAD,CAAjB;AACH,GAFD;;AAIA,QAAMqF,WAAW,GAAG,MAAM;AACtB/D,IAAAA,WAAW,CAAC,KAAD,CAAX;AACAN,IAAAA,cAAc,CAAC,EAAD,CAAd;AACAF,IAAAA,OAAO,CAAC,CAAD,CAAP;AACAoD,IAAAA,gBAAgB,CAACzD,SAAD,EAAYA,SAAS,CAAC8C,MAAtB,EAA8B,EAA9B,EAAkC,CAAlC,CAAhB;AACH,GALD;;AAOA,QAAM+B,aAAa,GAAG,MAAM;AACxBjD,IAAAA,WAAW,CAAC,MAAD,CAAX;AACAlE,IAAAA,YAAY,CAACqE,QAAb,CAAsBlC,UAAtB,EAAkCmC,IAAlC,CAAuCC,QAAQ,IAAI;AAC/C,UAAIC,GAAG,GAAG,EAAV;AACAC,MAAAA,MAAM,CAACC,IAAP,CAAYH,QAAQ,CAACV,IAArB,EAA2Bc,OAA3B,CAAmC,UAASC,GAAT,EAAc;AAC7C,YAAIC,QAAQ,GAAGpE,MAAM,CAAC8D,QAAQ,CAACV,IAAT,CAAce,GAAd,EAAmB/C,IAApB,CAArB;AACA,YAAIiD,SAAS,GAAG;AACZlD,UAAAA,GAAG,EAAE2C,QAAQ,CAACV,IAAT,CAAce,GAAd,EAAmBhD,GADZ;AAEZC,UAAAA,IAAI,EAAEgD,QAFM;AAGZE,UAAAA,OAAO,EAAER,QAAQ,CAACV,IAAT,CAAce,GAAd,EAAmBI;AAHhB,SAAhB;AAKAR,QAAAA,GAAG,CAACS,IAAJ,CAASH,SAAT;AACH,OARD;AASA,UAAII,QAAQ,GAAGV,GAAG,CAACW,OAAJ,EAAf;AACA5B,MAAAA,UAAU,CAAC2B,QAAQ,CAAC,CAAD,CAAR,CAAYtD,GAAb,CAAV;;AACA,UAAGsD,QAAQ,CAACE,MAAT,IAAmB,CAAtB,EACA;AACInC,QAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACAF,QAAAA,aAAa,CAAC,IAAD,CAAb;AACH,OAJD,MAIO;AACHR,QAAAA,YAAY,CAAC2C,QAAD,CAAZ;AACA,YAAIrB,IAAI,GAAG,EAAX;;AACA,aAAI,IAAIwB,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGH,QAAQ,CAACE,MAA5B,EAAoCC,CAAC,EAArC,EAAwC;AACpCxB,UAAAA,IAAI,CAACoB,IAAL,CAAUvD,UAAU,CAAC2D,CAAD,EAAIH,QAAQ,CAACG,CAAD,CAAR,CAAYzD,GAAhB,EAAqBsD,QAAQ,CAACG,CAAD,CAAR,CAAYxD,IAAZ,CAAiByD,MAAjB,CAAwB,KAAxB,CAArB,CAApB;AACH;;AACD7C,QAAAA,OAAO,CAACoB,IAAD,CAAP;AACA,YAAI0B,SAAS,GAAG,GAAhB;AACA,YAAIC,WAAW,GAAG,CAAlB;;AACA,aAAI,IAAIH,CAAC,GAAK3C,IAAI,GAAGE,WAArB,EAAoCyC,CAAC,GAAK3C,IAAI,GAAGE,WAAR,GAAuBA,WAAhE,EAA8EyC,CAAC,EAA/E,EAAkF;AAC9E,cAAGA,CAAC,GAAGH,QAAQ,CAACE,MAAT,GAAkB,CAAzB,EACA;AACIG,YAAAA,SAAS,GAAGA,SAAS,CAACE,MAAV,CAAiB,CAAjB,EAAoBF,SAAS,CAACH,MAAV,GAAkB,CAAtC,CAAZ;AACA;AACH;;AACDI,UAAAA,WAAW,IAAIN,QAAQ,CAACG,CAAD,CAAR,CAAYzD,GAA3B;AACA2D,UAAAA,SAAS,IAAI,MAAML,QAAQ,CAACG,CAAD,CAAR,CAAYxD,IAAZ,CAAiByD,MAAjB,CAAwB,aAAxB,CAAN,GAA+C,KAA/C,GAAuDJ,QAAQ,CAACG,CAAD,CAAR,CAAYzD,GAAhF;;AACA,cAAGyD,CAAC,KAAO3C,IAAI,GAAGE,WAAR,GAAuBA,WAAxB,GAAuC,CAAhD,EAAkD;AAC9C2C,YAAAA,SAAS,IAAI,GAAb;AACH;AACJ;;AACDA,QAAAA,SAAS,IAAI,GAAb;AACAzB,QAAAA,OAAO,CAACC,IAAI,CAACC,KAAL,CAAWuB,SAAX,CAAD,CAAP;AACAlC,QAAAA,UAAU,CAACqC,IAAI,CAACC,KAAL,CAAWH,WAAW,GAAG5C,WAAzB,CAAD,CAAV;AACH;AACJ,KA1CD;AA2CH,GA7CD;;AA+CA,QAAMwE,gBAAgB,GAAG,MAAM;AAC3BlD,IAAAA,WAAW,CAAC,OAAD,CAAX;AACH,GAFD;;AAIA,QAAMmD,gBAAgB,GAAG,MAAM;AAC3BnD,IAAAA,WAAW,CAAC,OAAD,CAAX;AACH,GAFD;;AAIA,QAAM6B,gBAAgB,GAAG,CAACY,SAAD,EAAYvB,MAAZ,EAAoBkC,WAApB,EAAiC5E,IAAjC,KAA0C;AAC/D,QAAG4E,WAAW,KAAK,CAAC,CAApB,EACA;AACI,UAAI/B,SAAS,GAAG,GAAhB;AACA,UAAIC,WAAW,GAAG,CAAlB;;AACA,WAAI,IAAIH,CAAC,GAAK3C,IAAI,GAAG4E,WAArB,EAAoCjC,CAAC,GAAK3C,IAAI,GAAG4E,WAAR,GAAuBA,WAAhE,EAA8EjC,CAAC,EAA/E,EAAkF;AAC9E,YAAGA,CAAC,GAAGsB,SAAS,CAACvB,MAAV,GAAmB,CAA1B,EACA;AACIG,UAAAA,SAAS,GAAGA,SAAS,CAACE,MAAV,CAAiB,CAAjB,EAAoBF,SAAS,CAACH,MAAV,GAAkB,CAAtC,CAAZ;AACA;AACH;;AACDI,QAAAA,WAAW,IAAImB,SAAS,CAACtB,CAAD,CAAT,CAAazD,GAA5B;AACA2D,QAAAA,SAAS,IAAI,MAAMoB,SAAS,CAACtB,CAAD,CAAT,CAAaxD,IAAb,CAAkByD,MAAlB,CAAyB,aAAzB,CAAN,GAAgD,KAAhD,GAAwDqB,SAAS,CAACtB,CAAD,CAAT,CAAazD,GAAlF;;AACA,YAAGyD,CAAC,KAAO3C,IAAI,GAAG4E,WAAR,GAAuBA,WAAxB,GAAuC,CAAhD,EAAkD;AAC9C/B,UAAAA,SAAS,IAAI,GAAb;AACH;AACJ;;AACDA,MAAAA,SAAS,IAAI,GAAb;AACAzB,MAAAA,OAAO,CAACC,IAAI,CAACC,KAAL,CAAWuB,SAAX,CAAD,CAAP;AACAlC,MAAAA,UAAU,CAACqC,IAAI,CAACC,KAAL,CAAWH,WAAW,GAAG8B,WAAzB,CAAD,CAAV;AACH,KAnBD,MAmBO;AACH,UAAI/B,SAAS,GAAG,GAAhB;AACA,UAAIC,WAAW,GAAG,CAAlB;;AACA,WAAI,IAAIH,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGD,MAAnB,EAA2BC,CAAC,EAA5B,EAA+B;AAC3BG,QAAAA,WAAW,IAAImB,SAAS,CAACtB,CAAD,CAAT,CAAazD,GAA5B;AACA2D,QAAAA,SAAS,IAAI,MAAMoB,SAAS,CAACtB,CAAD,CAAT,CAAaxD,IAAb,CAAkByD,MAAlB,CAAyB,aAAzB,CAAN,GAAgD,KAAhD,GAAwDqB,SAAS,CAACtB,CAAD,CAAT,CAAazD,GAAlF;;AACA,YAAGyD,CAAC,KAAKD,MAAM,GAAG,CAAlB,EAAoB;AAChBG,UAAAA,SAAS,IAAI,GAAb;AACH;AACJ;;AACDA,MAAAA,SAAS,IAAI,GAAb;AACAzB,MAAAA,OAAO,CAACC,IAAI,CAACC,KAAL,CAAWuB,SAAX,CAAD,CAAP;AACAlC,MAAAA,UAAU,CAACqC,IAAI,CAACC,KAAL,CAAWH,WAAW,GAAGJ,MAAzB,CAAD,CAAV;AACH;AACJ,GAlCD;;AAoCA,MAAImC,IAAI,gBAAI,QAAC,IAAD;AAAM,IAAA,SAAS,MAAf;AAAA,4BACI,QAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAW,MAAA,EAAE,EAAExF,UAAU,GAAG,CAAH,GAAO,EAAhC;AAAoC,MAAA,SAAS,EAAEE,OAAO,CAACuF,WAAvD;AAAA,6BACA;AAAK,QAAA,KAAK,EAAE;AAACC,UAAAA,OAAO,EAAE,MAAV;AAAkBC,UAAAA,MAAM,EAAE;AAA1B,SAAZ;AAAA,+BACI,QAAC,KAAD;AACI,UAAA,IAAI,EAAElF,IADV;AAEI,UAAA,IAAI,EAAEE,IAFV;AAGI,UAAA,WAAW,EAAEE,WAHjB;AAII,UAAA,gBAAgB,EAAEgD,gBAJtB;AAKI,UAAA,uBAAuB,EAAEI;AAL7B;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,YADJ,eAYA,QAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAW,MAAA,EAAE,EAAEjE,UAAU,GAAG,CAAH,GAAO,EAAhC;AAAoC,MAAA,KAAK,EAAE;AAAC2F,QAAAA,MAAM,EAAE;AAAT,OAA3C;AAAA,8BACI;AAAK,QAAA,KAAK,EAAE;AAACD,UAAAA,OAAO,EAAE;AAAV,SAAZ;AAAA,+BACI,QAAC,KAAD;AAAO,UAAA,IAAI,EAAE5D;AAAb;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADJ,eAII,QAAC,IAAD;AAAM,QAAA,SAAS,MAAf;AAAA,gCACI,QAAC,IAAD;AAAM,UAAA,IAAI,MAAV;AAAW,UAAA,EAAE,EAAE7B,aAAa,GAAG,CAAH,GAAO,EAAnC;AAAuC,UAAA,KAAK,EAAE;AAAC0F,YAAAA,MAAM,EAAE;AAAT,WAA9C;AAAA,iCACI;AAAK,YAAA,KAAK,EAAE;AAACvG,cAAAA,YAAY,EAAE,MAAf;AAAuBC,cAAAA,WAAW,EAAE,MAApC;AAA4CF,cAAAA,UAAU,EAAE,MAAxD;AAAgEyG,cAAAA,KAAK,EAAE;AAAvE,aAAZ;AAAA,mCACI,QAAC,OAAD;AAAS,cAAA,KAAK,EAAE,oBAAhB;AAAsC,cAAA,GAAG,EAAEvE;AAA3C;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAMI,QAAC,IAAD;AAAM,UAAA,IAAI,MAAV;AAAW,UAAA,EAAE,EAAEpB,aAAa,GAAG,CAAH,GAAO,EAAnC;AAAA,iCACI;AAAK,YAAA,KAAK,EAAE;AAACb,cAAAA,YAAY,EAAE,MAAf;AAAuBC,cAAAA,WAAW,EAAE,MAApC;AAA4CF,cAAAA,UAAU,EAAE,MAAxD;AAAgEyG,cAAAA,KAAK,EAAE,MAAvE;AAA+EC,cAAAA,SAAS,EAAE;AAA1F,aAAZ;AAAA,mCACI,QAAC,OAAD;AAAS,cAAA,KAAK,EAAE,yBAAhB;AAA2C,cAAA,GAAG,EAAEtE;AAAhD;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBANJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,YAZA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAZ;;AA+BA,MAAGW,QAAQ,KAAK,OAAhB,EAAwB;AACpBsD,IAAAA,IAAI,gBAAI;AAAK,MAAA,KAAK,EAAE;AAACE,QAAAA,OAAO,EAAE,MAAV;AAAkBC,QAAAA,MAAM,EAAE,MAA1B;AAAkCC,QAAAA,KAAK,EAAE;AAAzC,OAAZ;AAAA,6BACI,QAAC,KAAD;AACI,QAAA,IAAI,EAAEnF,IADV;AAEI,QAAA,IAAI,EAAEE,IAFV;AAGI,QAAA,WAAW,EAAEE,WAHjB;AAII,QAAA,gBAAgB,EAAEgD,gBAJtB;AAKI,QAAA,uBAAuB,EAAEI;AAL7B;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YAAR;AASH,GAVD,MAUO,IAAI/B,QAAQ,KAAK,OAAjB,EAAyB;AAC5BsD,IAAAA,IAAI,gBAAI;AAAK,MAAA,KAAK,EAAE;AAACE,QAAAA,OAAO,EAAE,MAAV;AAAkBC,QAAAA,MAAM,EAAE,MAA1B;AAAkCC,QAAAA,KAAK,EAAE;AAAzC,OAAZ;AAAA,6BACI,QAAC,KAAD;AAAO,QAAA,IAAI,EAAE9D;AAAb;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YAAR;AAGH;;AAED,sBACI;AAAA,4BACI,QAAC,WAAD;AACI,MAAA,IAAI,EAAEM;AADV;AAAA;AAAA;AAAA;AAAA,YADJ,eAII,QAAC,MAAD;AACI,MAAA,WAAW,EAAE9B,WADjB;AAEI,MAAA,UAAU,EAAES,UAFhB;AAGI,MAAA,aAAa,EAAEC,aAHnB;AAII,MAAA,iBAAiB,EAAEoD;AAJvB;AAAA;AAAA;AAAA;AAAA,YAJJ,eAUI,QAAC,WAAD;AACI,MAAA,QAAQ,EAAEjD,QADd;AAEI,MAAA,eAAe,EAAEmD,eAFrB;AAGI,MAAA,gBAAgB,EAAE7C,gBAHtB;AAII,MAAA,cAAc,EAAGG,cAJrB;AAKI,MAAA,oBAAoB,EAAEqD,oBAL1B;AAMI,MAAA,kBAAkB,EAAEC,kBANxB;AAOI,MAAA,WAAW,EAAEC;AAPjB;AAAA;AAAA;AAAA;AAAA,YAVJ,eAmBI,QAAC,OAAD;AACI,MAAA,gBAAgB,EAAEE,gBADtB;AAEI,MAAA,gBAAgB,EAAEC;AAFtB;AAAA;AAAA;AAAA;AAAA,YAnBJ,eAuBI;AAAK,MAAA,SAAS,EAAEpF,OAAO,CAAChB,OAAxB;AAAA,6BACI,QAAC,IAAD;AAAA,gCACI,QAAC,OAAD;AACI,UAAA,WAAW,EAAEoB,WADjB;AAEI,UAAA,cAAc,EAAEW,cAFpB;AAGI,UAAA,mBAAmB,EAAEoD,mBAHzB;AAII,UAAA,aAAa,EAAEe;AAJnB;AAAA;AAAA;AAAA;AAAA,gBADJ,EAOKI,IAPL,eAQI,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,gBARJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YAvBJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAsCH,CA/TD;;GAAMzF,S;UACiBlB,a,EACGA,a,EAENG,S;;;KAJde,S;AAiUN,eAAeA,SAAf","sourcesContent":["import { useState, useEffect } from 'react';\nimport HeartSerivce from './../services/HeartRateService';\nimport SideBar from '../components/Navigation/SideBar';\nimport { makeStyles } from '@material-ui/core';\nimport Grid from '@material-ui/core/Grid';\nimport Cookies from 'universal-cookie';\nimport BPMCard from './../components/Dashboard/BPMCard';\nimport Table from './../components/Dashboard/Table';\nimport Graph from './../components/Dashboard/Graph';\nimport NoData from './../components/Dashboard/NoData';\nimport moment from 'moment';\nimport Heading from './../components/Dashboard/Heading';\nimport Footer from './../components/Navigation/Footer';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport SelectDates from './../components/Dashboard/SelectDates';\nimport LoadingPage from './../components/Navigation/Loading';\n\n\nconst useStyles = makeStyles((theme) => ({\n    content: {\n        paddingTop: '25px',\n        paddingRight: '25px',\n        paddingLeft: '110px',\n        '@media (min-width: 900px)': {\n            paddingLeft: '265px',\n          }, \n    },\n    welcome: {\n        textAlign: 'left',\n        fontWeight: '300',\n        fontSize: '28px'\n    },\n    output: {\n        textAlign: 'left',\n        fontWeight: '100',\n        fontSize: '22px'\n    },\n}));\n\nfunction createData(unNum, bpm, date) {\n    return {unNum, bpm, date };\n}\n\nconst Dashboard = () => {\n    const matchWidth = useMediaQuery('(min-width:1150px)');\n    const matchWidthSec = useMediaQuery('(min-width:600px)');\n\n    const classes = useStyles();\n    const cookies = new Cookies();\n    const curAppleId = cookies.get('currAppleId');\n    const displayName = cookies.get('displayName');\n    const [heartData, setHeartData] = useState([]);\n    const [rows, setRows] = useState([]);\n    const [page, setPage] = useState(0);\n    const [rowsPerPage, setRowsPerPage] = useState(10);\n    const [openNoData, setOpenNoData] = useState(false);\n    const [datesButtonDis, setDatesButtonDis] = useState(false);\n    const [openDate, setOpenDate] = useState(false);\n    const [avgRate, setAvgRate] = useState(0);\n    const [lastRec, setLastRec] = useState(0);\n    const [selectedDateFrom, setSelectedDateFrom] = useState(new Date());\n    const [selectedDateTo, setSelectedDateTo] = useState(new Date());\n    const [data, setData] = useState(JSON.parse(\"{}\"));\n    const [viewData, setViewData] = useState('full')\n    const [isLoadingPage, setIsLoadingPage] = useState(false);\n\n\n    useEffect(() => {\n        setIsLoadingPage(true)\n        HeartSerivce.getUsers(curAppleId).then(response => {\n            let arr = [];\n            Object.keys(response.data).forEach(function(key) {\n                let currDate = moment(response.data[key].date);\n                let HeartRate = {\n                    bpm: response.data[key].bpm,\n                    date: currDate,\n                    user_id: response.data[key].userid\n                }\n                arr.push(HeartRate);\n            });\n            let arrTable = arr.reverse();\n            if(arrTable.length <= 0)\n            {\n                setDatesButtonDis(true);\n                setOpenNoData(true);\n            } else {\n                setLastRec(arrTable[0].bpm);\n                setHeartData(arrTable);\n                let data = [];\n                for(let i = 0; i < arrTable.length; i++){\n                    data.push(createData(i, arrTable[i].bpm, arrTable[i].date.format('lll')));\n                }\n                setRows(data);\n                let chartdata = \"{\";\n                let currAveRate = 0;\n                for(let i = ((page * rowsPerPage)); i < ((page * rowsPerPage) + rowsPerPage); i++){\n                    if(i > arrTable.length - 1)\n                    {\n                        chartdata = chartdata.substr(0, chartdata.length -1);\n                        break; \n                    }\n                    currAveRate += arrTable[i].bpm;\n                    chartdata += '\"' + arrTable[i].date.format('MMM D h:m.s') + '\": ' + arrTable[i].bpm;\n                    if(i !== ((page * rowsPerPage) + rowsPerPage) - 1){\n                        chartdata += \",\";\n                    }\n                }\n                chartdata += \"}\"\n                setData(JSON.parse(chartdata));\n                setAvgRate(Math.round(currAveRate / rowsPerPage));\n            }\n        })\n        setIsLoadingPage(false);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n\n    const handleChangePage = (event, newPage) => {\n        setPage(newPage);\n        generteGraphData(heartData, rows.length, rowsPerPage, newPage);\n    };\n\n    const handleChangeRowsPerPage = (event) => {\n        setRowsPerPage(+event.target.value);\n        setPage(0);\n        //updateGraph(0, +event.target.value, heartData);\n        generteGraphData(heartData, rows.length, +event.target.value, page);\n    };\n\n    const handleCloseNoData = () => {\n        setOpenNoData(false);\n    };\n\n    const handleClickOpenDate = () => {\n        setOpenDate(true);\n    };\n\n    const handleCloseDate = () => {\n        let dateFrom = moment(selectedDateFrom);\n        let dateTo = moment(selectedDateTo);\n        if(dateFrom.isAfter(dateTo) || dateTo.isBefore(dateFrom)){\n            alert(\"The date start must not be after the end date or the end date must not be before the start date!\");\n        } else {\n            setOpenDate(false);\n            let tableData = [];\n            let chartData = \"{\";\n            let heartRates = 0;\n            let numRates = 0;\n            for(let i = 0; i < heartData.length; i++){\n                let currDate = heartData[i].date;\n                if(currDate.isAfter(dateFrom) && currDate.isBefore(dateTo)){\n                    heartRates += heartData[i].bpm;\n                    numRates++;\n                    tableData.push(createData(i, heartData[i].bpm, heartData[i].date.format('lll')));\n                    chartData += '\"' + heartData[i].date.format('MMM D, YYYY h:m.s') + '\": ' + heartData[i].bpm + ',';\n                }\n            }\n            if (numRates > 0) {\n                setAvgRate(Math.round(heartRates / numRates))\n                chartData = chartData.substring(0, chartData.length - 1)\n                chartData += \"}\"\n                setRows(tableData);\n                setPage(0);\n                setRowsPerPage(-1);\n                setData(JSON.parse(chartData));\n            } else {\n                setOpenDate(true);\n                alert(\"No data found between those dates\");\n            }\n        }\n    };\n\n    const handleDateChangeFrom = (date) => {\n        setSelectedDateFrom(date);\n    };\n\n    const handleDateChangeTo = (date) => {\n        setSelectedDateTo(date);\n    };\n\n    const handleReset = () => {\n        setOpenDate(false);\n        setRowsPerPage(10)\n        setPage(0);\n        generteGraphData(heartData, heartData.length, 10, 0);\n    }\n\n    const handelRefresh = () => {\n        setViewData(\"full\")\n        HeartSerivce.getUsers(curAppleId).then(response => {\n            let arr = [];\n            Object.keys(response.data).forEach(function(key) {\n                let currDate = moment(response.data[key].date);\n                let HeartRate = {\n                    bpm: response.data[key].bpm,\n                    date: currDate,\n                    user_id: response.data[key].userid\n                }\n                arr.push(HeartRate);\n            });\n            let arrTable = arr.reverse();\n            setLastRec(arrTable[0].bpm);\n            if(arrTable.length <= 0)\n            {\n                setDatesButtonDis(true);\n                setOpenNoData(true);\n            } else {\n                setHeartData(arrTable);\n                let data = [];\n                for(let i = 0; i < arrTable.length; i++){\n                    data.push(createData(i, arrTable[i].bpm, arrTable[i].date.format('lll')));\n                }\n                setRows(data);\n                let chartdata = \"{\";\n                let currAveRate = 0;\n                for(let i = ((page * rowsPerPage)); i < ((page * rowsPerPage) + rowsPerPage); i++){\n                    if(i > arrTable.length - 1)\n                    {\n                        chartdata = chartdata.substr(0, chartdata.length -1);\n                        break; \n                    }\n                    currAveRate += arrTable[i].bpm;\n                    chartdata += '\"' + arrTable[i].date.format('MMM D h:m.s') + '\": ' + arrTable[i].bpm;\n                    if(i !== ((page * rowsPerPage) + rowsPerPage) - 1){\n                        chartdata += \",\";\n                    }\n                }\n                chartdata += \"}\"\n                setData(JSON.parse(chartdata));\n                setAvgRate(Math.round(currAveRate / rowsPerPage));\n            }\n        })\n    }\n\n    const handleTableClick = () => {\n        setViewData(\"table\");\n    }\n\n    const handleGraphClick = () => {\n        setViewData(\"graph\");\n    }\n\n    const generteGraphData = (tableData, length, numElements, page) => {\n        if(numElements !== -1)\n        {\n            let chartdata = \"{\";\n            let currAveRate = 0;\n            for(let i = ((page * numElements)); i < ((page * numElements) + numElements); i++){\n                if(i > tableData.length - 1)\n                {\n                    chartdata = chartdata.substr(0, chartdata.length -1);\n                    break; \n                }\n                currAveRate += tableData[i].bpm;\n                chartdata += '\"' + tableData[i].date.format('MMM D h:m.s') + '\": ' + tableData[i].bpm;\n                if(i !== ((page * numElements) + numElements) - 1){\n                    chartdata += \",\";\n                }\n            }\n            chartdata += \"}\"\n            setData(JSON.parse(chartdata));\n            setAvgRate(Math.round(currAveRate / numElements));\n        } else {\n            let chartdata = \"{\";\n            let currAveRate = 0;\n            for(let i = 0; i < length; i++){\n                currAveRate += tableData[i].bpm;\n                chartdata += '\"' + tableData[i].date.format('MMM D h:m.s') + '\": ' + tableData[i].bpm;\n                if(i !== length - 1){\n                    chartdata += \",\";\n                }\n            }\n            chartdata += \"}\"\n            setData(JSON.parse(chartdata));\n            setAvgRate(Math.round(currAveRate / length));\n        }\n    }\n\n    var body =  <Grid container>\n                    <Grid item sm={matchWidth ? 6 : 12} className={classes.tableHeight}>\n                    <div style={{padding: '10px', height: '76vh'}}>\n                        <Table\n                            rows={rows}\n                            page={page}\n                            rowsPerPage={rowsPerPage}\n                            handleChangePage={handleChangePage}\n                            handleChangeRowsPerPage={handleChangeRowsPerPage}\n                        />\n                    </div>\n                </Grid>\n                <Grid item sm={matchWidth ? 6 : 12} style={{height: '76vh'}}>\n                    <div style={{padding: '10px'}} >\n                        <Graph data={data}/>\n                    </div>\n                    <Grid container>\n                        <Grid item sm={matchWidthSec ? 6 : 12} style={{height: '200px'}}>\n                            <div style={{paddingRight: '10px', paddingLeft: '10px', paddingTop: '10px', width: '100%'}}>\n                                <BPMCard title={\"Average Heart Rate\"} bpm={avgRate}/>\n                            </div>\n                        </Grid>\n                        <Grid item sm={matchWidthSec ? 6 : 12}>\n                            <div style={{paddingRight: '10px', paddingLeft: '10px', paddingTop: '10px', width: '100%', minHeight: '100%'}}>\n                                <BPMCard title={\"Last Recoded Heart Rate\"} bpm={lastRec}/>\n                            </div>\n                        </Grid>\n                    </Grid>\n                </Grid>\n            </Grid>;\n\n    if(viewData === \"table\"){\n        body =  <div style={{padding: '15px', height: '78vh', width: '100%'}}>\n                    <Table \n                        rows={rows}\n                        page={page}\n                        rowsPerPage={rowsPerPage}\n                        handleChangePage={handleChangePage}\n                        handleChangeRowsPerPage={handleChangeRowsPerPage}\n                    />\n                </div>\n    } else if (viewData === \"graph\"){\n        body =  <div style={{padding: '15px', height: '78vh', width: '100%'}}>\n                    <Graph data={data}/> \n                </div>\n    }\n\n    return (\n        <div>\n            <LoadingPage \n                open={isLoadingPage}\n            />\n            <NoData \n                displayName={displayName}\n                openNoData={openNoData}\n                setOpenNoData={setOpenNoData}\n                handleCloseNoData={handleCloseNoData}\n            />\n            <SelectDates\n                openDate={openDate}\n                handleCloseDate={handleCloseDate}\n                selectedDateFrom={selectedDateFrom}\n                selectedDateTo= {selectedDateTo}\n                handleDateChangeFrom={handleDateChangeFrom}\n                handleDateChangeTo={handleDateChangeTo}\n                handleReset={handleReset}\n            />\n            <SideBar \n                handleTableClick={handleTableClick}\n                handleGraphClick={handleGraphClick}\n            />\n            <div className={classes.content}>\n                <Grid>\n                    <Heading \n                        displayName={displayName}\n                        datesButtonDis={datesButtonDis}\n                        handleClickOpenDate={handleClickOpenDate}\n                        handelRefresh={handelRefresh}\n                    />\n                    {body}\n                    <Footer/>\n                </Grid>\n            </div>\n        </div>\n    )\n}\n\nexport default Dashboard\n"]},"metadata":{},"sourceType":"module"}